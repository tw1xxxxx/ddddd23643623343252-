{"ast":null,"code":"var _jsxFileName = \"C:\\\\restaurant-website (2)\\\\restaurant-website\\\\Backend\\\\ClientApp\\\\src\\\\pages\\\\Admin.js\",\n  _s5 = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useMemo, useCallback } from 'react';\nimport './Admin.css';\nimport { autoSaveReservations, autoSaveMenu, autoSavePhotos, loadTheme, loadMenu, loadReservations, loadCategories, saveTheme, saveCategories } from '../utils/fileStorage';\nimport { defaultMenu } from '../data/defaultMenu';\n\n// Базовые категории по умолчанию\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst defaultCategories = [{\n  id: 1,\n  key: 'cold',\n  name: 'Холодные закуски',\n  order: 1\n}, {\n  id: 2,\n  key: 'salads',\n  name: 'Салаты',\n  order: 2\n}, {\n  id: 3,\n  key: 'hot',\n  name: 'Горячие блюда',\n  order: 3\n}, {\n  id: 4,\n  key: 'drinks',\n  name: 'Напитки',\n  order: 4\n}];\n\n// Базовые темы по умолчанию\nconst defaultThemes = {\n  elegant: {\n    id: 'elegant',\n    name: 'Элегантная синяя',\n    primaryColor: '#2C3E50',\n    primaryLight: '#34495E',\n    primaryDark: '#1C2833',\n    secondaryColor: '#3498DB',\n    secondaryLight: '#5DADE2',\n    secondaryDark: '#2980B9',\n    accentColor: '#E74C3C',\n    backgroundColor: '#ECF0F1',\n    textColor: '#2C3E50',\n    textLight: '#566573'\n  }\n};\nconst Admin = () => {\n  _s5();\n  var _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$();\n  // Проверяем авторизацию из localStorage при загрузке\n  const [isAuthenticated, setIsAuthenticated] = useState(() => {\n    return localStorage.getItem('admin-authenticated') === 'true';\n  });\n  const [activeTab, setActiveTab] = useState('reservations');\n  const [reservations, setReservations] = useState([]);\n  const [menuItems, setMenuItems] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [themes, setThemes] = useState({});\n  const [currentTheme, setCurrentTheme] = useState('default');\n  const [photos, setPhotos] = useState([]);\n  const [editingItem, setEditingItem] = useState(null);\n  const [editingCategory, setEditingCategory] = useState(null);\n  const [editingTheme, setEditingTheme] = useState(null);\n  const [editingPhoto, setEditingPhoto] = useState(null);\n  const newPhotoKeyRef = useRef(`new-photo-${Date.now()}`); // Стабильный key для новой формы\n  const newPhotoObjectRef = useRef({}); // Стабильный объект для новой формы\n  // Глобальное хранилище для загруженных изображений (вне компонента, чтобы не терять при перерендере)\n  const uploadedImagesStore = useRef(new Map()); // key -> base64 image\n  const newMenuItemKeyRef = useRef(`new-menu-item-${Date.now()}`); // Стабильный key для новой формы меню\n  // Глобальное хранилище для загруженных изображений меню\n  const menuImagesStore = useRef(new Map()); // key -> base64 image\n  const [showNotification, setShowNotification] = useState(false);\n  const [notificationMessage, setNotificationMessage] = useState('');\n  const [notificationType, setNotificationType] = useState('success');\n\n  // Функция для переключения вкладок с закрытием всех модальных окон\n  const handleTabChange = tab => {\n    // Закрываем все открытые модальные окна\n    // Очищаем хранилище при переключении вкладок\n    if (editingItem) {\n      const formKey = (editingItem === null || editingItem === void 0 ? void 0 : editingItem.id) || newMenuItemKeyRef.current;\n      if (menuImagesStore.current.has(formKey)) {\n        menuImagesStore.current.delete(formKey);\n      }\n    }\n    setEditingItem(null);\n    setEditingCategory(null);\n    setEditingTheme(null);\n    if (editingPhoto) {\n      const formKey = (editingPhoto === null || editingPhoto === void 0 ? void 0 : editingPhoto.id) || newPhotoKeyRef.current;\n      if (uploadedImagesStore.current.has(formKey)) {\n        uploadedImagesStore.current.delete(formKey);\n      }\n    }\n    setEditingPhoto(null);\n    // Переключаем вкладку\n    setActiveTab(tab);\n  };\n  useEffect(() => {\n    const loadCategoriesFromFile = async () => {\n      try {\n        const loadedCategories = await loadCategories();\n        if (Array.isArray(loadedCategories) && loadedCategories.length > 0) {\n          const sorted = [...loadedCategories].sort((a, b) => a.order - b.order);\n          setCategories(sorted);\n        } else {\n          setCategories([...defaultCategories]);\n        }\n      } catch (error) {\n        console.error('Ошибка загрузки категорий:', error);\n        setCategories([...defaultCategories]);\n      }\n    };\n    const loadReservationsFromFile = async () => {\n      try {\n        const loadedReservations = await loadReservations();\n        setReservations(loadedReservations);\n      } catch (error) {\n        console.error('Ошибка загрузки заявок:', error);\n        setReservations([]);\n      }\n    };\n    const loadMenuItemsFromFile = async () => {\n      try {\n        const loadedMenu = await loadMenu();\n        if (Array.isArray(loadedMenu) && loadedMenu.length > 0) {\n          setMenuItems(loadedMenu);\n        } else {\n          // Если меню пустое, используем базовое\n          setMenuItems([...defaultMenu]);\n        }\n      } catch (error) {\n        console.error('Ошибка загрузки меню:', error);\n        setMenuItems([...defaultMenu]);\n      }\n    };\n    const loadThemesFromFile = async () => {\n      try {\n        const themeData = await loadTheme();\n        // Объединяем базовые темы с загруженными\n        const allThemes = {\n          ...defaultThemes,\n          ...themeData.themes\n        };\n        setThemes(allThemes);\n\n        // Устанавливаем текущую тему\n        const currentThemeId = themeData.currentTheme || 'default';\n        setCurrentTheme(currentThemeId);\n        // Применяем тему при загрузке с использованием загруженных тем\n        applyThemeOnLoad(currentThemeId, allThemes);\n      } catch (error) {\n        console.error('Ошибка загрузки тем:', error);\n        setThemes(defaultThemes);\n        setCurrentTheme('default');\n        applyThemeOnLoad('default', defaultThemes);\n      }\n    };\n    const applyThemeOnLoad = (themeId, themesToUse = null) => {\n      // Используем переданные темы или загружаем из состояния\n      const allThemes = themesToUse || {\n        ...defaultThemes,\n        ...themes\n      };\n      if (themeId === 'default') {\n        document.documentElement.className = '';\n        const root = document.documentElement;\n        root.style.removeProperty('--primary-color');\n        root.style.removeProperty('--primary-light');\n        root.style.removeProperty('--primary-dark');\n        root.style.removeProperty('--secondary-color');\n        root.style.removeProperty('--secondary-light');\n        root.style.removeProperty('--secondary-dark');\n        root.style.removeProperty('--accent-color');\n        root.style.removeProperty('--background-color');\n        root.style.removeProperty('--text-color');\n        root.style.removeProperty('--text-light');\n        // Устанавливаем фон html в цвет по умолчанию\n        document.documentElement.style.backgroundColor = '#8B7355';\n        return;\n      }\n\n      // Проверяем базовые темы\n      if (defaultThemes[themeId]) {\n        const theme = defaultThemes[themeId];\n        const root = document.documentElement;\n        root.style.setProperty('--primary-color', theme.primaryColor);\n        root.style.setProperty('--primary-light', theme.primaryLight);\n        root.style.setProperty('--primary-dark', theme.primaryDark);\n        root.style.setProperty('--secondary-color', theme.secondaryColor);\n        root.style.setProperty('--secondary-light', theme.secondaryLight);\n        root.style.setProperty('--secondary-dark', theme.secondaryDark);\n        root.style.setProperty('--accent-color', theme.accentColor);\n        root.style.setProperty('--background-color', theme.backgroundColor);\n        root.style.setProperty('--text-color', theme.textColor);\n        root.style.setProperty('--text-light', theme.textLight);\n        // Устанавливаем фон html для overscroll\n        document.documentElement.style.backgroundColor = theme.primaryColor;\n        return;\n      }\n\n      // Проверяем пользовательские темы\n      const theme = allThemes[themeId];\n      if (theme) {\n        const root = document.documentElement;\n        root.style.setProperty('--primary-color', theme.primaryColor);\n        root.style.setProperty('--primary-light', theme.primaryLight);\n        root.style.setProperty('--primary-dark', theme.primaryDark);\n        root.style.setProperty('--secondary-color', theme.secondaryColor);\n        root.style.setProperty('--secondary-light', theme.secondaryLight);\n        root.style.setProperty('--secondary-dark', theme.secondaryDark);\n        root.style.setProperty('--accent-color', theme.accentColor);\n        root.style.setProperty('--background-color', theme.backgroundColor);\n        root.style.setProperty('--text-color', theme.textColor);\n        root.style.setProperty('--text-light', theme.textLight);\n        // Устанавливаем фон html для overscroll\n        document.documentElement.style.backgroundColor = theme.primaryColor;\n      }\n    };\n    const loadPhotos = () => {\n      const saved = localStorage.getItem('restaurant-photos');\n      if (saved) {\n        try {\n          const savedPhotos = JSON.parse(saved);\n          if (Array.isArray(savedPhotos)) {\n            setPhotos(savedPhotos);\n            return;\n          }\n        } catch (error) {\n          console.error('Ошибка загрузки фотографий:', error);\n        }\n      }\n      setPhotos([]);\n    };\n    loadCategoriesFromFile();\n    loadReservationsFromFile();\n    loadMenuItemsFromFile();\n    loadThemesFromFile();\n    loadPhotos();\n  }, []);\n  const saveCategoriesToFile = async updatedCategories => {\n    // Сортируем по порядку перед сохранением\n    const sorted = [...updatedCategories].sort((a, b) => a.order - b.order);\n    setCategories(sorted);\n    const saveResult = await saveCategories(sorted);\n    if (!saveResult.success) {\n      showAlert(`Ошибка скачивания файла категорий: ${saveResult.message}`, 'error');\n    } else {\n      showAlert('Файл categories.json скачан', 'success');\n    }\n  };\n  const addCategory = async () => {\n    const newCategory = {\n      id: Date.now(),\n      key: `category_${Date.now()}`,\n      name: 'Новая категория',\n      order: categories.length + 1\n    };\n    const updated = [...categories, newCategory];\n    await saveCategoriesToFile(updated);\n    setEditingCategory(newCategory);\n    showAlert('Категория добавлена', 'success');\n  };\n  const updateCategory = async category => {\n    if (!category.name || !category.name.trim()) {\n      showAlert('Введите название категории', 'error');\n      return;\n    }\n    const updated = categories.map(cat => cat.id === category.id ? category : cat);\n    await saveCategoriesToFile(updated);\n    setEditingCategory(null);\n    showAlert('Категория обновлена', 'success');\n  };\n  const deleteCategory = async id => {\n    // Проверяем, используется ли категория в блюдах\n    const category = categories.find(cat => cat.id === id);\n    if (category) {\n      const itemsInCategory = menuItems.filter(item => item.category === category.key);\n      if (itemsInCategory.length > 0) {\n        showAlert(`Нельзя удалить категорию: в ней есть ${itemsInCategory.length} блюд(а)`, 'error');\n        return;\n      }\n    }\n    const updated = categories.filter(cat => cat.id !== id);\n    // Обновляем порядок оставшихся категорий\n    updated.forEach((cat, index) => {\n      cat.order = index + 1;\n    });\n    await saveCategoriesToFile(updated);\n    showAlert('Категория удалена', 'success');\n  };\n  const moveCategory = async (id, direction) => {\n    const index = categories.findIndex(cat => cat.id === id);\n    if (index === -1) return;\n    const newIndex = direction === 'up' ? index - 1 : index + 1;\n    if (newIndex < 0 || newIndex >= categories.length) return;\n    const updated = [...categories];\n    [updated[index].order, updated[newIndex].order] = [updated[newIndex].order, updated[index].order];\n    await saveCategoriesToFile(updated);\n  };\n  const showAlert = useCallback((message, type = 'success') => {\n    setNotificationMessage(message);\n    setNotificationType(type);\n    setShowNotification(true);\n    setTimeout(() => setShowNotification(false), 4000);\n  }, []);\n\n  // Функция авторизации\n  const handleLogin = (username, password) => {\n    if (username === 'admin' && password === 'Tbil4dSokol') {\n      setIsAuthenticated(true);\n      localStorage.setItem('admin-authenticated', 'true');\n      showAlert('Добро пожаловать в админ-панель!', 'success');\n      return true;\n    } else {\n      showAlert('Неверный логин или пароль', 'error');\n      return false;\n    }\n  };\n\n  // Функция выхода\n  const handleLogout = () => {\n    setIsAuthenticated(false);\n    localStorage.removeItem('admin-authenticated');\n    showAlert('Вы вышли из админ-панели', 'success');\n  };\n\n  // Функции управления темами\n  const applyTheme = async themeId => {\n    setCurrentTheme(themeId);\n    if (themeId === 'default') {\n      document.documentElement.className = '';\n      const root = document.documentElement;\n      root.style.removeProperty('--primary-color');\n      root.style.removeProperty('--primary-light');\n      root.style.removeProperty('--primary-dark');\n      root.style.removeProperty('--secondary-color');\n      root.style.removeProperty('--secondary-light');\n      root.style.removeProperty('--secondary-dark');\n      root.style.removeProperty('--accent-color');\n      root.style.removeProperty('--background-color');\n      root.style.removeProperty('--text-color');\n      root.style.removeProperty('--text-light');\n      // Сохраняем тему в файл\n      const saveResult = await saveTheme({\n        currentTheme: themeId,\n        themes: themes\n      });\n      if (saveResult.success) {\n        showAlert('Тема \"По умолчанию\" применена. Файл theme.json скачан.', 'success');\n      } else {\n        showAlert(`Тема применена, но файл не скачан: ${saveResult.message}`, 'error');\n      }\n      return;\n    }\n\n    // Проверяем базовые темы\n    if (defaultThemes[themeId]) {\n      const theme = defaultThemes[themeId];\n      const root = document.documentElement;\n      root.style.setProperty('--primary-color', theme.primaryColor);\n      root.style.setProperty('--primary-light', theme.primaryLight);\n      root.style.setProperty('--primary-dark', theme.primaryDark);\n      root.style.setProperty('--secondary-color', theme.secondaryColor);\n      root.style.setProperty('--secondary-light', theme.secondaryLight);\n      root.style.setProperty('--secondary-dark', theme.secondaryDark);\n      root.style.setProperty('--accent-color', theme.accentColor);\n      root.style.setProperty('--background-color', theme.backgroundColor);\n      root.style.setProperty('--text-color', theme.textColor);\n      root.style.setProperty('--text-light', theme.textLight);\n      // Сохраняем тему в файл\n      const saveResult = await saveTheme({\n        currentTheme: themeId,\n        themes: themes\n      });\n      if (saveResult.success) {\n        showAlert(`Тема \"${theme.name}\" применена. Файл theme.json скачан.`, 'success');\n      } else {\n        showAlert(`Тема применена, но файл не скачан: ${saveResult.message}`, 'error');\n      }\n      return;\n    }\n\n    // Проверяем пользовательские темы\n    const theme = themes[themeId];\n    if (theme) {\n      const root = document.documentElement;\n      root.style.setProperty('--primary-color', theme.primaryColor);\n      root.style.setProperty('--primary-light', theme.primaryLight);\n      root.style.setProperty('--primary-dark', theme.primaryDark);\n      root.style.setProperty('--secondary-color', theme.secondaryColor);\n      root.style.setProperty('--secondary-light', theme.secondaryLight);\n      root.style.setProperty('--secondary-dark', theme.secondaryDark);\n      root.style.setProperty('--accent-color', theme.accentColor);\n      root.style.setProperty('--background-color', theme.backgroundColor);\n      root.style.setProperty('--text-color', theme.textColor);\n      root.style.setProperty('--text-light', theme.textLight);\n      // Сохраняем тему в файл\n      const saveResult = await saveTheme({\n        currentTheme: themeId,\n        themes: themes\n      });\n      if (saveResult.success) {\n        showAlert(`Тема \"${theme.name}\" применена. Файл theme.json скачан.`, 'success');\n      } else {\n        showAlert(`Тема применена, но файл не скачан: ${saveResult.message}`, 'error');\n      }\n    }\n  };\n  const saveThemes = async updatedThemes => {\n    // Объединяем базовые темы с пользовательскими для сохранения\n    const allThemes = {\n      ...defaultThemes,\n      ...updatedThemes\n    };\n    setThemes(allThemes);\n    // Сохраняем в файл\n    const saveResult = await saveTheme({\n      currentTheme: currentTheme,\n      themes: allThemes\n    });\n    if (!saveResult.success) {\n      showAlert(`Ошибка скачивания файла тем: ${saveResult.message}`, 'error');\n    } else {\n      showAlert('Файл theme.json скачан', 'success');\n    }\n  };\n\n  // Функции для автоматического вычисления светлого и темного вариантов цвета\n  const hexToRgb = hex => {\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? {\n      r: parseInt(result[1], 16),\n      g: parseInt(result[2], 16),\n      b: parseInt(result[3], 16)\n    } : null;\n  };\n  const rgbToHex = (r, g, b) => {\n    return \"#\" + [r, g, b].map(x => {\n      const hex = x.toString(16);\n      return hex.length === 1 ? \"0\" + hex : hex;\n    }).join(\"\");\n  };\n  const lightenColor = (hex, percent = 20) => {\n    const rgb = hexToRgb(hex);\n    if (!rgb) return hex;\n    const r = Math.min(255, Math.round(rgb.r + (255 - rgb.r) * (percent / 100)));\n    const g = Math.min(255, Math.round(rgb.g + (255 - rgb.g) * (percent / 100)));\n    const b = Math.min(255, Math.round(rgb.b + (255 - rgb.b) * (percent / 100)));\n    return rgbToHex(r, g, b);\n  };\n  const darkenColor = (hex, percent = 20) => {\n    const rgb = hexToRgb(hex);\n    if (!rgb) return hex;\n    const r = Math.max(0, Math.round(rgb.r * (1 - percent / 100)));\n    const g = Math.max(0, Math.round(rgb.g * (1 - percent / 100)));\n    const b = Math.max(0, Math.round(rgb.b * (1 - percent / 100)));\n    return rgbToHex(r, g, b);\n  };\n  const addTheme = () => {\n    const basePrimaryColor = '#8B7355';\n    const newTheme = {\n      id: `theme_${Date.now()}`,\n      name: 'Новая тема',\n      primaryColor: basePrimaryColor,\n      primaryLight: lightenColor(basePrimaryColor, 20),\n      primaryDark: darkenColor(basePrimaryColor, 20),\n      secondaryColor: '#A8D8EA',\n      secondaryLight: '#C5E7F5',\n      secondaryDark: '#7BB8D4',\n      accentColor: '#D4B896',\n      backgroundColor: '#FDF6E3',\n      textColor: '#333333',\n      textLight: '#666666'\n    };\n    const updated = {\n      ...themes,\n      [newTheme.id]: newTheme\n    };\n    saveThemes(updated);\n    setEditingTheme(newTheme);\n    showAlert('Тема добавлена', 'success');\n  };\n  const updateTheme = theme => {\n    if (!theme.name || !theme.name.trim()) {\n      showAlert('Введите название темы', 'error');\n      return;\n    }\n    // Автоматически вычисляем светлый и темный варианты основного цвета\n    const updatedTheme = {\n      ...theme,\n      primaryLight: lightenColor(theme.primaryColor, 20),\n      primaryDark: darkenColor(theme.primaryColor, 20)\n    };\n    const updated = {\n      ...themes,\n      [updatedTheme.id]: updatedTheme\n    };\n    saveThemes(updated);\n    setEditingTheme(null);\n    showAlert('Тема обновлена', 'success');\n  };\n  const deleteTheme = id => {\n    if (defaultThemes[id]) {\n      showAlert('Базовые темы нельзя удалять', 'error');\n      return;\n    }\n    const updated = {\n      ...themes\n    };\n    delete updated[id];\n    saveThemes(updated);\n    if (currentTheme === id) {\n      applyTheme('default');\n    }\n    showAlert('Тема удалена', 'success');\n  };\n  const deleteReservation = async id => {\n    const updated = reservations.filter(res => res.id !== id);\n    setReservations(updated);\n    const saveResult = await autoSaveReservations(updated);\n    if (saveResult.success) {\n      showAlert('Заявка успешно удалена', 'success');\n    } else {\n      showAlert(`Заявка удалена, но файл не скачан: ${saveResult.message}`, 'error');\n    }\n  };\n  const deleteMenuItem = async id => {\n    // Удаляем элемент из меню\n    const updated = menuItems.filter(item => item.id !== id);\n    setMenuItems(updated);\n\n    // Сохраняем все оставшиеся элементы в файл\n    await autoSaveMenu(updated);\n    showAlert('Блюдо успешно удалено', 'success');\n  };\n  const cancelPhotoEditing = useCallback(() => {\n    // Очищаем хранилище для новой формы при отмене\n    const formKey = (editingPhoto === null || editingPhoto === void 0 ? void 0 : editingPhoto.id) || newPhotoKeyRef.current;\n    if (uploadedImagesStore.current.has(formKey)) {\n      uploadedImagesStore.current.delete(formKey);\n    }\n    setEditingPhoto(null);\n  }, [editingPhoto]);\n  const savePhoto = useCallback(async photo => {\n    if (!photo.image || !photo.image.trim()) {\n      showAlert('Загрузите изображение', 'error');\n      return;\n    }\n    if (!photo.image.startsWith('data:image')) {\n      showAlert('Загрузите файл изображения', 'error');\n      return;\n    }\n    let updated;\n    if (photo.id) {\n      // Редактирование существующей фотографии\n      updated = photos.map(p => p.id === photo.id ? photo : p);\n    } else {\n      // Добавление новой фотографии\n      const newPhoto = {\n        ...photo,\n        id: Date.now()\n      };\n      updated = [...photos, newPhoto];\n    }\n    setPhotos(updated);\n    await autoSavePhotos(updated);\n\n    // Очищаем хранилище для этой формы после сохранения\n    const formKey = photo.id || newPhotoKeyRef.current;\n    if (uploadedImagesStore.current.has(formKey)) {\n      uploadedImagesStore.current.delete(formKey);\n    }\n    setEditingPhoto(null);\n    showAlert(photo.id ? 'Фотография обновлена' : 'Фотография добавлена', 'success');\n  }, [photos]);\n  const deletePhoto = async id => {\n    const updated = photos.filter(p => p.id !== id);\n    setPhotos(updated);\n    await autoSavePhotos(updated);\n    showAlert('Фотография удалена', 'success');\n  };\n  const validateMenuItem = item => {\n    if (!item.name || !item.name.trim()) {\n      showAlert('Введите название блюда', 'error');\n      return false;\n    }\n    if (!item.price || isNaN(parseFloat(item.price)) || parseFloat(item.price) <= 0) {\n      showAlert('Введите корректную цену (больше 0)', 'error');\n      return false;\n    }\n    if (!item.weight || !item.weight.trim()) {\n      showAlert('Введите вес/объем', 'error');\n      return false;\n    }\n    if (!item.description || !item.description.trim()) {\n      showAlert('Введите описание блюда', 'error');\n      return false;\n    }\n    if (!item.image || !item.image.trim()) {\n      showAlert('Загрузите изображение', 'error');\n      return false;\n    }\n    if (!item.image.startsWith('data:image')) {\n      showAlert('Загрузите файл изображения', 'error');\n      return false;\n    }\n    return true;\n  };\n  const saveMenuItem = async item => {\n    if (!validateMenuItem(item)) return;\n\n    // Форматируем цену (убираем \"₽\" если есть и преобразуем в число)\n    const formattedItem = {\n      ...item,\n      price: item.price.toString().replace(' ₽', '')\n    };\n    let updatedItems;\n    if (editingItem && editingItem.id) {\n      // Редактирование существующего блюда (любого, включая базовые)\n      updatedItems = menuItems.map(menuItem => menuItem.id === editingItem.id ? {\n        ...formattedItem,\n        id: editingItem.id\n      } : menuItem);\n      showAlert('Блюдо успешно обновлено', 'success');\n    } else {\n      // Добавление нового блюда\n      const newItem = {\n        ...formattedItem,\n        id: Date.now()\n      };\n      updatedItems = [...menuItems, newItem];\n      showAlert('Блюдо успешно добавлено', 'success');\n    }\n    setMenuItems(updatedItems);\n\n    // Сохраняем все элементы в файл (включая отредактированные базовые)\n    const saveResult = await autoSaveMenu(updatedItems);\n    if (!saveResult.success) {\n      showAlert(`Ошибка скачивания файла меню: ${saveResult.message}`, 'error');\n    } else {\n      showAlert('Файл menu.json скачан', 'success');\n    }\n\n    // Очищаем хранилище для этой формы после сохранения\n    const formKey = (editingItem === null || editingItem === void 0 ? void 0 : editingItem.id) || newMenuItemKeyRef.current;\n    if (menuImagesStore.current.has(formKey)) {\n      menuImagesStore.current.delete(formKey);\n    }\n    setEditingItem(null);\n  };\n  const startEditing = item => {\n    setEditingItem(item);\n  };\n  const cancelEditing = useCallback(() => {\n    // Очищаем хранилище для новой формы при отмене\n    const formKey = (editingItem === null || editingItem === void 0 ? void 0 : editingItem.id) || newMenuItemKeyRef.current;\n    if (menuImagesStore.current.has(formKey)) {\n      menuImagesStore.current.delete(formKey);\n    }\n    setEditingItem(null);\n  }, [editingItem]);\n\n  // Компонент формы редактирования темы\n  const ThemeEditForm = ({\n    theme,\n    onSave,\n    onCancel\n  }) => {\n    _s();\n    const [formData, setFormData] = useState(theme);\n\n    // Функции для вычисления вариантов цвета (локальные копии)\n    const hexToRgbLocal = hex => {\n      const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n      return result ? {\n        r: parseInt(result[1], 16),\n        g: parseInt(result[2], 16),\n        b: parseInt(result[3], 16)\n      } : null;\n    };\n    const rgbToHexLocal = (r, g, b) => {\n      return \"#\" + [r, g, b].map(x => {\n        const hex = x.toString(16);\n        return hex.length === 1 ? \"0\" + hex : hex;\n      }).join(\"\");\n    };\n    const lightenColorLocal = (hex, percent = 20) => {\n      const rgb = hexToRgbLocal(hex);\n      if (!rgb) return hex;\n      const r = Math.min(255, Math.round(rgb.r + (255 - rgb.r) * (percent / 100)));\n      const g = Math.min(255, Math.round(rgb.g + (255 - rgb.g) * (percent / 100)));\n      const b = Math.min(255, Math.round(rgb.b + (255 - rgb.b) * (percent / 100)));\n      return rgbToHexLocal(r, g, b);\n    };\n    const darkenColorLocal = (hex, percent = 20) => {\n      const rgb = hexToRgbLocal(hex);\n      if (!rgb) return hex;\n      const r = Math.max(0, Math.round(rgb.r * (1 - percent / 100)));\n      const g = Math.max(0, Math.round(rgb.g * (1 - percent / 100)));\n      const b = Math.max(0, Math.round(rgb.b * (1 - percent / 100)));\n      return rgbToHexLocal(r, g, b);\n    };\n    const handleChange = (field, value) => {\n      const updated = {\n        ...formData,\n        [field]: value\n      };\n\n      // Если изменяется основной цвет, автоматически вычисляем светлый и темный варианты\n      if (field === 'primaryColor') {\n        updated.primaryLight = lightenColorLocal(value, 20);\n        updated.primaryDark = darkenColorLocal(value, 20);\n      }\n      setFormData(updated);\n    };\n    const handleSubmit = e => {\n      e.preventDefault();\n      onSave(formData);\n    };\n    const colorFields = [{\n      key: 'primaryColor',\n      label: 'Основной цвет'\n    }, {\n      key: 'secondaryColor',\n      label: 'Цвет кнопок и ссылок'\n    }, {\n      key: 'secondaryLight',\n      label: 'Цвет кнопок при наведении'\n    }, {\n      key: 'secondaryDark',\n      label: 'Цвет активных элементов'\n    }, {\n      key: 'accentColor',\n      label: 'Акцентный цвет (выделения)'\n    }, {\n      key: 'backgroundColor',\n      label: 'Цвет фона страницы'\n    }, {\n      key: 'textColor',\n      label: 'Цвет основного текста'\n    }, {\n      key: 'textLight',\n      label: 'Цвет второстепенного текста'\n    }];\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"theme-edit-form\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0442\\u0435\\u043C\\u044B *\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 752,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: formData.name,\n            onChange: e => handleChange('name', e.target.value),\n            placeholder: \"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0442\\u0435\\u043C\\u044B\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 753,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 751,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"theme-colors-grid\",\n          children: colorFields.map(field => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"color-picker-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: field.label\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 765,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"color-picker-wrapper\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"color\",\n                value: formData[field.key],\n                onChange: e => handleChange(field.key, e.target.value),\n                className: \"color-picker\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 767,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: formData[field.key],\n                onChange: e => handleChange(field.key, e.target.value),\n                className: \"color-input\",\n                placeholder: \"#000000\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 773,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"color-preview\",\n                style: {\n                  background: formData[field.key]\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 780,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 766,\n              columnNumber: 17\n            }, this)]\n          }, field.key, true, {\n            fileName: _jsxFileName,\n            lineNumber: 764,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 762,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-actions\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"save-btn\",\n            children: \"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 790,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"cancel-btn\",\n            onClick: onCancel,\n            children: \"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 793,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 789,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 750,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 749,\n      columnNumber: 7\n    }, this);\n  };\n\n  // Функция для конвертации файла в base64\n  _s(ThemeEditForm, \"WFTeQC0sT/LLP0p6euw+bmsjeeE=\");\n  const convertFileToBase64 = file => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = () => resolve(reader.result);\n      reader.onerror = reject;\n      reader.readAsDataURL(file);\n    });\n  };\n\n  // Компонент формы авторизации\n  const LoginForm = ({\n    onLogin\n  }) => {\n    _s2();\n    const [username, setUsername] = useState('');\n    const [password, setPassword] = useState('');\n    const [error, setError] = useState('');\n    const handleSubmit = e => {\n      e.preventDefault();\n      setError('');\n      if (!username.trim() || !password.trim()) {\n        setError('Заполните все поля');\n        return;\n      }\n      const success = onLogin(username, password);\n      if (!success) {\n        setError('Неверный логин или пароль');\n        setPassword('');\n      }\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"admin-login-container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"admin-login-form\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"admin-login-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            children: \"\\u0410\\u0434\\u043C\\u0438\\u043D-\\u043F\\u0430\\u043D\\u0435\\u043B\\u044C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 838,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\u0412\\u043E\\u0439\\u0434\\u0438\\u0442\\u0435 \\u0434\\u043B\\u044F \\u0443\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u044F \\u0441\\u0430\\u0439\\u0442\\u043E\\u043C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 839,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 837,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          className: \"login-form\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"username\",\n              children: \"\\u041B\\u043E\\u0433\\u0438\\u043D\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 843,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              id: \"username\",\n              type: \"text\",\n              value: username,\n              onChange: e => setUsername(e.target.value),\n              placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043B\\u043E\\u0433\\u0438\\u043D\",\n              autoFocus: true,\n              className: error ? 'error' : ''\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 844,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 842,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"password\",\n              children: \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 855,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              id: \"password\",\n              type: \"password\",\n              value: password,\n              onChange: e => setPassword(e.target.value),\n              placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\",\n              className: error ? 'error' : ''\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 856,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 854,\n            columnNumber: 13\n          }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"login-error\",\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 865,\n            columnNumber: 23\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"login-submit-btn\",\n            children: \"\\u0412\\u043E\\u0439\\u0442\\u0438\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 866,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 841,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 836,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 835,\n      columnNumber: 7\n    }, this);\n  };\n\n  // Компонент формы для добавления/редактирования фотографий\n  _s2(LoginForm, \"lABZ+K3zbnEaFQvlduiFXLNOf5A=\");\n  const PhotoForm = ({\n    photo,\n    onSave,\n    onCancel,\n    onAlert,\n    uploadedImagesStore,\n    formKey\n  }) => {\n    _s3();\n    // Извлекаем ID фото для отслеживания изменений\n    // Используем useMemo для стабилизации, чтобы избежать лишних вычислений\n    const photoId = useMemo(() => photo === null || photo === void 0 ? void 0 : photo.id, [photo === null || photo === void 0 ? void 0 : photo.id]);\n\n    // Сохраняем ID фото для отслеживания изменений\n    // Инициализируем ref только один раз при монтировании\n    const photoIdRef = useRef(photoId);\n    const isInitialMountRef = useRef(true);\n\n    // Используем отдельное состояние для изображения\n    // Инициализируем только один раз при монтировании\n    // Восстанавливаем из хранилища, если изображение было загружено ранее\n    const [image, setImage] = useState(() => {\n      // Сначала проверяем хранилище\n      if (uploadedImagesStore && uploadedImagesStore.has(formKey)) {\n        return uploadedImagesStore.get(formKey);\n      }\n      return (photo === null || photo === void 0 ? void 0 : photo.image) || '';\n    });\n    const [caption, setCaption] = useState((photo === null || photo === void 0 ? void 0 : photo.caption) || '');\n    const [isUploading, setIsUploading] = useState(false);\n    const [isDragging, setIsDragging] = useState(false);\n    const fileInputRef = useRef(null);\n    const userHasUploadedRef = useRef(false); // Флаг: пользователь загрузил изображение\n    const uploadedImageRef = useRef(null); // Сохраняем загруженное изображение\n    const isProcessingFileRef = useRef(false); // Флаг: файл обрабатывается\n\n    // Инициализация только при изменении ID фото (не при каждом рендере)\n    useEffect(() => {\n      const isInitialMount = isInitialMountRef.current;\n      isInitialMountRef.current = false;\n\n      // Если ID изменился (переключение между редактированием и созданием нового)\n      if (photoIdRef.current !== photoId) {\n        photoIdRef.current = photoId;\n\n        // Если пользователь уже загрузил изображение для новой формы, НЕ сбрасываем его\n        if (userHasUploadedRef.current && !photoId && uploadedImageRef.current) {\n          // Восстанавливаем загруженное изображение\n          setImage(uploadedImageRef.current);\n          return; // Сохраняем загруженное пользователем изображение\n        }\n\n        // Если редактируем существующее фото - загружаем его данные\n        if (photoId && photo) {\n          userHasUploadedRef.current = false;\n          uploadedImageRef.current = null;\n          setImage(photo.image || '');\n          setCaption(photo.caption || '');\n        } else {\n          // Новая форма - сбрасываем только если пользователь еще ничего не загрузил\n          if (!userHasUploadedRef.current && !uploadedImageRef.current) {\n            setImage('');\n            setCaption('');\n          } else if (uploadedImageRef.current) {\n            // Восстанавливаем загруженное изображение\n            setImage(uploadedImageRef.current);\n          }\n        }\n      }\n      // НЕ обрабатываем isInitialMount здесь - это может вызвать проблемы при перерендере\n    }, [photoId]); // Зависим ТОЛЬКО от photoId - это стабильное значение\n\n    // Отдельный эффект для сохранения изображения при первом монтировании\n    useEffect(() => {\n      if (isInitialMountRef.current && !photoId && image && image.startsWith('data:image')) {\n        uploadedImageRef.current = image;\n      }\n    }, []); // Только при монтировании\n\n    // Постоянная защита от сброса изображения при перерендере\n    // Этот эффект проверяет и восстанавливает изображение из хранилища, если оно было сброшено\n    useEffect(() => {\n      // Только для новой формы (без ID) и только если пользователь загрузил изображение\n      if (!photoId && userHasUploadedRef.current) {\n        // Сначала проверяем хранилище\n        const storedImage = uploadedImagesStore && uploadedImagesStore.has(formKey) ? uploadedImagesStore.get(formKey) : null;\n        if (storedImage) {\n          // Восстанавливаем из хранилища\n          uploadedImageRef.current = storedImage;\n          setImage(storedImage);\n          return;\n        }\n\n        // Если в хранилище нет, но в ref есть - восстанавливаем из ref\n        if (uploadedImageRef.current) {\n          // Сохраняем в хранилище для будущих перерендеров\n          if (uploadedImagesStore && formKey) {\n            uploadedImagesStore.set(formKey, uploadedImageRef.current);\n          }\n          setImage(uploadedImageRef.current);\n        }\n      }\n    }); // Без зависимостей - срабатывает при каждом рендере для защиты\n\n    const handleChange = e => {\n      if (e.target.name === 'caption') {\n        setCaption(e.target.value);\n      }\n    };\n    const processFile = async file => {\n      if (!file) {\n        return;\n      }\n\n      // Проверяем тип файла\n      if (!file.type.startsWith('image/')) {\n        onAlert('Выберите файл изображения', 'error');\n        return;\n      }\n\n      // Проверяем размер файла (максимум 5MB)\n      if (file.size > 5 * 1024 * 1024) {\n        onAlert('Размер файла не должен превышать 5MB', 'error');\n        return;\n      }\n      setIsUploading(true);\n      try {\n        const base64 = await convertFileToBase64(file);\n\n        // Устанавливаем флаг, что пользователь загрузил изображение\n        userHasUploadedRef.current = true;\n        uploadedImageRef.current = base64; // Сохраняем в ref для защиты от сброса\n\n        // Сохраняем в глобальное хранилище, чтобы не потерять при перерендере\n        if (uploadedImagesStore && formKey) {\n          uploadedImagesStore.set(formKey, base64);\n        }\n\n        // Обновляем состояние изображения через функциональное обновление\n        // чтобы гарантировать, что мы используем актуальное состояние\n        setImage(prevImage => {\n          // Если изображение уже установлено и совпадает, не обновляем\n          if (prevImage === base64) {\n            return prevImage;\n          }\n          return base64;\n        });\n\n        // Откладываем вызов onAlert, чтобы дать React время обновить состояние\n        // Используем задержку, чтобы гарантировать, что состояние обновлено\n        // и компонент успел отрендериться с новым изображением\n        setTimeout(() => {\n          // Финальная проверка перед вызовом onAlert\n          setImage(currentImage => {\n            // Если изображение было сброшено, но в ref оно есть - восстанавливаем\n            if (!currentImage && uploadedImageRef.current) {\n              return uploadedImageRef.current;\n            }\n            return currentImage;\n          });\n\n          // Вызываем onAlert только после подтверждения, что изображение установлено\n          onAlert('Изображение загружено', 'success');\n        }, 150);\n      } catch (error) {\n        console.error('Ошибка загрузки файла:', error);\n        onAlert('Ошибка загрузки файла', 'error');\n      } finally {\n        setIsUploading(false);\n      }\n    };\n    const handleFileChange = async e => {\n      var _e$target$files;\n      // Защита от повторных вызовов\n      if (isProcessingFileRef.current) {\n        return;\n      }\n      const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n      if (!file) {\n        return;\n      }\n\n      // Устанавливаем флаг обработки\n      isProcessingFileRef.current = true;\n\n      // Сохраняем ссылку на input для очистки после обработки\n      const input = e.target;\n      try {\n        await processFile(file);\n      } finally {\n        // Сбрасываем флаг обработки\n        isProcessingFileRef.current = false;\n\n        // Очищаем input после обработки, чтобы можно было выбрать тот же файл снова\n        // Делаем это с небольшой задержкой, чтобы не мешать обработке\n        setTimeout(() => {\n          if (input) {\n            input.value = '';\n          }\n        }, 100);\n      }\n    };\n    const handleDragOver = e => {\n      e.preventDefault();\n      e.stopPropagation();\n      setIsDragging(true);\n    };\n    const handleDragLeave = e => {\n      e.preventDefault();\n      e.stopPropagation();\n      setIsDragging(false);\n    };\n    const handleDrop = async e => {\n      var _e$dataTransfer$files;\n      e.preventDefault();\n      e.stopPropagation();\n      setIsDragging(false);\n      const file = (_e$dataTransfer$files = e.dataTransfer.files) === null || _e$dataTransfer$files === void 0 ? void 0 : _e$dataTransfer$files[0];\n      if (file) {\n        console.log('Файл перетащен (PhotoForm):', file.name, file.type, file.size);\n        await processFile(file);\n      }\n    };\n    const handleSubmit = e => {\n      e.preventDefault();\n      e.stopPropagation();\n      if (!image || !image.trim()) {\n        onAlert('Загрузите изображение', 'error');\n        return;\n      }\n      if (!image.startsWith('data:image')) {\n        onAlert('Ошибка: изображение не загружено правильно', 'error');\n        return;\n      }\n      const photoData = {\n        ...((photo === null || photo === void 0 ? void 0 : photo.id) && {\n          id: photo.id\n        }),\n        image: image.trim(),\n        caption: caption.trim() || undefined\n      };\n      onSave(photoData);\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: photo ? 'Редактировать фото' : 'Добавить фото'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1128,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          noValidate: true,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1131,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `file-upload-dropzone ${isDragging ? 'dragging' : ''} ${image ? 'has-image' : ''}`,\n              onDragOver: handleDragOver,\n              onDragLeave: handleDragLeave,\n              onDrop: handleDrop,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"file-upload-wrapper\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  ref: fileInputRef,\n                  type: \"file\",\n                  accept: \"image/*\",\n                  onChange: handleFileChange,\n                  className: \"file-input-hidden\",\n                  disabled: isUploading\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1139,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  className: \"file-upload-button\",\n                  onClick: e => {\n                    e.preventDefault();\n                    if (fileInputRef.current) {\n                      fileInputRef.current.click();\n                    }\n                  },\n                  disabled: isUploading,\n                  children: isUploading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"upload-icon\",\n                      children: \"\\u23F3\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1160,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1161,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"upload-icon\",\n                      children: \"\\uD83D\\uDCF7\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1165,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: \"\\u0412\\u044B\\u0431\\u0440\\u0430\\u0442\\u044C \\u0438\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0435\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1166,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1147,\n                  columnNumber: 19\n                }, this), image && !isUploading && /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  className: \"file-remove-button\",\n                  onClick: () => {\n                    userHasUploadedRef.current = false; // Сбрасываем флаг при удалении\n                    setImage('');\n                    if (fileInputRef.current) {\n                      fileInputRef.current.value = '';\n                    }\n                  },\n                  children: \"\\u2715\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1171,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1138,\n                columnNumber: 17\n              }, this), !image && /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"drag-drop-hint\",\n                children: \"\\u0438\\u043B\\u0438 \\u043F\\u0435\\u0440\\u0435\\u0442\\u0430\\u0449\\u0438\\u0442\\u0435 \\u0438\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0435 \\u0441\\u044E\\u0434\\u0430\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1187,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1132,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1130,\n            columnNumber: 13\n          }, this), image && image.trim() ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1196,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"photo-preview-modern\",\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                src: image,\n                alt: \"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\",\n                onError: e => {\n                  e.target.src = 'https://via.placeholder.com/300x200/8B7355/FFFFFF?text=Тбилиси';\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1198,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"photo-preview-overlay\",\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"preview-badge\",\n                  children: \"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1206,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1205,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1197,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1195,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              style: {\n                color: '#999',\n                fontStyle: 'italic',\n                fontSize: '0.9rem'\n              },\n              children: \"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440 \\u043F\\u043E\\u044F\\u0432\\u0438\\u0442\\u0441\\u044F \\u043F\\u043E\\u0441\\u043B\\u0435 \\u0432\\u044B\\u0431\\u043E\\u0440\\u0430 \\u0444\\u0430\\u0439\\u043B\\u0430\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1212,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1211,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u041F\\u043E\\u0434\\u043F\\u0438\\u0441\\u044C (\\u043D\\u0435\\u043E\\u0431\\u044F\\u0437\\u0430\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1219,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"caption\",\n              value: caption,\n              onChange: handleChange,\n              placeholder: \"\\u041F\\u043E\\u0434\\u043F\\u0438\\u0441\\u044C \\u043A \\u0444\\u043E\\u0442\\u043E\\u0433\\u0440\\u0430\\u0444\\u0438\\u0438\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1220,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1218,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-actions\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"save-btn\",\n              children: photo ? 'Обновить' : 'Добавить'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1230,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"cancel-btn\",\n              onClick: onCancel,\n              children: \"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1233,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1229,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1129,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1127,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1126,\n      columnNumber: 7\n    }, this);\n  };\n  _s3(PhotoForm, \"EHjmfwt2fgchKZvvwfFR2dBNgzU=\");\n  const MenuItemForm = ({\n    item,\n    onSave,\n    onCancel,\n    onAlert,\n    menuImagesStore,\n    formKey\n  }) => {\n    _s4();\n    const defaultCategory = categories.length > 0 ? categories[0].key : 'cold';\n\n    // Инициализируем refs ДО useState, чтобы можно было использовать их в инициализаторе\n    const fileInputRef = useRef(null);\n    const isProcessingFileRef = useRef(false); // Флаг: файл обрабатывается\n    const uploadedImageRef = useRef(null); // Сохраняем загруженное изображение\n    const userHasUploadedRef = useRef(false); // Флаг: пользователь загрузил изображение\n\n    // Ключ для сохранения данных формы в localStorage\n    const formDataStorageKey = `menu-item-form-${formKey}`;\n    const [formData, setFormData] = useState(() => {\n      // Если редактируем существующий элемент - используем его данные\n      if (item) {\n        const baseData = {\n          ...item,\n          price: item.price.toString().replace(' ₽', '')\n        };\n        if (item.image) {\n          baseData.image = item.image;\n          uploadedImageRef.current = item.image;\n        }\n        return baseData;\n      }\n\n      // Для новой формы - пытаемся восстановить из localStorage\n      const savedFormData = localStorage.getItem(formDataStorageKey);\n      if (savedFormData) {\n        try {\n          const parsed = JSON.parse(savedFormData);\n          const baseData = {\n            name: parsed.name || '',\n            price: parsed.price || '',\n            weight: parsed.weight || '',\n            description: parsed.description || '',\n            image: parsed.image || '',\n            category: parsed.category || defaultCategory\n          };\n\n          // Восстанавливаем изображение из хранилища, если есть\n          if (menuImagesStore && menuImagesStore.has(formKey)) {\n            baseData.image = menuImagesStore.get(formKey);\n            uploadedImageRef.current = baseData.image;\n            userHasUploadedRef.current = true;\n          } else if (parsed.image) {\n            baseData.image = parsed.image;\n            uploadedImageRef.current = parsed.image;\n            userHasUploadedRef.current = true;\n          }\n          console.log('📝 MenuItemForm: Восстановлены данные из localStorage:', baseData);\n          return baseData;\n        } catch (e) {\n          console.error('Ошибка восстановления данных формы из localStorage:', e);\n        }\n      }\n\n      // Если нет сохраненных данных - создаем пустую форму\n      const baseData = {\n        name: '',\n        price: '',\n        weight: '',\n        description: '',\n        image: '',\n        category: defaultCategory\n      };\n\n      // Восстанавливаем изображение из хранилища, если есть\n      if (menuImagesStore && menuImagesStore.has(formKey)) {\n        baseData.image = menuImagesStore.get(formKey);\n        uploadedImageRef.current = baseData.image;\n        userHasUploadedRef.current = true;\n      }\n      return baseData;\n    });\n    const [errors, setErrors] = useState({});\n    const [isUploading, setIsUploading] = useState(false);\n\n    // Постоянная защита от сброса изображения при перерендере\n    // Этот эффект проверяет и восстанавливает изображение из хранилища, если оно было сброшено\n    // ВАЖНО: используем зависимости только для item и formKey, НЕ для formData.image\n    // чтобы не срабатывать при каждом изменении изображения\n    useEffect(() => {\n      // Если редактируем существующий элемент - восстанавливаем его изображение\n      if (item && item.image && !formData.image) {\n        setFormData(prev => {\n          // ВАЖНО: сохраняем все предыдущие поля, обновляем только изображение\n          if (prev.image !== item.image) {\n            uploadedImageRef.current = item.image;\n            return {\n              ...prev,\n              image: item.image\n            };\n          }\n          return prev;\n        });\n        return;\n      }\n\n      // Только если пользователь загрузил изображение (для новых элементов)\n      // И только если изображение было потеряно (formData.image пустое)\n      if (userHasUploadedRef.current && !formData.image) {\n        // Сначала проверяем хранилище\n        const storedImage = menuImagesStore && menuImagesStore.has(formKey) ? menuImagesStore.get(formKey) : null;\n        if (storedImage) {\n          // Восстанавливаем из хранилища\n          uploadedImageRef.current = storedImage;\n          setFormData(prev => {\n            // ВАЖНО: сохраняем все предыдущие поля, обновляем только изображение\n            return {\n              ...prev,\n              image: storedImage\n            };\n          });\n          return;\n        }\n\n        // Если в хранилище нет, но в ref есть - восстанавливаем из ref\n        if (uploadedImageRef.current) {\n          // Сохраняем в хранилище для будущих перерендеров\n          if (menuImagesStore && formKey) {\n            menuImagesStore.set(formKey, uploadedImageRef.current);\n          }\n          setFormData(prev => {\n            // ВАЖНО: сохраняем все предыдущие поля, обновляем только изображение\n            return {\n              ...prev,\n              image: uploadedImageRef.current\n            };\n          });\n        }\n      }\n    }, [item === null || item === void 0 ? void 0 : item.image, formKey]); // НЕ включаем formData.image, чтобы не срабатывать при загрузке\n\n    const validateField = (name, value) => {\n      const newErrors = {\n        ...errors\n      };\n      switch (name) {\n        case 'name':\n          if (!value.trim()) newErrors.name = 'Название обязательно';else delete newErrors.name;\n          break;\n        case 'price':\n          if (!value || isNaN(parseFloat(value)) || parseFloat(value) <= 0) newErrors.price = 'Введите корректную цену';else delete newErrors.price;\n          break;\n        case 'weight':\n          if (!value.trim()) newErrors.weight = 'Вес/объем обязателен';else delete newErrors.weight;\n          break;\n        case 'description':\n          if (!value.trim()) newErrors.description = 'Описание обязательно';else delete newErrors.description;\n          break;\n        case 'image':\n          if (!value.trim()) newErrors.image = 'Загрузите изображение';else if (!value.startsWith('data:image')) {\n            newErrors.image = 'Загрузите файл изображения';\n          } else delete newErrors.image;\n          break;\n        default:\n          break;\n      }\n      setErrors(newErrors);\n    };\n    const handleChange = e => {\n      const {\n        name,\n        value\n      } = e.target;\n      setFormData(prev => {\n        const updated = {\n          ...prev,\n          [name]: value\n        };\n        validateField(name, value);\n        return updated;\n      });\n    };\n    const handleFileChange = async e => {\n      var _e$target$files2;\n      // Защита от повторных вызовов\n      if (isProcessingFileRef.current) {\n        return;\n      }\n      const file = (_e$target$files2 = e.target.files) === null || _e$target$files2 === void 0 ? void 0 : _e$target$files2[0];\n      if (!file) {\n        return;\n      }\n\n      // Устанавливаем флаг обработки\n      isProcessingFileRef.current = true;\n\n      // Сохраняем ссылку на input для очистки после обработки\n      const input = e.target;\n\n      // Проверяем тип файла\n      if (!file.type.startsWith('image/')) {\n        onAlert('Выберите файл изображения', 'error');\n        isProcessingFileRef.current = false;\n        return;\n      }\n\n      // Проверяем размер файла (максимум 5MB)\n      if (file.size > 5 * 1024 * 1024) {\n        onAlert('Размер файла не должен превышать 5MB', 'error');\n        isProcessingFileRef.current = false;\n        return;\n      }\n      setIsUploading(true);\n      try {\n        const base64 = await convertFileToBase64(file);\n\n        // Устанавливаем флаг, что пользователь загрузил изображение\n        userHasUploadedRef.current = true;\n        uploadedImageRef.current = base64; // Сохраняем в ref для защиты от сброса\n\n        // Сохраняем в глобальное хранилище, чтобы не потерять при перерендере\n        if (menuImagesStore && formKey) {\n          menuImagesStore.set(formKey, base64);\n        }\n\n        // Используем функциональное обновление для гарантии актуального состояния\n        // ВАЖНО: сохраняем все предыдущие поля формы явно\n        setFormData(prev => {\n          console.log('🖼️ handleFileChange: Предыдущие данные формы:', {\n            name: prev.name,\n            price: prev.price,\n            weight: prev.weight,\n            description: prev.description,\n            category: prev.category,\n            image: prev.image ? 'есть' : 'нет'\n          });\n          const updated = {\n            name: prev.name || '',\n            // Явно сохраняем каждое поле\n            price: prev.price || '',\n            weight: prev.weight || '',\n            description: prev.description || '',\n            category: prev.category || defaultCategory,\n            image: base64 // Обновляем только изображение\n          };\n          console.log('🖼️ handleFileChange: Обновленные данные формы:', {\n            name: updated.name,\n            price: updated.price,\n            weight: updated.weight,\n            description: updated.description,\n            category: updated.category,\n            image: 'загружено'\n          });\n\n          // Валидацию вызываем после обновления состояния\n          setTimeout(() => validateField('image', base64), 0);\n          return updated;\n        });\n\n        // Откладываем вызов onAlert, чтобы дать React время обновить состояние\n        setTimeout(() => {\n          // Финальная проверка перед вызовом onAlert\n          // ВАЖНО: сохраняем все поля формы при проверке\n          setFormData(currentData => {\n            console.log('🖼️ handleFileChange (setTimeout): Проверка данных формы:', {\n              name: currentData.name,\n              price: currentData.price,\n              weight: currentData.weight,\n              description: currentData.description,\n              category: currentData.category,\n              image: currentData.image ? 'есть' : 'нет'\n            });\n\n            // Если изображение было сброшено, но в ref оно есть - восстанавливаем\n            if (!currentData.image && uploadedImageRef.current) {\n              console.log('🖼️ handleFileChange: Восстанавливаем изображение из ref');\n              return {\n                name: currentData.name || '',\n                // Явно сохраняем все поля\n                price: currentData.price || '',\n                weight: currentData.weight || '',\n                description: currentData.description || '',\n                category: currentData.category || defaultCategory,\n                image: uploadedImageRef.current\n              };\n            }\n            // Если все в порядке, просто возвращаем текущие данные без изменений\n            return currentData;\n          });\n\n          // Вызываем onAlert только после подтверждения, что изображение установлено\n          onAlert('Изображение загружено', 'success');\n        }, 150);\n      } catch (error) {\n        console.error('Ошибка загрузки файла (MenuItemForm):', error);\n        onAlert('Ошибка загрузки файла', 'error');\n      } finally {\n        setIsUploading(false);\n        // Сбрасываем флаг обработки\n        isProcessingFileRef.current = false;\n\n        // Очищаем input после обработки, чтобы можно было выбрать тот же файл снова\n        setTimeout(() => {\n          if (input) {\n            input.value = '';\n          }\n        }, 100);\n      }\n    };\n    const handleSubmit = e => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      // Валидация всех полей перед отправкой\n      const newErrors = {};\n      Object.keys(formData).forEach(key => {\n        if (key !== 'category') {\n          const fieldValue = formData[key];\n          if (key === 'image') {\n            if (!fieldValue || !fieldValue.trim()) {\n              newErrors.image = 'Загрузите изображение';\n            } else if (!fieldValue.startsWith('data:image')) {\n              newErrors.image = 'Загрузите файл изображения';\n            }\n          } else if (key === 'name' && !(fieldValue !== null && fieldValue !== void 0 && fieldValue.trim())) {\n            newErrors.name = 'Название обязательно';\n          } else if (key === 'price' && (!fieldValue || isNaN(parseFloat(fieldValue)) || parseFloat(fieldValue) <= 0)) {\n            newErrors.price = 'Введите корректную цену';\n          } else if (key === 'weight' && !(fieldValue !== null && fieldValue !== void 0 && fieldValue.trim())) {\n            newErrors.weight = 'Вес/объем обязателен';\n          } else if (key === 'description' && !(fieldValue !== null && fieldValue !== void 0 && fieldValue.trim())) {\n            newErrors.description = 'Описание обязательно';\n          }\n        }\n      });\n      setErrors(newErrors);\n      if (Object.keys(newErrors).length === 0 && formData.image && formData.image.startsWith('data:image')) {\n        onSave(formData);\n      } else {\n        if (!formData.image || !formData.image.startsWith('data:image')) {\n          showAlert('Загрузите изображение', 'error');\n        } else {\n          showAlert('Исправьте ошибки в форме', 'error');\n        }\n      }\n    };\n    const isFormValid = () => {\n      return formData.name && formData.price && formData.weight && formData.description && formData.image && Object.keys(errors).length === 0;\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-modal\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: item ? 'Редактировать блюдо' : 'Добавить новое блюдо'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1602,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          noValidate: true,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1605,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"name\",\n              value: formData.name,\n              onChange: handleChange,\n              className: errors.name ? 'error' : '',\n              placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0431\\u043B\\u044E\\u0434\\u0430\",\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1606,\n              columnNumber: 15\n            }, this), errors.name && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"error-text\",\n              children: errors.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1615,\n              columnNumber: 31\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1604,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"\\u0426\\u0435\\u043D\\u0430 (\\u20BD) *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1620,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                name: \"price\",\n                value: formData.price,\n                onChange: handleChange,\n                className: errors.price ? 'error' : '',\n                placeholder: \"0\",\n                min: \"1\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1621,\n                columnNumber: 17\n              }, this), errors.price && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"error-text\",\n                children: errors.price\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1631,\n                columnNumber: 34\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1619,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"\\u0412\\u0435\\u0441/\\u041E\\u0431\\u044A\\u0435\\u043C *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1635,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                name: \"weight\",\n                value: formData.weight,\n                onChange: handleChange,\n                className: errors.weight ? 'error' : '',\n                placeholder: \"150 \\u0433 \\u0438\\u043B\\u0438 500 \\u043C\\u043B\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1636,\n                columnNumber: 17\n              }, this), errors.weight && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"error-text\",\n                children: errors.weight\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1645,\n                columnNumber: 35\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1634,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044F *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1649,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                name: \"category\",\n                value: formData.category,\n                onChange: handleChange,\n                children: categories.map(cat => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: cat.key,\n                  children: cat.name\n                }, cat.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1656,\n                  columnNumber: 21\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1650,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1648,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1618,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435 *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1663,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              name: \"description\",\n              value: formData.description,\n              onChange: handleChange,\n              className: errors.description ? 'error' : '',\n              rows: \"3\",\n              placeholder: \"\\u041E\\u043F\\u0438\\u0448\\u0438\\u0442\\u0435 \\u0431\\u043B\\u044E\\u0434\\u043E\",\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1664,\n              columnNumber: 15\n            }, this), errors.description && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"error-text\",\n              children: errors.description\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1673,\n              columnNumber: 38\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1662,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1677,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"file-upload-wrapper\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                ref: fileInputRef,\n                type: \"file\",\n                accept: \"image/*\",\n                onChange: handleFileChange,\n                className: \"file-input-hidden\",\n                disabled: isUploading\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1679,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"file-upload-button\",\n                onClick: e => {\n                  e.preventDefault();\n                  if (fileInputRef.current) {\n                    console.log('Клик по кнопке (MenuItemForm), открываем файловый диалог');\n                    fileInputRef.current.click();\n                  } else {\n                    console.error('fileInputRef.current is null (MenuItemForm)');\n                  }\n                },\n                disabled: isUploading,\n                children: isUploading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"upload-icon\",\n                    children: \"\\u23F3\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1703,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1704,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"upload-icon\",\n                    children: \"\\uD83D\\uDCF7\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1708,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"\\u0412\\u044B\\u0431\\u0440\\u0430\\u0442\\u044C \\u0438\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0435\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1709,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1687,\n                columnNumber: 17\n              }, this), formData.image && !isUploading && /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"file-remove-button\",\n                onClick: () => {\n                  userHasUploadedRef.current = false;\n                  uploadedImageRef.current = null;\n                  // Очищаем из хранилища\n                  if (menuImagesStore && formKey) {\n                    menuImagesStore.delete(formKey);\n                  }\n                  setFormData({\n                    ...formData,\n                    image: ''\n                  });\n                  if (fileInputRef.current) {\n                    fileInputRef.current.value = '';\n                  }\n                  validateField('image', '');\n                },\n                children: \"\\u2715\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1714,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1678,\n              columnNumber: 15\n            }, this), errors.image && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"error-text\",\n              children: errors.image\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1735,\n              columnNumber: 32\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1676,\n            columnNumber: 13\n          }, this), formData.image && formData.image.trim() && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1740,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"photo-preview-modern\",\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                src: formData.image,\n                alt: \"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\",\n                onLoad: () => console.log('Изображение загружено в предпросмотр (MenuItemForm)'),\n                onError: e => {\n                  console.error('Ошибка загрузки изображения в предпросмотр (MenuItemForm)');\n                  e.target.src = 'https://via.placeholder.com/300x200/8B7355/FFFFFF?text=Тбилиси';\n                }\n              }, formData.image.substring(0, 50), false, {\n                fileName: _jsxFileName,\n                lineNumber: 1742,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"photo-preview-overlay\",\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"preview-badge\",\n                  children: \"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1753,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1752,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1741,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1739,\n            columnNumber: 15\n          }, this), !formData.image && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              style: {\n                color: '#999',\n                fontStyle: 'italic',\n                fontSize: '0.9rem'\n              },\n              children: \"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440 \\u043F\\u043E\\u044F\\u0432\\u0438\\u0442\\u0441\\u044F \\u043F\\u043E\\u0441\\u043B\\u0435 \\u0432\\u044B\\u0431\\u043E\\u0440\\u0430 \\u0444\\u0430\\u0439\\u043B\\u0430\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1760,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1759,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-actions\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"save-btn\",\n              disabled: !isFormValid(),\n              children: item ? 'Обновить' : 'Добавить'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1767,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"cancel-btn\",\n              onClick: onCancel,\n              children: \"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1774,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1766,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1603,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1601,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1600,\n      columnNumber: 7\n    }, this);\n  };\n  _s4(MenuItemForm, \"/H39IwWVhoKPSuPOzNn9ifKK5Qg=\");\n  const formatPrice = price => {\n    if (typeof price === 'string' && price.includes('₽')) {\n      return price;\n    }\n    const priceNum = parseInt(price);\n    return isNaN(priceNum) ? '0 ₽' : `${priceNum} ₽`;\n  };\n  const handleImageError = e => {\n    e.target.src = 'https://via.placeholder.com/300x200/8B7355/FFFFFF?text=Тбилиси';\n  };\n\n  // Стабилизируем photo prop для PhotoForm, чтобы избежать пересоздания компонента\n  const stablePhotoForForm = useMemo(() => {\n    if (editingPhoto === null) return null;\n    return editingPhoto.id ? editingPhoto : null;\n  }, [editingPhoto === null || editingPhoto === void 0 ? void 0 : editingPhoto.id]);\n\n  // Если не авторизован, показываем форму входа\n  if (!isAuthenticated) {\n    return /*#__PURE__*/_jsxDEV(LoginForm, {\n      onLogin: handleLogin\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1804,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"admin-page\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"admin-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"admin-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"\\u0410\\u0434\\u043C\\u0438\\u043D-\\u043F\\u0430\\u043D\\u0435\\u043B\\u044C \\\"\\u0422\\u0431\\u0438\\u043B\\u0438\\u0441\\u0438\\\"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1812,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLogout,\n          className: \"logout-btn\",\n          children: \"\\u0412\\u044B\\u0439\\u0442\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1813,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1811,\n        columnNumber: 9\n      }, this), showNotification && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `admin-notification ${notificationType}`,\n        children: [notificationMessage, /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowNotification(false),\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1822,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1820,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"admin-tabs\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: `tab-button ${activeTab === 'reservations' ? 'active' : ''}`,\n          onClick: () => handleTabChange('reservations'),\n          children: [\"\\u0417\\u0430\\u044F\\u0432\\u043A\\u0438 (\", reservations.length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1828,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `tab-button ${activeTab === 'menu' ? 'active' : ''}`,\n          onClick: () => handleTabChange('menu'),\n          children: [\"\\u041C\\u0435\\u043D\\u044E (\", menuItems.length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1834,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `tab-button ${activeTab === 'categories' ? 'active' : ''}`,\n          onClick: () => handleTabChange('categories'),\n          children: [\"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438 (\", categories.length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1840,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `tab-button ${activeTab === 'themes' ? 'active' : ''}`,\n          onClick: () => handleTabChange('themes'),\n          children: [\"\\u0422\\u0435\\u043C\\u044B (\", Object.keys(themes).length + 1, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1846,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: `tab-button ${activeTab === 'photos' ? 'active' : ''}`,\n          onClick: () => handleTabChange('photos'),\n          children: [\"\\u0424\\u043E\\u0442\\u043E (\", photos.length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1852,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1827,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tab-content\",\n        children: [activeTab === 'reservations' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"reservations-tab\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\u0417\\u0430\\u044F\\u0432\\u043A\\u0438 \\u043D\\u0430 \\u0431\\u0440\\u043E\\u043D\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1864,\n            columnNumber: 15\n          }, this), reservations.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"no-data\",\n            children: \"\\u041D\\u0435\\u0442 \\u0437\\u0430\\u044F\\u0432\\u043E\\u043A \\u043D\\u0430 \\u0431\\u0440\\u043E\\u043D\\u044C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1867,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"reservations-list\",\n            children: reservations.map(reservation => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"reservation-card\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"reservation-header\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: reservation.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1873,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"reservation-date\",\n                  children: new Date(reservation.createdAt).toLocaleDateString('ru-RU')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1874,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1872,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"reservation-details\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1879,\n                    columnNumber: 28\n                  }, this), \" \", reservation.phone]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1879,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"\\u0414\\u0430\\u0442\\u0430:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1880,\n                    columnNumber: 28\n                  }, this), \" \", reservation.date, \" \\u0432 \", reservation.time]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1880,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"\\u0413\\u043E\\u0441\\u0442\\u0435\\u0439:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1881,\n                    columnNumber: 28\n                  }, this), \" \", reservation.guests]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1881,\n                  columnNumber: 25\n                }, this), reservation.comments && /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"\\u041A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1883,\n                    columnNumber: 30\n                  }, this), \" \", reservation.comments]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1883,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1878,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  if (window.confirm('Вы уверены, что хотите удалить эту заявку?')) {\n                    deleteReservation(reservation.id);\n                  }\n                },\n                className: \"delete-btn\",\n                children: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1886,\n                columnNumber: 23\n              }, this)]\n            }, reservation.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1871,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1869,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1863,\n          columnNumber: 13\n        }, this), activeTab === 'menu' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"menu-tab\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"menu-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"\\u0423\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u043C\\u0435\\u043D\\u044E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1906,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setEditingItem({}),\n              className: \"add-btn\",\n              children: \"+ \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0431\\u043B\\u044E\\u0434\\u043E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1907,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1905,\n            columnNumber: 15\n          }, this), menuItems.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"no-data\",\n            children: \"\\u041C\\u0435\\u043D\\u044E \\u043F\\u0443\\u0441\\u0442\\u043E. \\u0414\\u043E\\u0431\\u0430\\u0432\\u044C\\u0442\\u0435 \\u043D\\u043E\\u0432\\u044B\\u0435 \\u0431\\u043B\\u044E\\u0434\\u0430 \\u0447\\u0435\\u0440\\u0435\\u0437 \\u0444\\u043E\\u0440\\u043C\\u0443 \\u0432\\u044B\\u0448\\u0435.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1916,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"menu-items-grid\",\n            children: menuItems.map(item => {\n              var _categories$find;\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"menu-item-card\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"item-image\",\n                  children: /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: item.image,\n                    alt: item.name,\n                    onError: handleImageError\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1922,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1921,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"item-content\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                    children: item.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1929,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"item-price\",\n                    children: [formatPrice(item.price), \" \\xB7 \", item.weight]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1930,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"item-description\",\n                    children: item.description\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1931,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"item-category\",\n                    children: ((_categories$find = categories.find(cat => cat.key === item.category)) === null || _categories$find === void 0 ? void 0 : _categories$find.name) || item.category\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1932,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1928,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"item-actions\",\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => startEditing(item),\n                    className: \"edit-btn\",\n                    children: \"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1937,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => {\n                      if (window.confirm('Вы уверены, что хотите удалить это блюдо?')) {\n                        deleteMenuItem(item.id);\n                      }\n                    },\n                    className: \"delete-btn\",\n                    children: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1943,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1936,\n                  columnNumber: 23\n                }, this)]\n              }, item.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1920,\n                columnNumber: 21\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1918,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1904,\n          columnNumber: 13\n        }, this), activeTab === 'categories' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"categories-tab\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"categories-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"\\u0423\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044F\\u043C\\u0438\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1964,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: addCategory,\n              className: \"add-btn\",\n              children: \"+ \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1965,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1963,\n            columnNumber: 15\n          }, this), categories.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"no-data\",\n            children: \"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0439 \\u043D\\u0435\\u0442. \\u0414\\u043E\\u0431\\u0430\\u0432\\u044C\\u0442\\u0435 \\u043D\\u043E\\u0432\\u0443\\u044E \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044E.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1974,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"categories-list\",\n            children: categories.map((category, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"category-card\",\n              children: editingCategory && editingCategory.id === category.id ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"category-edit-form\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  value: editingCategory.name,\n                  onChange: e => setEditingCategory({\n                    ...editingCategory,\n                    name: e.target.value\n                  }),\n                  className: \"category-name-input\",\n                  placeholder: \"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438\",\n                  autoFocus: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1981,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"category-edit-actions\",\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => updateCategory(editingCategory),\n                    className: \"save-btn\",\n                    children: \"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1990,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => setEditingCategory(null),\n                    className: \"cancel-btn\",\n                    children: \"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1996,\n                    columnNumber: 29\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1989,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1980,\n                columnNumber: 25\n              }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"category-info\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                    children: category.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2007,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"category-key\",\n                    children: [\"\\u041A\\u043B\\u044E\\u0447: \", category.key]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2008,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"category-order\",\n                    children: [\"\\u041F\\u043E\\u0440\\u044F\\u0434\\u043E\\u043A: \", category.order]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2009,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"category-items-count\",\n                    children: [\"\\u0411\\u043B\\u044E\\u0434 \\u0432 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438: \", menuItems.filter(item => item.category === category.key).length]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2010,\n                    columnNumber: 29\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2006,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"category-actions\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"category-order-controls\",\n                    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => moveCategory(category.id, 'up'),\n                      className: \"move-btn\",\n                      disabled: index === 0,\n                      title: \"\\u041F\\u0435\\u0440\\u0435\\u043C\\u0435\\u0441\\u0442\\u0438\\u0442\\u044C \\u0432\\u0432\\u0435\\u0440\\u0445\",\n                      children: \"\\u2191\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2016,\n                      columnNumber: 31\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => moveCategory(category.id, 'down'),\n                      className: \"move-btn\",\n                      disabled: index === categories.length - 1,\n                      title: \"\\u041F\\u0435\\u0440\\u0435\\u043C\\u0435\\u0441\\u0442\\u0438\\u0442\\u044C \\u0432\\u043D\\u0438\\u0437\",\n                      children: \"\\u2193\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2024,\n                      columnNumber: 31\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2015,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => setEditingCategory({\n                      ...category\n                    }),\n                    className: \"edit-btn\",\n                    children: \"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2033,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => {\n                      if (window.confirm('Вы уверены, что хотите удалить эту категорию?')) {\n                        deleteCategory(category.id);\n                      }\n                    },\n                    className: \"delete-btn\",\n                    children: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2039,\n                    columnNumber: 29\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2014,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true)\n            }, category.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1978,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1976,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1962,\n          columnNumber: 13\n        }, this), activeTab === 'themes' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"themes-tab\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"themes-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"\\u0423\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u0442\\u0435\\u043C\\u0430\\u043C\\u0438\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2062,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: addTheme,\n              className: \"add-btn\",\n              children: \"+ \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0442\\u0435\\u043C\\u0443\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2063,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2061,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"themes-list\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: `theme-card ${currentTheme === 'default' ? 'active' : ''}`,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"theme-preview\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"theme-preview-colors\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"preview-color\",\n                    style: {\n                      background: '#8B7355'\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2076,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"preview-color\",\n                    style: {\n                      background: '#A8D8EA'\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2077,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"preview-color\",\n                    style: {\n                      background: '#D4B896'\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2078,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2075,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2074,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"theme-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: \"\\u041F\\u043E \\u0443\\u043C\\u043E\\u043B\\u0447\\u0430\\u043D\\u0438\\u044E\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2082,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"theme-description\",\n                  children: \"\\u0411\\u0430\\u0437\\u043E\\u0432\\u0430\\u044F \\u0437\\u0435\\u043C\\u043B\\u044F\\u043D\\u0430\\u044F \\u0442\\u0435\\u043C\\u0430\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2083,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2081,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"theme-actions\",\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => applyTheme('default'),\n                  className: `apply-btn ${currentTheme === 'default' ? 'active' : ''}`,\n                  children: currentTheme === 'default' ? '✓ Применена' : 'Применить'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2086,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2085,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2073,\n              columnNumber: 17\n            }, this), Object.values(defaultThemes).map(theme => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `theme-card ${currentTheme === theme.id ? 'active' : ''}`,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"theme-preview\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"theme-preview-colors\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"preview-color\",\n                    style: {\n                      background: theme.primaryColor\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2100,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"preview-color\",\n                    style: {\n                      background: theme.secondaryColor\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2101,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"preview-color\",\n                    style: {\n                      background: theme.accentColor\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2102,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2099,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2098,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"theme-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: theme.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2106,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"theme-description\",\n                  children: \"\\u0411\\u0430\\u0437\\u043E\\u0432\\u0430\\u044F \\u0442\\u0435\\u043C\\u0430\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2107,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2105,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"theme-actions\",\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => applyTheme(theme.id),\n                  className: `apply-btn ${currentTheme === theme.id ? 'active' : ''}`,\n                  children: currentTheme === theme.id ? '✓ Применена' : 'Применить'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2110,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2109,\n                columnNumber: 21\n              }, this)]\n            }, theme.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2097,\n              columnNumber: 19\n            }, this)), Object.values(themes).filter(theme => !defaultThemes[theme.id]).map(theme => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `theme-card ${currentTheme === theme.id ? 'active' : ''}`,\n              children: editingTheme && editingTheme.id === theme.id ? /*#__PURE__*/_jsxDEV(ThemeEditForm, {\n                theme: editingTheme,\n                onSave: updateTheme,\n                onCancel: () => setEditingTheme(null)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2124,\n                columnNumber: 23\n              }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"theme-preview\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"theme-preview-colors\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"preview-color\",\n                      style: {\n                        background: theme.primaryColor\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2133,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"preview-color\",\n                      style: {\n                        background: theme.secondaryColor\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2134,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"preview-color\",\n                      style: {\n                        background: theme.accentColor\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2135,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2132,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2131,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"theme-info\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                    children: theme.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2139,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"theme-description\",\n                    children: \"\\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C\\u0441\\u043A\\u0430\\u044F \\u0442\\u0435\\u043C\\u0430\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2140,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2138,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"theme-actions\",\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => applyTheme(theme.id),\n                    className: `apply-btn ${currentTheme === theme.id ? 'active' : ''}`,\n                    children: currentTheme === theme.id ? '✓ Применена' : 'Применить'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2143,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => setEditingTheme({\n                      ...theme\n                    }),\n                    className: \"edit-btn\",\n                    children: \"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2149,\n                    columnNumber: 27\n                  }, this), !defaultThemes[theme.id] && /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => {\n                      if (window.confirm('Вы уверены, что хотите удалить эту тему?')) {\n                        deleteTheme(theme.id);\n                      }\n                    },\n                    className: \"delete-btn\",\n                    children: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2156,\n                    columnNumber: 29\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2142,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true)\n            }, theme.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2122,\n              columnNumber: 19\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2071,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2060,\n          columnNumber: 13\n        }, this), activeTab === 'photos' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"photos-tab\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"photos-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"\\u0423\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u0444\\u043E\\u0442\\u043E\\u0433\\u0440\\u0430\\u0444\\u0438\\u044F\\u043C\\u0438\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2179,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                // Используем стабильный объект для новой формы\n                setEditingPhoto(newPhotoObjectRef.current);\n              },\n              className: \"add-btn\",\n              children: \"+ \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0444\\u043E\\u0442\\u043E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2180,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2178,\n            columnNumber: 15\n          }, this), photos.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"no-data\",\n            children: \"\\u0424\\u043E\\u0442\\u043E\\u0433\\u0440\\u0430\\u0444\\u0438\\u0439 \\u043D\\u0435\\u0442. \\u0414\\u043E\\u0431\\u0430\\u0432\\u044C\\u0442\\u0435 \\u043D\\u043E\\u0432\\u0443\\u044E \\u0444\\u043E\\u0442\\u043E\\u0433\\u0440\\u0430\\u0444\\u0438\\u044E.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2192,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"photos-grid\",\n            children: photos.map(photo => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"photo-card\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"photo-image\",\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: photo.image,\n                  alt: photo.caption || 'Фото',\n                  onError: e => {\n                    e.target.src = 'https://via.placeholder.com/300x200/8B7355/FFFFFF?text=Тбилиси';\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2198,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2197,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"photo-info\",\n                children: [photo.caption && /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"photo-caption\",\n                  children: photo.caption\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2208,\n                  columnNumber: 27\n                }, this), !photo.caption && /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"photo-caption-empty\",\n                  children: \"\\u0411\\u0435\\u0437 \\u043F\\u043E\\u0434\\u043F\\u0438\\u0441\\u0438\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2211,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2206,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"photo-actions\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => setEditingPhoto({\n                    ...photo\n                  }),\n                  className: \"edit-btn\",\n                  children: \"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2215,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => {\n                    if (window.confirm('Вы уверены, что хотите удалить это фото?')) {\n                      deletePhoto(photo.id);\n                    }\n                  },\n                  className: \"delete-btn\",\n                  children: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2221,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2214,\n                columnNumber: 23\n              }, this)]\n            }, photo.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2196,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2194,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2177,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1861,\n        columnNumber: 9\n      }, this), editingItem !== null && /*#__PURE__*/_jsxDEV(MenuItemForm, {\n        // Стабильный key\n        item: editingItem.id ? editingItem : null,\n        onSave: saveMenuItem,\n        onCancel: cancelEditing,\n        onAlert: showAlert,\n        menuImagesStore: menuImagesStore.current // Передаем хранилище для сохранения состояния\n        ,\n        formKey: (editingItem === null || editingItem === void 0 ? void 0 : editingItem.id) || newMenuItemKeyRef.current // Уникальный ключ формы\n      }, (editingItem === null || editingItem === void 0 ? void 0 : editingItem.id) || newMenuItemKeyRef.current, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2242,\n        columnNumber: 11\n      }, this), editingPhoto !== null && /*#__PURE__*/_jsxDEV(PhotoForm, {\n        // Стабильный key\n        photo: stablePhotoForForm,\n        onSave: savePhoto,\n        onCancel: cancelPhotoEditing,\n        onAlert: showAlert,\n        uploadedImagesStore: uploadedImagesStore.current // Передаем хранилище для сохранения состояния\n        ,\n        formKey: (editingPhoto === null || editingPhoto === void 0 ? void 0 : editingPhoto.id) || newPhotoKeyRef.current // Уникальный ключ формы\n      }, (editingPhoto === null || editingPhoto === void 0 ? void 0 : editingPhoto.id) || newPhotoKeyRef.current, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2255,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1809,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 1808,\n    columnNumber: 5\n  }, this);\n};\n_s5(Admin, \"5m53iLuUvnp1lTH5eDM0IF0GrAU=\");\n_c = Admin;\nexport default Admin;\nvar _c;\n$RefreshReg$(_c, \"Admin\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useMemo","useCallback","autoSaveReservations","autoSaveMenu","autoSavePhotos","loadTheme","loadMenu","loadReservations","loadCategories","saveTheme","saveCategories","defaultMenu","jsxDEV","_jsxDEV","Fragment","_Fragment","defaultCategories","id","key","name","order","defaultThemes","elegant","primaryColor","primaryLight","primaryDark","secondaryColor","secondaryLight","secondaryDark","accentColor","backgroundColor","textColor","textLight","Admin","_s5","_s","$RefreshSig$","_s2","_s3","_s4","isAuthenticated","setIsAuthenticated","localStorage","getItem","activeTab","setActiveTab","reservations","setReservations","menuItems","setMenuItems","categories","setCategories","themes","setThemes","currentTheme","setCurrentTheme","photos","setPhotos","editingItem","setEditingItem","editingCategory","setEditingCategory","editingTheme","setEditingTheme","editingPhoto","setEditingPhoto","newPhotoKeyRef","Date","now","newPhotoObjectRef","uploadedImagesStore","Map","newMenuItemKeyRef","menuImagesStore","showNotification","setShowNotification","notificationMessage","setNotificationMessage","notificationType","setNotificationType","handleTabChange","tab","formKey","current","has","delete","loadCategoriesFromFile","loadedCategories","Array","isArray","length","sorted","sort","a","b","error","console","loadReservationsFromFile","loadedReservations","loadMenuItemsFromFile","loadedMenu","loadThemesFromFile","themeData","allThemes","currentThemeId","applyThemeOnLoad","themeId","themesToUse","document","documentElement","className","root","style","removeProperty","theme","setProperty","loadPhotos","saved","savedPhotos","JSON","parse","saveCategoriesToFile","updatedCategories","saveResult","success","showAlert","message","addCategory","newCategory","updated","updateCategory","category","trim","map","cat","deleteCategory","find","itemsInCategory","filter","item","forEach","index","moveCategory","direction","findIndex","newIndex","type","setTimeout","handleLogin","username","password","setItem","handleLogout","removeItem","applyTheme","saveThemes","updatedThemes","hexToRgb","hex","result","exec","r","parseInt","g","rgbToHex","x","toString","join","lightenColor","percent","rgb","Math","min","round","darkenColor","max","addTheme","basePrimaryColor","newTheme","updateTheme","updatedTheme","deleteTheme","deleteReservation","res","deleteMenuItem","cancelPhotoEditing","savePhoto","photo","image","startsWith","p","newPhoto","deletePhoto","validateMenuItem","price","isNaN","parseFloat","weight","description","saveMenuItem","formattedItem","replace","updatedItems","menuItem","newItem","startEditing","cancelEditing","ThemeEditForm","onSave","onCancel","formData","setFormData","hexToRgbLocal","rgbToHexLocal","lightenColorLocal","darkenColorLocal","handleChange","field","value","handleSubmit","e","preventDefault","colorFields","label","children","onSubmit","fileName","_jsxFileName","lineNumber","columnNumber","onChange","target","placeholder","required","background","onClick","convertFileToBase64","file","Promise","resolve","reject","reader","FileReader","onload","onerror","readAsDataURL","LoginForm","onLogin","setUsername","setPassword","setError","htmlFor","autoFocus","PhotoForm","onAlert","photoId","photoIdRef","isInitialMountRef","setImage","get","caption","setCaption","isUploading","setIsUploading","isDragging","setIsDragging","fileInputRef","userHasUploadedRef","uploadedImageRef","isProcessingFileRef","isInitialMount","storedImage","set","processFile","size","base64","prevImage","currentImage","handleFileChange","_e$target$files","files","input","handleDragOver","stopPropagation","handleDragLeave","handleDrop","_e$dataTransfer$files","dataTransfer","log","photoData","undefined","noValidate","onDragOver","onDragLeave","onDrop","ref","accept","disabled","click","src","alt","onError","color","fontStyle","fontSize","MenuItemForm","defaultCategory","formDataStorageKey","baseData","savedFormData","parsed","errors","setErrors","prev","validateField","newErrors","_e$target$files2","currentData","Object","keys","fieldValue","isFormValid","rows","onLoad","substring","formatPrice","includes","priceNum","handleImageError","stablePhotoForForm","reservation","createdAt","toLocaleDateString","phone","date","time","guests","comments","window","confirm","_categories$find","title","values","_c","$RefreshReg$"],"sources":["C:/restaurant-website (2)/restaurant-website/Backend/ClientApp/src/pages/Admin.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useMemo, useCallback } from 'react';\nimport './Admin.css';\nimport { \n  autoSaveReservations, \n  autoSaveMenu, \n  autoSavePhotos, \n  loadTheme, \n  loadMenu, \n  loadReservations, \n  loadCategories,\n  saveTheme,\n  saveCategories\n} from '../utils/fileStorage';\nimport { defaultMenu } from '../data/defaultMenu';\n\n// Базовые категории по умолчанию\nconst defaultCategories = [\n  { id: 1, key: 'cold', name: 'Холодные закуски', order: 1 },\n  { id: 2, key: 'salads', name: 'Салаты', order: 2 },\n  { id: 3, key: 'hot', name: 'Горячие блюда', order: 3 },\n  { id: 4, key: 'drinks', name: 'Напитки', order: 4 }\n];\n\n// Базовые темы по умолчанию\nconst defaultThemes = {\n  elegant: {\n    id: 'elegant',\n    name: 'Элегантная синяя',\n    primaryColor: '#2C3E50',\n    primaryLight: '#34495E',\n    primaryDark: '#1C2833',\n    secondaryColor: '#3498DB',\n    secondaryLight: '#5DADE2',\n    secondaryDark: '#2980B9',\n    accentColor: '#E74C3C',\n    backgroundColor: '#ECF0F1',\n    textColor: '#2C3E50',\n    textLight: '#566573'\n  }\n};\n\nconst Admin = () => {\n  // Проверяем авторизацию из localStorage при загрузке\n  const [isAuthenticated, setIsAuthenticated] = useState(() => {\n    return localStorage.getItem('admin-authenticated') === 'true';\n  });\n  \n  const [activeTab, setActiveTab] = useState('reservations');\n  const [reservations, setReservations] = useState([]);\n  const [menuItems, setMenuItems] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [themes, setThemes] = useState({});\n  const [currentTheme, setCurrentTheme] = useState('default');\n  const [photos, setPhotos] = useState([]);\n  const [editingItem, setEditingItem] = useState(null);\n  const [editingCategory, setEditingCategory] = useState(null);\n  const [editingTheme, setEditingTheme] = useState(null);\n  const [editingPhoto, setEditingPhoto] = useState(null);\n  const newPhotoKeyRef = useRef(`new-photo-${Date.now()}`); // Стабильный key для новой формы\n  const newPhotoObjectRef = useRef({}); // Стабильный объект для новой формы\n  // Глобальное хранилище для загруженных изображений (вне компонента, чтобы не терять при перерендере)\n  const uploadedImagesStore = useRef(new Map()); // key -> base64 image\n  const newMenuItemKeyRef = useRef(`new-menu-item-${Date.now()}`); // Стабильный key для новой формы меню\n  // Глобальное хранилище для загруженных изображений меню\n  const menuImagesStore = useRef(new Map()); // key -> base64 image\n  const [showNotification, setShowNotification] = useState(false);\n  const [notificationMessage, setNotificationMessage] = useState('');\n  const [notificationType, setNotificationType] = useState('success');\n\n  // Функция для переключения вкладок с закрытием всех модальных окон\n  const handleTabChange = (tab) => {\n    // Закрываем все открытые модальные окна\n    // Очищаем хранилище при переключении вкладок\n    if (editingItem) {\n      const formKey = editingItem?.id || newMenuItemKeyRef.current;\n      if (menuImagesStore.current.has(formKey)) {\n        menuImagesStore.current.delete(formKey);\n      }\n    }\n    setEditingItem(null);\n    setEditingCategory(null);\n    setEditingTheme(null);\n    if (editingPhoto) {\n      const formKey = editingPhoto?.id || newPhotoKeyRef.current;\n      if (uploadedImagesStore.current.has(formKey)) {\n        uploadedImagesStore.current.delete(formKey);\n      }\n    }\n    setEditingPhoto(null);\n    // Переключаем вкладку\n    setActiveTab(tab);\n  };\n\n  useEffect(() => {\n    const loadCategoriesFromFile = async () => {\n      try {\n        const loadedCategories = await loadCategories();\n        if (Array.isArray(loadedCategories) && loadedCategories.length > 0) {\n          const sorted = [...loadedCategories].sort((a, b) => a.order - b.order);\n          setCategories(sorted);\n        } else {\n          setCategories([...defaultCategories]);\n        }\n      } catch (error) {\n        console.error('Ошибка загрузки категорий:', error);\n        setCategories([...defaultCategories]);\n      }\n    };\n\n    const loadReservationsFromFile = async () => {\n      try {\n        const loadedReservations = await loadReservations();\n        setReservations(loadedReservations);\n      } catch (error) {\n        console.error('Ошибка загрузки заявок:', error);\n        setReservations([]);\n      }\n    };\n\n    const loadMenuItemsFromFile = async () => {\n      try {\n        const loadedMenu = await loadMenu();\n        if (Array.isArray(loadedMenu) && loadedMenu.length > 0) {\n          setMenuItems(loadedMenu);\n        } else {\n          // Если меню пустое, используем базовое\n          setMenuItems([...defaultMenu]);\n        }\n      } catch (error) {\n        console.error('Ошибка загрузки меню:', error);\n        setMenuItems([...defaultMenu]);\n      }\n    };\n\n    const loadThemesFromFile = async () => {\n      try {\n        const themeData = await loadTheme();\n        // Объединяем базовые темы с загруженными\n        const allThemes = { ...defaultThemes, ...themeData.themes };\n        setThemes(allThemes);\n        \n        // Устанавливаем текущую тему\n        const currentThemeId = themeData.currentTheme || 'default';\n        setCurrentTheme(currentThemeId);\n        // Применяем тему при загрузке с использованием загруженных тем\n        applyThemeOnLoad(currentThemeId, allThemes);\n      } catch (error) {\n        console.error('Ошибка загрузки тем:', error);\n        setThemes(defaultThemes);\n        setCurrentTheme('default');\n        applyThemeOnLoad('default', defaultThemes);\n      }\n    };\n\n    const applyThemeOnLoad = (themeId, themesToUse = null) => {\n      // Используем переданные темы или загружаем из состояния\n      const allThemes = themesToUse || { ...defaultThemes, ...themes };\n      \n      if (themeId === 'default') {\n        document.documentElement.className = '';\n        const root = document.documentElement;\n        root.style.removeProperty('--primary-color');\n        root.style.removeProperty('--primary-light');\n        root.style.removeProperty('--primary-dark');\n        root.style.removeProperty('--secondary-color');\n        root.style.removeProperty('--secondary-light');\n        root.style.removeProperty('--secondary-dark');\n        root.style.removeProperty('--accent-color');\n        root.style.removeProperty('--background-color');\n        root.style.removeProperty('--text-color');\n        root.style.removeProperty('--text-light');\n        // Устанавливаем фон html в цвет по умолчанию\n        document.documentElement.style.backgroundColor = '#8B7355';\n        return;\n      }\n      \n      // Проверяем базовые темы\n      if (defaultThemes[themeId]) {\n        const theme = defaultThemes[themeId];\n        const root = document.documentElement;\n        root.style.setProperty('--primary-color', theme.primaryColor);\n        root.style.setProperty('--primary-light', theme.primaryLight);\n        root.style.setProperty('--primary-dark', theme.primaryDark);\n        root.style.setProperty('--secondary-color', theme.secondaryColor);\n        root.style.setProperty('--secondary-light', theme.secondaryLight);\n        root.style.setProperty('--secondary-dark', theme.secondaryDark);\n        root.style.setProperty('--accent-color', theme.accentColor);\n        root.style.setProperty('--background-color', theme.backgroundColor);\n        root.style.setProperty('--text-color', theme.textColor);\n        root.style.setProperty('--text-light', theme.textLight);\n        // Устанавливаем фон html для overscroll\n        document.documentElement.style.backgroundColor = theme.primaryColor;\n        return;\n      }\n      \n      // Проверяем пользовательские темы\n      const theme = allThemes[themeId];\n      if (theme) {\n        const root = document.documentElement;\n        root.style.setProperty('--primary-color', theme.primaryColor);\n        root.style.setProperty('--primary-light', theme.primaryLight);\n        root.style.setProperty('--primary-dark', theme.primaryDark);\n        root.style.setProperty('--secondary-color', theme.secondaryColor);\n        root.style.setProperty('--secondary-light', theme.secondaryLight);\n        root.style.setProperty('--secondary-dark', theme.secondaryDark);\n        root.style.setProperty('--accent-color', theme.accentColor);\n        root.style.setProperty('--background-color', theme.backgroundColor);\n        root.style.setProperty('--text-color', theme.textColor);\n        root.style.setProperty('--text-light', theme.textLight);\n        // Устанавливаем фон html для overscroll\n        document.documentElement.style.backgroundColor = theme.primaryColor;\n      }\n    };\n\n    const loadPhotos = () => {\n      const saved = localStorage.getItem('restaurant-photos');\n      if (saved) {\n        try {\n          const savedPhotos = JSON.parse(saved);\n          if (Array.isArray(savedPhotos)) {\n            setPhotos(savedPhotos);\n            return;\n          }\n        } catch (error) {\n          console.error('Ошибка загрузки фотографий:', error);\n        }\n      }\n      setPhotos([]);\n    };\n\n    loadCategoriesFromFile();\n    loadReservationsFromFile();\n    loadMenuItemsFromFile();\n    loadThemesFromFile();\n    loadPhotos();\n  }, []);\n\n  const saveCategoriesToFile = async (updatedCategories) => {\n    // Сортируем по порядку перед сохранением\n    const sorted = [...updatedCategories].sort((a, b) => a.order - b.order);\n    setCategories(sorted);\n    const saveResult = await saveCategories(sorted);\n    if (!saveResult.success) {\n      showAlert(`Ошибка скачивания файла категорий: ${saveResult.message}`, 'error');\n    } else {\n      showAlert('Файл categories.json скачан', 'success');\n    }\n  };\n\n  const addCategory = async () => {\n    const newCategory = {\n      id: Date.now(),\n      key: `category_${Date.now()}`,\n      name: 'Новая категория',\n      order: categories.length + 1\n    };\n    const updated = [...categories, newCategory];\n    await saveCategoriesToFile(updated);\n    setEditingCategory(newCategory);\n    showAlert('Категория добавлена', 'success');\n  };\n\n  const updateCategory = async (category) => {\n    if (!category.name || !category.name.trim()) {\n      showAlert('Введите название категории', 'error');\n      return;\n    }\n    const updated = categories.map(cat => \n      cat.id === category.id ? category : cat\n    );\n    await saveCategoriesToFile(updated);\n    setEditingCategory(null);\n    showAlert('Категория обновлена', 'success');\n  };\n\n  const deleteCategory = async (id) => {\n    // Проверяем, используется ли категория в блюдах\n    const category = categories.find(cat => cat.id === id);\n    if (category) {\n      const itemsInCategory = menuItems.filter(item => item.category === category.key);\n      if (itemsInCategory.length > 0) {\n        showAlert(`Нельзя удалить категорию: в ней есть ${itemsInCategory.length} блюд(а)`, 'error');\n        return;\n      }\n    }\n    \n    const updated = categories.filter(cat => cat.id !== id);\n    // Обновляем порядок оставшихся категорий\n    updated.forEach((cat, index) => {\n      cat.order = index + 1;\n    });\n    await saveCategoriesToFile(updated);\n    showAlert('Категория удалена', 'success');\n  };\n\n  const moveCategory = async (id, direction) => {\n    const index = categories.findIndex(cat => cat.id === id);\n    if (index === -1) return;\n    \n    const newIndex = direction === 'up' ? index - 1 : index + 1;\n    if (newIndex < 0 || newIndex >= categories.length) return;\n    \n    const updated = [...categories];\n    [updated[index].order, updated[newIndex].order] = [updated[newIndex].order, updated[index].order];\n    await saveCategoriesToFile(updated);\n  };\n\n  const showAlert = useCallback((message, type = 'success') => {\n    setNotificationMessage(message);\n    setNotificationType(type);\n    setShowNotification(true);\n    setTimeout(() => setShowNotification(false), 4000);\n  }, []);\n\n  // Функция авторизации\n  const handleLogin = (username, password) => {\n    if (username === 'admin' && password === 'Tbil4dSokol') {\n      setIsAuthenticated(true);\n      localStorage.setItem('admin-authenticated', 'true');\n      showAlert('Добро пожаловать в админ-панель!', 'success');\n      return true;\n    } else {\n      showAlert('Неверный логин или пароль', 'error');\n      return false;\n    }\n  };\n\n  // Функция выхода\n  const handleLogout = () => {\n    setIsAuthenticated(false);\n    localStorage.removeItem('admin-authenticated');\n    showAlert('Вы вышли из админ-панели', 'success');\n  };\n\n  // Функции управления темами\n  const applyTheme = async (themeId) => {\n    setCurrentTheme(themeId);\n    \n    if (themeId === 'default') {\n      document.documentElement.className = '';\n      const root = document.documentElement;\n      root.style.removeProperty('--primary-color');\n      root.style.removeProperty('--primary-light');\n      root.style.removeProperty('--primary-dark');\n      root.style.removeProperty('--secondary-color');\n      root.style.removeProperty('--secondary-light');\n      root.style.removeProperty('--secondary-dark');\n      root.style.removeProperty('--accent-color');\n      root.style.removeProperty('--background-color');\n      root.style.removeProperty('--text-color');\n      root.style.removeProperty('--text-light');\n      // Сохраняем тему в файл\n      const saveResult = await saveTheme({ currentTheme: themeId, themes: themes });\n      if (saveResult.success) {\n        showAlert('Тема \"По умолчанию\" применена. Файл theme.json скачан.', 'success');\n      } else {\n        showAlert(`Тема применена, но файл не скачан: ${saveResult.message}`, 'error');\n      }\n      return;\n    }\n    \n    // Проверяем базовые темы\n    if (defaultThemes[themeId]) {\n      const theme = defaultThemes[themeId];\n      const root = document.documentElement;\n      root.style.setProperty('--primary-color', theme.primaryColor);\n      root.style.setProperty('--primary-light', theme.primaryLight);\n      root.style.setProperty('--primary-dark', theme.primaryDark);\n      root.style.setProperty('--secondary-color', theme.secondaryColor);\n      root.style.setProperty('--secondary-light', theme.secondaryLight);\n      root.style.setProperty('--secondary-dark', theme.secondaryDark);\n      root.style.setProperty('--accent-color', theme.accentColor);\n      root.style.setProperty('--background-color', theme.backgroundColor);\n      root.style.setProperty('--text-color', theme.textColor);\n      root.style.setProperty('--text-light', theme.textLight);\n      // Сохраняем тему в файл\n      const saveResult = await saveTheme({ currentTheme: themeId, themes: themes });\n      if (saveResult.success) {\n        showAlert(`Тема \"${theme.name}\" применена. Файл theme.json скачан.`, 'success');\n      } else {\n        showAlert(`Тема применена, но файл не скачан: ${saveResult.message}`, 'error');\n      }\n      return;\n    }\n    \n    // Проверяем пользовательские темы\n    const theme = themes[themeId];\n    if (theme) {\n      const root = document.documentElement;\n      root.style.setProperty('--primary-color', theme.primaryColor);\n      root.style.setProperty('--primary-light', theme.primaryLight);\n      root.style.setProperty('--primary-dark', theme.primaryDark);\n      root.style.setProperty('--secondary-color', theme.secondaryColor);\n      root.style.setProperty('--secondary-light', theme.secondaryLight);\n      root.style.setProperty('--secondary-dark', theme.secondaryDark);\n      root.style.setProperty('--accent-color', theme.accentColor);\n      root.style.setProperty('--background-color', theme.backgroundColor);\n      root.style.setProperty('--text-color', theme.textColor);\n      root.style.setProperty('--text-light', theme.textLight);\n      // Сохраняем тему в файл\n      const saveResult = await saveTheme({ currentTheme: themeId, themes: themes });\n      if (saveResult.success) {\n        showAlert(`Тема \"${theme.name}\" применена. Файл theme.json скачан.`, 'success');\n      } else {\n        showAlert(`Тема применена, но файл не скачан: ${saveResult.message}`, 'error');\n      }\n    }\n  };\n\n  const saveThemes = async (updatedThemes) => {\n    // Объединяем базовые темы с пользовательскими для сохранения\n    const allThemes = { ...defaultThemes, ...updatedThemes };\n    setThemes(allThemes);\n    // Сохраняем в файл\n    const saveResult = await saveTheme({ currentTheme: currentTheme, themes: allThemes });\n    if (!saveResult.success) {\n      showAlert(`Ошибка скачивания файла тем: ${saveResult.message}`, 'error');\n    } else {\n      showAlert('Файл theme.json скачан', 'success');\n    }\n  };\n\n  // Функции для автоматического вычисления светлого и темного вариантов цвета\n  const hexToRgb = (hex) => {\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? {\n      r: parseInt(result[1], 16),\n      g: parseInt(result[2], 16),\n      b: parseInt(result[3], 16)\n    } : null;\n  };\n\n  const rgbToHex = (r, g, b) => {\n    return \"#\" + [r, g, b].map(x => {\n      const hex = x.toString(16);\n      return hex.length === 1 ? \"0\" + hex : hex;\n    }).join(\"\");\n  };\n\n  const lightenColor = (hex, percent = 20) => {\n    const rgb = hexToRgb(hex);\n    if (!rgb) return hex;\n    \n    const r = Math.min(255, Math.round(rgb.r + (255 - rgb.r) * (percent / 100)));\n    const g = Math.min(255, Math.round(rgb.g + (255 - rgb.g) * (percent / 100)));\n    const b = Math.min(255, Math.round(rgb.b + (255 - rgb.b) * (percent / 100)));\n    \n    return rgbToHex(r, g, b);\n  };\n\n  const darkenColor = (hex, percent = 20) => {\n    const rgb = hexToRgb(hex);\n    if (!rgb) return hex;\n    \n    const r = Math.max(0, Math.round(rgb.r * (1 - percent / 100)));\n    const g = Math.max(0, Math.round(rgb.g * (1 - percent / 100)));\n    const b = Math.max(0, Math.round(rgb.b * (1 - percent / 100)));\n    \n    return rgbToHex(r, g, b);\n  };\n\n  const addTheme = () => {\n    const basePrimaryColor = '#8B7355';\n    const newTheme = {\n      id: `theme_${Date.now()}`,\n      name: 'Новая тема',\n      primaryColor: basePrimaryColor,\n      primaryLight: lightenColor(basePrimaryColor, 20),\n      primaryDark: darkenColor(basePrimaryColor, 20),\n      secondaryColor: '#A8D8EA',\n      secondaryLight: '#C5E7F5',\n      secondaryDark: '#7BB8D4',\n      accentColor: '#D4B896',\n      backgroundColor: '#FDF6E3',\n      textColor: '#333333',\n      textLight: '#666666'\n    };\n    const updated = { ...themes, [newTheme.id]: newTheme };\n    saveThemes(updated);\n    setEditingTheme(newTheme);\n    showAlert('Тема добавлена', 'success');\n  };\n\n  const updateTheme = (theme) => {\n    if (!theme.name || !theme.name.trim()) {\n      showAlert('Введите название темы', 'error');\n      return;\n    }\n    // Автоматически вычисляем светлый и темный варианты основного цвета\n    const updatedTheme = {\n      ...theme,\n      primaryLight: lightenColor(theme.primaryColor, 20),\n      primaryDark: darkenColor(theme.primaryColor, 20)\n    };\n    const updated = { ...themes, [updatedTheme.id]: updatedTheme };\n    saveThemes(updated);\n    setEditingTheme(null);\n    showAlert('Тема обновлена', 'success');\n  };\n\n  const deleteTheme = (id) => {\n    if (defaultThemes[id]) {\n      showAlert('Базовые темы нельзя удалять', 'error');\n      return;\n    }\n    const updated = { ...themes };\n    delete updated[id];\n    saveThemes(updated);\n    if (currentTheme === id) {\n      applyTheme('default');\n    }\n    showAlert('Тема удалена', 'success');\n  };\n\n  const deleteReservation = async (id) => {\n    const updated = reservations.filter(res => res.id !== id);\n    setReservations(updated);\n    const saveResult = await autoSaveReservations(updated);\n    if (saveResult.success) {\n      showAlert('Заявка успешно удалена', 'success');\n    } else {\n      showAlert(`Заявка удалена, но файл не скачан: ${saveResult.message}`, 'error');\n    }\n  };\n\n  const deleteMenuItem = async (id) => {\n    // Удаляем элемент из меню\n    const updated = menuItems.filter(item => item.id !== id);\n    setMenuItems(updated);\n    \n    // Сохраняем все оставшиеся элементы в файл\n    await autoSaveMenu(updated);\n    showAlert('Блюдо успешно удалено', 'success');\n  };\n\n  const cancelPhotoEditing = useCallback(() => {\n    // Очищаем хранилище для новой формы при отмене\n    const formKey = editingPhoto?.id || newPhotoKeyRef.current;\n    if (uploadedImagesStore.current.has(formKey)) {\n      uploadedImagesStore.current.delete(formKey);\n    }\n    setEditingPhoto(null);\n  }, [editingPhoto]);\n\n  const savePhoto = useCallback(async (photo) => {\n    if (!photo.image || !photo.image.trim()) {\n      showAlert('Загрузите изображение', 'error');\n      return;\n    }\n    if (!photo.image.startsWith('data:image')) {\n      showAlert('Загрузите файл изображения', 'error');\n      return;\n    }\n\n    let updated;\n    if (photo.id) {\n      // Редактирование существующей фотографии\n      updated = photos.map(p => p.id === photo.id ? photo : p);\n    } else {\n      // Добавление новой фотографии\n      const newPhoto = {\n        ...photo,\n        id: Date.now()\n      };\n      updated = [...photos, newPhoto];\n    }\n    \n    setPhotos(updated);\n    await autoSavePhotos(updated);\n    \n    // Очищаем хранилище для этой формы после сохранения\n    const formKey = photo.id || newPhotoKeyRef.current;\n    if (uploadedImagesStore.current.has(formKey)) {\n      uploadedImagesStore.current.delete(formKey);\n    }\n    \n    setEditingPhoto(null);\n    showAlert(photo.id ? 'Фотография обновлена' : 'Фотография добавлена', 'success');\n  }, [photos]);\n\n  const deletePhoto = async (id) => {\n    const updated = photos.filter(p => p.id !== id);\n    setPhotos(updated);\n    await autoSavePhotos(updated);\n    showAlert('Фотография удалена', 'success');\n  };\n\n  const validateMenuItem = (item) => {\n    if (!item.name || !item.name.trim()) {\n      showAlert('Введите название блюда', 'error');\n      return false;\n    }\n    if (!item.price || isNaN(parseFloat(item.price)) || parseFloat(item.price) <= 0) {\n      showAlert('Введите корректную цену (больше 0)', 'error');\n      return false;\n    }\n    if (!item.weight || !item.weight.trim()) {\n      showAlert('Введите вес/объем', 'error');\n      return false;\n    }\n    if (!item.description || !item.description.trim()) {\n      showAlert('Введите описание блюда', 'error');\n      return false;\n    }\n    if (!item.image || !item.image.trim()) {\n      showAlert('Загрузите изображение', 'error');\n      return false;\n    }\n    if (!item.image.startsWith('data:image')) {\n      showAlert('Загрузите файл изображения', 'error');\n      return false;\n    }\n    return true;\n  };\n\n  const saveMenuItem = async (item) => {\n    if (!validateMenuItem(item)) return;\n\n    // Форматируем цену (убираем \"₽\" если есть и преобразуем в число)\n    const formattedItem = {\n      ...item,\n      price: item.price.toString().replace(' ₽', '')\n    };\n\n    let updatedItems;\n    if (editingItem && editingItem.id) {\n      // Редактирование существующего блюда (любого, включая базовые)\n      updatedItems = menuItems.map(menuItem => \n        menuItem.id === editingItem.id ? { ...formattedItem, id: editingItem.id } : menuItem\n      );\n      showAlert('Блюдо успешно обновлено', 'success');\n    } else {\n      // Добавление нового блюда\n      const newItem = {\n        ...formattedItem,\n        id: Date.now()\n      };\n      updatedItems = [...menuItems, newItem];\n      showAlert('Блюдо успешно добавлено', 'success');\n    }\n\n    setMenuItems(updatedItems);\n    \n    // Сохраняем все элементы в файл (включая отредактированные базовые)\n    const saveResult = await autoSaveMenu(updatedItems);\n    if (!saveResult.success) {\n      showAlert(`Ошибка скачивания файла меню: ${saveResult.message}`, 'error');\n    } else {\n      showAlert('Файл menu.json скачан', 'success');\n    }\n    \n    // Очищаем хранилище для этой формы после сохранения\n    const formKey = editingItem?.id || newMenuItemKeyRef.current;\n    if (menuImagesStore.current.has(formKey)) {\n      menuImagesStore.current.delete(formKey);\n    }\n    \n    setEditingItem(null);\n  };\n\n  const startEditing = (item) => {\n    setEditingItem(item);\n  };\n\n  const cancelEditing = useCallback(() => {\n    // Очищаем хранилище для новой формы при отмене\n    const formKey = editingItem?.id || newMenuItemKeyRef.current;\n    if (menuImagesStore.current.has(formKey)) {\n      menuImagesStore.current.delete(formKey);\n    }\n    setEditingItem(null);\n  }, [editingItem]);\n\n  // Компонент формы редактирования темы\n  const ThemeEditForm = ({ theme, onSave, onCancel }) => {\n    const [formData, setFormData] = useState(theme);\n\n    // Функции для вычисления вариантов цвета (локальные копии)\n    const hexToRgbLocal = (hex) => {\n      const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n      return result ? {\n        r: parseInt(result[1], 16),\n        g: parseInt(result[2], 16),\n        b: parseInt(result[3], 16)\n      } : null;\n    };\n\n    const rgbToHexLocal = (r, g, b) => {\n      return \"#\" + [r, g, b].map(x => {\n        const hex = x.toString(16);\n        return hex.length === 1 ? \"0\" + hex : hex;\n      }).join(\"\");\n    };\n\n    const lightenColorLocal = (hex, percent = 20) => {\n      const rgb = hexToRgbLocal(hex);\n      if (!rgb) return hex;\n      \n      const r = Math.min(255, Math.round(rgb.r + (255 - rgb.r) * (percent / 100)));\n      const g = Math.min(255, Math.round(rgb.g + (255 - rgb.g) * (percent / 100)));\n      const b = Math.min(255, Math.round(rgb.b + (255 - rgb.b) * (percent / 100)));\n      \n      return rgbToHexLocal(r, g, b);\n    };\n\n    const darkenColorLocal = (hex, percent = 20) => {\n      const rgb = hexToRgbLocal(hex);\n      if (!rgb) return hex;\n      \n      const r = Math.max(0, Math.round(rgb.r * (1 - percent / 100)));\n      const g = Math.max(0, Math.round(rgb.g * (1 - percent / 100)));\n      const b = Math.max(0, Math.round(rgb.b * (1 - percent / 100)));\n      \n      return rgbToHexLocal(r, g, b);\n    };\n\n    const handleChange = (field, value) => {\n      const updated = {\n        ...formData,\n        [field]: value\n      };\n      \n      // Если изменяется основной цвет, автоматически вычисляем светлый и темный варианты\n      if (field === 'primaryColor') {\n        updated.primaryLight = lightenColorLocal(value, 20);\n        updated.primaryDark = darkenColorLocal(value, 20);\n      }\n      \n      setFormData(updated);\n    };\n\n    const handleSubmit = (e) => {\n      e.preventDefault();\n      onSave(formData);\n    };\n\n    const colorFields = [\n      { key: 'primaryColor', label: 'Основной цвет' },\n      { key: 'secondaryColor', label: 'Цвет кнопок и ссылок' },\n      { key: 'secondaryLight', label: 'Цвет кнопок при наведении' },\n      { key: 'secondaryDark', label: 'Цвет активных элементов' },\n      { key: 'accentColor', label: 'Акцентный цвет (выделения)' },\n      { key: 'backgroundColor', label: 'Цвет фона страницы' },\n      { key: 'textColor', label: 'Цвет основного текста' },\n      { key: 'textLight', label: 'Цвет второстепенного текста' }\n    ];\n\n    return (\n      <div className=\"theme-edit-form\">\n        <form onSubmit={handleSubmit}>\n          <div className=\"form-group\">\n            <label>Название темы *</label>\n            <input\n              type=\"text\"\n              value={formData.name}\n              onChange={(e) => handleChange('name', e.target.value)}\n              placeholder=\"Название темы\"\n              required\n            />\n          </div>\n\n          <div className=\"theme-colors-grid\">\n            {colorFields.map(field => (\n              <div key={field.key} className=\"color-picker-group\">\n                <label>{field.label}</label>\n                <div className=\"color-picker-wrapper\">\n                  <input\n                    type=\"color\"\n                    value={formData[field.key]}\n                    onChange={(e) => handleChange(field.key, e.target.value)}\n                    className=\"color-picker\"\n                  />\n                  <input\n                    type=\"text\"\n                    value={formData[field.key]}\n                    onChange={(e) => handleChange(field.key, e.target.value)}\n                    className=\"color-input\"\n                    placeholder=\"#000000\"\n                  />\n                  <div \n                    className=\"color-preview\"\n                    style={{ background: formData[field.key] }}\n                  ></div>\n                </div>\n              </div>\n            ))}\n          </div>\n\n          <div className=\"form-actions\">\n            <button type=\"submit\" className=\"save-btn\">\n              Сохранить\n            </button>\n            <button type=\"button\" className=\"cancel-btn\" onClick={onCancel}>\n              Отмена\n            </button>\n          </div>\n        </form>\n      </div>\n    );\n  };\n\n  // Функция для конвертации файла в base64\n  const convertFileToBase64 = (file) => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = () => resolve(reader.result);\n      reader.onerror = reject;\n      reader.readAsDataURL(file);\n    });\n  };\n\n  // Компонент формы авторизации\n  const LoginForm = ({ onLogin }) => {\n    const [username, setUsername] = useState('');\n    const [password, setPassword] = useState('');\n    const [error, setError] = useState('');\n\n    const handleSubmit = (e) => {\n      e.preventDefault();\n      setError('');\n      \n      if (!username.trim() || !password.trim()) {\n        setError('Заполните все поля');\n        return;\n      }\n\n      const success = onLogin(username, password);\n      if (!success) {\n        setError('Неверный логин или пароль');\n        setPassword('');\n      }\n    };\n\n    return (\n      <div className=\"admin-login-container\">\n        <div className=\"admin-login-form\">\n          <div className=\"admin-login-header\">\n            <h1>Админ-панель</h1>\n            <p>Войдите для управления сайтом</p>\n          </div>\n          <form onSubmit={handleSubmit} className=\"login-form\">\n            <div className=\"form-group\">\n              <label htmlFor=\"username\">Логин</label>\n              <input\n                id=\"username\"\n                type=\"text\"\n                value={username}\n                onChange={(e) => setUsername(e.target.value)}\n                placeholder=\"Введите логин\"\n                autoFocus\n                className={error ? 'error' : ''}\n              />\n            </div>\n            <div className=\"form-group\">\n              <label htmlFor=\"password\">Пароль</label>\n              <input\n                id=\"password\"\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                placeholder=\"Введите пароль\"\n                className={error ? 'error' : ''}\n              />\n            </div>\n            {error && <div className=\"login-error\">{error}</div>}\n            <button type=\"submit\" className=\"login-submit-btn\">\n              Войти\n            </button>\n          </form>\n        </div>\n      </div>\n    );\n  };\n\n  // Компонент формы для добавления/редактирования фотографий\n  const PhotoForm = ({ photo, onSave, onCancel, onAlert, uploadedImagesStore, formKey }) => {\n    // Извлекаем ID фото для отслеживания изменений\n    // Используем useMemo для стабилизации, чтобы избежать лишних вычислений\n    const photoId = useMemo(() => photo?.id, [photo?.id]);\n    \n    // Сохраняем ID фото для отслеживания изменений\n    // Инициализируем ref только один раз при монтировании\n    const photoIdRef = useRef(photoId);\n    const isInitialMountRef = useRef(true);\n    \n    // Используем отдельное состояние для изображения\n    // Инициализируем только один раз при монтировании\n    // Восстанавливаем из хранилища, если изображение было загружено ранее\n    const [image, setImage] = useState(() => {\n      // Сначала проверяем хранилище\n      if (uploadedImagesStore && uploadedImagesStore.has(formKey)) {\n        return uploadedImagesStore.get(formKey);\n      }\n      return photo?.image || '';\n    });\n    const [caption, setCaption] = useState(photo?.caption || '');\n    const [isUploading, setIsUploading] = useState(false);\n    const [isDragging, setIsDragging] = useState(false);\n    const fileInputRef = useRef(null);\n    const userHasUploadedRef = useRef(false); // Флаг: пользователь загрузил изображение\n    const uploadedImageRef = useRef(null); // Сохраняем загруженное изображение\n    const isProcessingFileRef = useRef(false); // Флаг: файл обрабатывается\n\n    // Инициализация только при изменении ID фото (не при каждом рендере)\n    useEffect(() => {\n      const isInitialMount = isInitialMountRef.current;\n      isInitialMountRef.current = false;\n      \n      // Если ID изменился (переключение между редактированием и созданием нового)\n      if (photoIdRef.current !== photoId) {\n        photoIdRef.current = photoId;\n        \n        // Если пользователь уже загрузил изображение для новой формы, НЕ сбрасываем его\n        if (userHasUploadedRef.current && !photoId && uploadedImageRef.current) {\n          // Восстанавливаем загруженное изображение\n          setImage(uploadedImageRef.current);\n          return; // Сохраняем загруженное пользователем изображение\n        }\n        \n        // Если редактируем существующее фото - загружаем его данные\n        if (photoId && photo) {\n          userHasUploadedRef.current = false;\n          uploadedImageRef.current = null;\n          setImage(photo.image || '');\n          setCaption(photo.caption || '');\n        } else {\n          // Новая форма - сбрасываем только если пользователь еще ничего не загрузил\n          if (!userHasUploadedRef.current && !uploadedImageRef.current) {\n            setImage('');\n            setCaption('');\n          } else if (uploadedImageRef.current) {\n            // Восстанавливаем загруженное изображение\n            setImage(uploadedImageRef.current);\n          }\n        }\n      }\n      // НЕ обрабатываем isInitialMount здесь - это может вызвать проблемы при перерендере\n    }, [photoId]); // Зависим ТОЛЬКО от photoId - это стабильное значение\n    \n    // Отдельный эффект для сохранения изображения при первом монтировании\n    useEffect(() => {\n      if (isInitialMountRef.current && !photoId && image && image.startsWith('data:image')) {\n        uploadedImageRef.current = image;\n      }\n    }, []); // Только при монтировании\n    \n    // Постоянная защита от сброса изображения при перерендере\n    // Этот эффект проверяет и восстанавливает изображение из хранилища, если оно было сброшено\n    useEffect(() => {\n      // Только для новой формы (без ID) и только если пользователь загрузил изображение\n      if (!photoId && userHasUploadedRef.current) {\n        // Сначала проверяем хранилище\n        const storedImage = uploadedImagesStore && uploadedImagesStore.has(formKey) \n          ? uploadedImagesStore.get(formKey) \n          : null;\n        \n        if (storedImage) {\n          // Восстанавливаем из хранилища\n          uploadedImageRef.current = storedImage;\n          setImage(storedImage);\n          return;\n        }\n        \n        // Если в хранилище нет, но в ref есть - восстанавливаем из ref\n        if (uploadedImageRef.current) {\n          // Сохраняем в хранилище для будущих перерендеров\n          if (uploadedImagesStore && formKey) {\n            uploadedImagesStore.set(formKey, uploadedImageRef.current);\n          }\n          setImage(uploadedImageRef.current);\n        }\n      }\n    }); // Без зависимостей - срабатывает при каждом рендере для защиты\n\n    const handleChange = (e) => {\n      if (e.target.name === 'caption') {\n        setCaption(e.target.value);\n      }\n    };\n\n    const processFile = async (file) => {\n      if (!file) {\n        return;\n      }\n\n      // Проверяем тип файла\n      if (!file.type.startsWith('image/')) {\n        onAlert('Выберите файл изображения', 'error');\n        return;\n      }\n\n      // Проверяем размер файла (максимум 5MB)\n      if (file.size > 5 * 1024 * 1024) {\n        onAlert('Размер файла не должен превышать 5MB', 'error');\n        return;\n      }\n\n      setIsUploading(true);\n      try {\n        const base64 = await convertFileToBase64(file);\n        \n        // Устанавливаем флаг, что пользователь загрузил изображение\n        userHasUploadedRef.current = true;\n        uploadedImageRef.current = base64; // Сохраняем в ref для защиты от сброса\n        \n        // Сохраняем в глобальное хранилище, чтобы не потерять при перерендере\n        if (uploadedImagesStore && formKey) {\n          uploadedImagesStore.set(formKey, base64);\n        }\n        \n        // Обновляем состояние изображения через функциональное обновление\n        // чтобы гарантировать, что мы используем актуальное состояние\n        setImage(prevImage => {\n          // Если изображение уже установлено и совпадает, не обновляем\n          if (prevImage === base64) {\n            return prevImage;\n          }\n          return base64;\n        });\n        \n        // Откладываем вызов onAlert, чтобы дать React время обновить состояние\n        // Используем задержку, чтобы гарантировать, что состояние обновлено\n        // и компонент успел отрендериться с новым изображением\n        setTimeout(() => {\n          // Финальная проверка перед вызовом onAlert\n          setImage(currentImage => {\n            // Если изображение было сброшено, но в ref оно есть - восстанавливаем\n            if (!currentImage && uploadedImageRef.current) {\n              return uploadedImageRef.current;\n            }\n            return currentImage;\n          });\n          \n          // Вызываем onAlert только после подтверждения, что изображение установлено\n          onAlert('Изображение загружено', 'success');\n        }, 150);\n      } catch (error) {\n        console.error('Ошибка загрузки файла:', error);\n        onAlert('Ошибка загрузки файла', 'error');\n      } finally {\n        setIsUploading(false);\n      }\n    };\n\n    const handleFileChange = async (e) => {\n      // Защита от повторных вызовов\n      if (isProcessingFileRef.current) {\n        return;\n      }\n      \n      const file = e.target.files?.[0];\n      if (!file) {\n        return;\n      }\n      \n      // Устанавливаем флаг обработки\n      isProcessingFileRef.current = true;\n      \n      // Сохраняем ссылку на input для очистки после обработки\n      const input = e.target;\n      \n      try {\n        await processFile(file);\n      } finally {\n        // Сбрасываем флаг обработки\n        isProcessingFileRef.current = false;\n        \n        // Очищаем input после обработки, чтобы можно было выбрать тот же файл снова\n        // Делаем это с небольшой задержкой, чтобы не мешать обработке\n        setTimeout(() => {\n          if (input) {\n            input.value = '';\n          }\n        }, 100);\n      }\n    };\n\n    const handleDragOver = (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      setIsDragging(true);\n    };\n\n    const handleDragLeave = (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      setIsDragging(false);\n    };\n\n    const handleDrop = async (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      setIsDragging(false);\n\n      const file = e.dataTransfer.files?.[0];\n      if (file) {\n        console.log('Файл перетащен (PhotoForm):', file.name, file.type, file.size);\n        await processFile(file);\n      }\n    };\n\n    const handleSubmit = (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      \n      if (!image || !image.trim()) {\n        onAlert('Загрузите изображение', 'error');\n        return;\n      }\n      \n      if (!image.startsWith('data:image')) {\n        onAlert('Ошибка: изображение не загружено правильно', 'error');\n        return;\n      }\n      \n      const photoData = {\n        ...(photo?.id && { id: photo.id }),\n        image: image.trim(),\n        caption: caption.trim() || undefined\n      };\n      \n      onSave(photoData);\n    };\n\n    return (\n      <div className=\"modal-overlay\">\n        <div className=\"modal-content\">\n          <h2>{photo ? 'Редактировать фото' : 'Добавить фото'}</h2>\n          <form onSubmit={handleSubmit} noValidate>\n            <div className=\"form-group\">\n              <label>Загрузить файл *</label>\n              <div \n                className={`file-upload-dropzone ${isDragging ? 'dragging' : ''} ${image ? 'has-image' : ''}`}\n                onDragOver={handleDragOver}\n                onDragLeave={handleDragLeave}\n                onDrop={handleDrop}\n              >\n                <div className=\"file-upload-wrapper\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handleFileChange}\n                    className=\"file-input-hidden\"\n                    disabled={isUploading}\n                  />\n                  <button\n                    type=\"button\"\n                    className=\"file-upload-button\"\n                    onClick={(e) => {\n                      e.preventDefault();\n                      if (fileInputRef.current) {\n                        fileInputRef.current.click();\n                      }\n                    }}\n                    disabled={isUploading}\n                  >\n                    {isUploading ? (\n                      <>\n                        <span className=\"upload-icon\">⏳</span>\n                        <span>Загрузка...</span>\n                      </>\n                    ) : (\n                      <>\n                        <span className=\"upload-icon\">📷</span>\n                        <span>Выбрать изображение</span>\n                      </>\n                    )}\n                  </button>\n                  {image && !isUploading && (\n                    <button\n                      type=\"button\"\n                      className=\"file-remove-button\"\n                      onClick={() => {\n                        userHasUploadedRef.current = false; // Сбрасываем флаг при удалении\n                        setImage('');\n                        if (fileInputRef.current) {\n                          fileInputRef.current.value = '';\n                        }\n                      }}\n                    >\n                      ✕\n                    </button>\n                  )}\n                </div>\n                {!image && (\n                  <p className=\"drag-drop-hint\">\n                    или перетащите изображение сюда\n                  </p>\n                )}\n              </div>\n            </div>\n\n            {image && image.trim() ? (\n              <div className=\"form-group\">\n                <label>Предпросмотр:</label>\n                <div className=\"photo-preview-modern\">\n                  <img\n                    src={image}\n                    alt=\"Предпросмотр\"\n                    onError={(e) => {\n                      e.target.src = 'https://via.placeholder.com/300x200/8B7355/FFFFFF?text=Тбилиси';\n                    }}\n                  />\n                  <div className=\"photo-preview-overlay\">\n                    <span className=\"preview-badge\">Предпросмотр</span>\n                  </div>\n                </div>\n              </div>\n            ) : (\n              <div className=\"form-group\">\n                <p style={{ color: '#999', fontStyle: 'italic', fontSize: '0.9rem' }}>\n                  Предпросмотр появится после выбора файла\n                </p>\n              </div>\n            )}\n\n            <div className=\"form-group\">\n              <label>Подпись (необязательно)</label>\n              <input\n                type=\"text\"\n                name=\"caption\"\n                value={caption}\n                onChange={handleChange}\n                placeholder=\"Подпись к фотографии\"\n              />\n            </div>\n\n            <div className=\"form-actions\">\n              <button type=\"submit\" className=\"save-btn\">\n                {photo ? 'Обновить' : 'Добавить'}\n              </button>\n              <button type=\"button\" className=\"cancel-btn\" onClick={onCancel}>\n                Отмена\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    );\n  };\n\n  const MenuItemForm = ({ item, onSave, onCancel, onAlert, menuImagesStore, formKey }) => {\n    const defaultCategory = categories.length > 0 ? categories[0].key : 'cold';\n    \n    // Инициализируем refs ДО useState, чтобы можно было использовать их в инициализаторе\n    const fileInputRef = useRef(null);\n    const isProcessingFileRef = useRef(false); // Флаг: файл обрабатывается\n    const uploadedImageRef = useRef(null); // Сохраняем загруженное изображение\n    const userHasUploadedRef = useRef(false); // Флаг: пользователь загрузил изображение\n    \n    // Ключ для сохранения данных формы в localStorage\n    const formDataStorageKey = `menu-item-form-${formKey}`;\n    \n    const [formData, setFormData] = useState(() => {\n      // Если редактируем существующий элемент - используем его данные\n      if (item) {\n        const baseData = {\n          ...item,\n          price: item.price.toString().replace(' ₽', '')\n        };\n        if (item.image) {\n          baseData.image = item.image;\n          uploadedImageRef.current = item.image;\n        }\n        return baseData;\n      }\n      \n      // Для новой формы - пытаемся восстановить из localStorage\n      const savedFormData = localStorage.getItem(formDataStorageKey);\n      if (savedFormData) {\n        try {\n          const parsed = JSON.parse(savedFormData);\n          const baseData = {\n            name: parsed.name || '',\n            price: parsed.price || '',\n            weight: parsed.weight || '',\n            description: parsed.description || '',\n            image: parsed.image || '',\n            category: parsed.category || defaultCategory\n          };\n          \n          // Восстанавливаем изображение из хранилища, если есть\n          if (menuImagesStore && menuImagesStore.has(formKey)) {\n            baseData.image = menuImagesStore.get(formKey);\n            uploadedImageRef.current = baseData.image;\n            userHasUploadedRef.current = true;\n          } else if (parsed.image) {\n            baseData.image = parsed.image;\n            uploadedImageRef.current = parsed.image;\n            userHasUploadedRef.current = true;\n          }\n          \n          console.log('📝 MenuItemForm: Восстановлены данные из localStorage:', baseData);\n          return baseData;\n        } catch (e) {\n          console.error('Ошибка восстановления данных формы из localStorage:', e);\n        }\n      }\n      \n      // Если нет сохраненных данных - создаем пустую форму\n      const baseData = {\n        name: '',\n        price: '',\n        weight: '',\n        description: '',\n        image: '',\n        category: defaultCategory\n      };\n      \n      // Восстанавливаем изображение из хранилища, если есть\n      if (menuImagesStore && menuImagesStore.has(formKey)) {\n        baseData.image = menuImagesStore.get(formKey);\n        uploadedImageRef.current = baseData.image;\n        userHasUploadedRef.current = true;\n      }\n      \n      return baseData;\n    });\n\n    const [errors, setErrors] = useState({});\n    const [isUploading, setIsUploading] = useState(false);\n\n    // Постоянная защита от сброса изображения при перерендере\n    // Этот эффект проверяет и восстанавливает изображение из хранилища, если оно было сброшено\n    // ВАЖНО: используем зависимости только для item и formKey, НЕ для formData.image\n    // чтобы не срабатывать при каждом изменении изображения\n    useEffect(() => {\n      // Если редактируем существующий элемент - восстанавливаем его изображение\n      if (item && item.image && !formData.image) {\n        setFormData(prev => {\n          // ВАЖНО: сохраняем все предыдущие поля, обновляем только изображение\n          if (prev.image !== item.image) {\n            uploadedImageRef.current = item.image;\n            return { ...prev, image: item.image };\n          }\n          return prev;\n        });\n        return;\n      }\n      \n      // Только если пользователь загрузил изображение (для новых элементов)\n      // И только если изображение было потеряно (formData.image пустое)\n      if (userHasUploadedRef.current && !formData.image) {\n        // Сначала проверяем хранилище\n        const storedImage = menuImagesStore && menuImagesStore.has(formKey) \n          ? menuImagesStore.get(formKey) \n          : null;\n        \n        if (storedImage) {\n          // Восстанавливаем из хранилища\n          uploadedImageRef.current = storedImage;\n          setFormData(prev => {\n            // ВАЖНО: сохраняем все предыдущие поля, обновляем только изображение\n            return { ...prev, image: storedImage };\n          });\n          return;\n        }\n        \n        // Если в хранилище нет, но в ref есть - восстанавливаем из ref\n        if (uploadedImageRef.current) {\n          // Сохраняем в хранилище для будущих перерендеров\n          if (menuImagesStore && formKey) {\n            menuImagesStore.set(formKey, uploadedImageRef.current);\n          }\n          setFormData(prev => {\n            // ВАЖНО: сохраняем все предыдущие поля, обновляем только изображение\n            return { ...prev, image: uploadedImageRef.current };\n          });\n        }\n      }\n    }, [item?.image, formKey]); // НЕ включаем formData.image, чтобы не срабатывать при загрузке\n\n    const validateField = (name, value) => {\n      const newErrors = { ...errors };\n      \n      switch (name) {\n        case 'name':\n          if (!value.trim()) newErrors.name = 'Название обязательно';\n          else delete newErrors.name;\n          break;\n        case 'price':\n          if (!value || isNaN(parseFloat(value)) || parseFloat(value) <= 0) \n            newErrors.price = 'Введите корректную цену';\n          else delete newErrors.price;\n          break;\n        case 'weight':\n          if (!value.trim()) newErrors.weight = 'Вес/объем обязателен';\n          else delete newErrors.weight;\n          break;\n        case 'description':\n          if (!value.trim()) newErrors.description = 'Описание обязательно';\n          else delete newErrors.description;\n          break;\n        case 'image':\n          if (!value.trim()) newErrors.image = 'Загрузите изображение';\n          else if (!value.startsWith('data:image')) {\n            newErrors.image = 'Загрузите файл изображения';\n          }\n          else delete newErrors.image;\n          break;\n        default:\n          break;\n      }\n      \n      setErrors(newErrors);\n    };\n\n    const handleChange = (e) => {\n      const { name, value } = e.target;\n      setFormData(prev => {\n        const updated = {\n          ...prev,\n          [name]: value\n        };\n        validateField(name, value);\n        return updated;\n      });\n    };\n\n    const handleFileChange = async (e) => {\n      // Защита от повторных вызовов\n      if (isProcessingFileRef.current) {\n        return;\n      }\n      \n      const file = e.target.files?.[0];\n      if (!file) {\n        return;\n      }\n      \n      // Устанавливаем флаг обработки\n      isProcessingFileRef.current = true;\n      \n      // Сохраняем ссылку на input для очистки после обработки\n      const input = e.target;\n\n      // Проверяем тип файла\n      if (!file.type.startsWith('image/')) {\n        onAlert('Выберите файл изображения', 'error');\n        isProcessingFileRef.current = false;\n        return;\n      }\n\n      // Проверяем размер файла (максимум 5MB)\n      if (file.size > 5 * 1024 * 1024) {\n        onAlert('Размер файла не должен превышать 5MB', 'error');\n        isProcessingFileRef.current = false;\n        return;\n      }\n\n      setIsUploading(true);\n      try {\n        const base64 = await convertFileToBase64(file);\n        \n        // Устанавливаем флаг, что пользователь загрузил изображение\n        userHasUploadedRef.current = true;\n        uploadedImageRef.current = base64; // Сохраняем в ref для защиты от сброса\n        \n        // Сохраняем в глобальное хранилище, чтобы не потерять при перерендере\n        if (menuImagesStore && formKey) {\n          menuImagesStore.set(formKey, base64);\n        }\n        \n        // Используем функциональное обновление для гарантии актуального состояния\n        // ВАЖНО: сохраняем все предыдущие поля формы явно\n        setFormData(prev => {\n          console.log('🖼️ handleFileChange: Предыдущие данные формы:', {\n            name: prev.name,\n            price: prev.price,\n            weight: prev.weight,\n            description: prev.description,\n            category: prev.category,\n            image: prev.image ? 'есть' : 'нет'\n          });\n          \n          const updated = {\n            name: prev.name || '', // Явно сохраняем каждое поле\n            price: prev.price || '',\n            weight: prev.weight || '',\n            description: prev.description || '',\n            category: prev.category || defaultCategory,\n            image: base64 // Обновляем только изображение\n          };\n          \n          console.log('🖼️ handleFileChange: Обновленные данные формы:', {\n            name: updated.name,\n            price: updated.price,\n            weight: updated.weight,\n            description: updated.description,\n            category: updated.category,\n            image: 'загружено'\n          });\n          \n          // Валидацию вызываем после обновления состояния\n          setTimeout(() => validateField('image', base64), 0);\n          return updated;\n        });\n        \n        // Откладываем вызов onAlert, чтобы дать React время обновить состояние\n        setTimeout(() => {\n          // Финальная проверка перед вызовом onAlert\n          // ВАЖНО: сохраняем все поля формы при проверке\n          setFormData(currentData => {\n            console.log('🖼️ handleFileChange (setTimeout): Проверка данных формы:', {\n              name: currentData.name,\n              price: currentData.price,\n              weight: currentData.weight,\n              description: currentData.description,\n              category: currentData.category,\n              image: currentData.image ? 'есть' : 'нет'\n            });\n            \n            // Если изображение было сброшено, но в ref оно есть - восстанавливаем\n            if (!currentData.image && uploadedImageRef.current) {\n              console.log('🖼️ handleFileChange: Восстанавливаем изображение из ref');\n              return {\n                name: currentData.name || '', // Явно сохраняем все поля\n                price: currentData.price || '',\n                weight: currentData.weight || '',\n                description: currentData.description || '',\n                category: currentData.category || defaultCategory,\n                image: uploadedImageRef.current\n              };\n            }\n            // Если все в порядке, просто возвращаем текущие данные без изменений\n            return currentData;\n          });\n          \n          // Вызываем onAlert только после подтверждения, что изображение установлено\n          onAlert('Изображение загружено', 'success');\n        }, 150);\n      } catch (error) {\n        console.error('Ошибка загрузки файла (MenuItemForm):', error);\n        onAlert('Ошибка загрузки файла', 'error');\n      } finally {\n        setIsUploading(false);\n        // Сбрасываем флаг обработки\n        isProcessingFileRef.current = false;\n        \n        // Очищаем input после обработки, чтобы можно было выбрать тот же файл снова\n        setTimeout(() => {\n          if (input) {\n            input.value = '';\n          }\n        }, 100);\n      }\n    };\n\n    const handleSubmit = (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      \n      // Валидация всех полей перед отправкой\n      const newErrors = {};\n      Object.keys(formData).forEach(key => {\n        if (key !== 'category') {\n          const fieldValue = formData[key];\n          if (key === 'image') {\n            if (!fieldValue || !fieldValue.trim()) {\n              newErrors.image = 'Загрузите изображение';\n            } else if (!fieldValue.startsWith('data:image')) {\n              newErrors.image = 'Загрузите файл изображения';\n            }\n          } else if (key === 'name' && !fieldValue?.trim()) {\n            newErrors.name = 'Название обязательно';\n          } else if (key === 'price' && (!fieldValue || isNaN(parseFloat(fieldValue)) || parseFloat(fieldValue) <= 0)) {\n            newErrors.price = 'Введите корректную цену';\n          } else if (key === 'weight' && !fieldValue?.trim()) {\n            newErrors.weight = 'Вес/объем обязателен';\n          } else if (key === 'description' && !fieldValue?.trim()) {\n            newErrors.description = 'Описание обязательно';\n          }\n        }\n      });\n      \n      setErrors(newErrors);\n\n      if (Object.keys(newErrors).length === 0 && formData.image && formData.image.startsWith('data:image')) {\n        onSave(formData);\n      } else {\n        if (!formData.image || !formData.image.startsWith('data:image')) {\n          showAlert('Загрузите изображение', 'error');\n        } else {\n          showAlert('Исправьте ошибки в форме', 'error');\n        }\n      }\n    };\n\n    const isFormValid = () => {\n      return formData.name && \n             formData.price && \n             formData.weight && \n             formData.description && \n             formData.image &&\n             Object.keys(errors).length === 0;\n    };\n\n    return (\n      <div className=\"form-modal\">\n        <div className=\"form-content\">\n          <h3>{item ? 'Редактировать блюдо' : 'Добавить новое блюдо'}</h3>\n          <form onSubmit={handleSubmit} noValidate>\n            <div className=\"form-group\">\n              <label>Название *</label>\n              <input\n                type=\"text\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                className={errors.name ? 'error' : ''}\n                placeholder=\"Введите название блюда\"\n                required\n              />\n              {errors.name && <span className=\"error-text\">{errors.name}</span>}\n            </div>\n\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>Цена (₽) *</label>\n                <input\n                  type=\"number\"\n                  name=\"price\"\n                  value={formData.price}\n                  onChange={handleChange}\n                  className={errors.price ? 'error' : ''}\n                  placeholder=\"0\"\n                  min=\"1\"\n                  required\n                />\n                {errors.price && <span className=\"error-text\">{errors.price}</span>}\n              </div>\n\n              <div className=\"form-group\">\n                <label>Вес/Объем *</label>\n                <input\n                  type=\"text\"\n                  name=\"weight\"\n                  value={formData.weight}\n                  onChange={handleChange}\n                  className={errors.weight ? 'error' : ''}\n                  placeholder=\"150 г или 500 мл\"\n                  required\n                />\n                {errors.weight && <span className=\"error-text\">{errors.weight}</span>}\n              </div>\n\n              <div className=\"form-group\">\n                <label>Категория *</label>\n                <select\n                  name=\"category\"\n                  value={formData.category}\n                  onChange={handleChange}\n                >\n                  {categories.map(cat => (\n                    <option key={cat.id} value={cat.key}>{cat.name}</option>\n                  ))}\n                </select>\n              </div>\n            </div>\n\n            <div className=\"form-group\">\n              <label>Описание *</label>\n              <textarea\n                name=\"description\"\n                value={formData.description}\n                onChange={handleChange}\n                className={errors.description ? 'error' : ''}\n                rows=\"3\"\n                placeholder=\"Опишите блюдо\"\n                required\n              />\n              {errors.description && <span className=\"error-text\">{errors.description}</span>}\n            </div>\n\n            <div className=\"form-group\">\n              <label>Загрузить файл *</label>\n              <div className=\"file-upload-wrapper\">\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  accept=\"image/*\"\n                  onChange={handleFileChange}\n                  className=\"file-input-hidden\"\n                  disabled={isUploading}\n                />\n                <button\n                  type=\"button\"\n                  className=\"file-upload-button\"\n                  onClick={(e) => {\n                    e.preventDefault();\n                    if (fileInputRef.current) {\n                      console.log('Клик по кнопке (MenuItemForm), открываем файловый диалог');\n                      fileInputRef.current.click();\n                    } else {\n                      console.error('fileInputRef.current is null (MenuItemForm)');\n                    }\n                  }}\n                  disabled={isUploading}\n                >\n                  {isUploading ? (\n                    <>\n                      <span className=\"upload-icon\">⏳</span>\n                      <span>Загрузка...</span>\n                    </>\n                  ) : (\n                    <>\n                      <span className=\"upload-icon\">📷</span>\n                      <span>Выбрать изображение</span>\n                    </>\n                  )}\n                </button>\n                {formData.image && !isUploading && (\n                  <button\n                    type=\"button\"\n                    className=\"file-remove-button\"\n                    onClick={() => {\n                      userHasUploadedRef.current = false;\n                      uploadedImageRef.current = null;\n                      // Очищаем из хранилища\n                      if (menuImagesStore && formKey) {\n                        menuImagesStore.delete(formKey);\n                      }\n                      setFormData({ ...formData, image: '' });\n                      if (fileInputRef.current) {\n                        fileInputRef.current.value = '';\n                      }\n                      validateField('image', '');\n                    }}\n                  >\n                    ✕\n                  </button>\n                )}\n              </div>\n              {errors.image && <span className=\"error-text\">{errors.image}</span>}\n            </div>\n\n            {formData.image && formData.image.trim() && (\n              <div className=\"form-group\">\n                <label>Предпросмотр:</label>\n                <div className=\"photo-preview-modern\">\n                  <img\n                    key={formData.image.substring(0, 50)}\n                    src={formData.image}\n                    alt=\"Предпросмотр\"\n                    onLoad={() => console.log('Изображение загружено в предпросмотр (MenuItemForm)')}\n                    onError={(e) => {\n                      console.error('Ошибка загрузки изображения в предпросмотр (MenuItemForm)');\n                      e.target.src = 'https://via.placeholder.com/300x200/8B7355/FFFFFF?text=Тбилиси';\n                    }}\n                  />\n                  <div className=\"photo-preview-overlay\">\n                    <span className=\"preview-badge\">Предпросмотр</span>\n                  </div>\n                </div>\n              </div>\n            )}\n            {!formData.image && (\n              <div className=\"form-group\">\n                <p style={{ color: '#999', fontStyle: 'italic', fontSize: '0.9rem' }}>\n                  Предпросмотр появится после выбора файла\n                </p>\n              </div>\n            )}\n\n            <div className=\"form-actions\">\n              <button \n                type=\"submit\" \n                className=\"save-btn\"\n                disabled={!isFormValid()}\n              >\n                {item ? 'Обновить' : 'Добавить'}\n              </button>\n              <button type=\"button\" className=\"cancel-btn\" onClick={onCancel}>\n                Отмена\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    );\n  };\n\n  const formatPrice = (price) => {\n    if (typeof price === 'string' && price.includes('₽')) {\n      return price;\n    }\n    const priceNum = parseInt(price);\n    return isNaN(priceNum) ? '0 ₽' : `${priceNum} ₽`;\n  };\n\n  const handleImageError = (e) => {\n    e.target.src = 'https://via.placeholder.com/300x200/8B7355/FFFFFF?text=Тбилиси';\n  };\n\n  // Стабилизируем photo prop для PhotoForm, чтобы избежать пересоздания компонента\n  const stablePhotoForForm = useMemo(() => {\n    if (editingPhoto === null) return null;\n    return editingPhoto.id ? editingPhoto : null;\n  }, [editingPhoto?.id]);\n\n  // Если не авторизован, показываем форму входа\n  if (!isAuthenticated) {\n    return <LoginForm onLogin={handleLogin} />;\n  }\n\n  return (\n    <div className=\"admin-page\">\n      <div className=\"admin-container\">\n        {/* Кнопка выхода */}\n        <div className=\"admin-header\">\n          <h1>Админ-панель \"Тбилиси\"</h1>\n          <button onClick={handleLogout} className=\"logout-btn\">\n            Выйти\n          </button>\n        </div>\n        \n        {/* Уведомления */}\n        {showNotification && (\n          <div className={`admin-notification ${notificationType}`}>\n            {notificationMessage}\n            <button onClick={() => setShowNotification(false)}>×</button>\n          </div>\n        )}\n\n        {/* Переключатель вкладок */}\n        <div className=\"admin-tabs\">\n          <button \n            className={`tab-button ${activeTab === 'reservations' ? 'active' : ''}`}\n            onClick={() => handleTabChange('reservations')}\n          >\n            Заявки ({reservations.length})\n          </button>\n          <button \n            className={`tab-button ${activeTab === 'menu' ? 'active' : ''}`}\n            onClick={() => handleTabChange('menu')}\n          >\n            Меню ({menuItems.length})\n          </button>\n          <button \n            className={`tab-button ${activeTab === 'categories' ? 'active' : ''}`}\n            onClick={() => handleTabChange('categories')}\n          >\n            Категории ({categories.length})\n          </button>\n          <button \n            className={`tab-button ${activeTab === 'themes' ? 'active' : ''}`}\n            onClick={() => handleTabChange('themes')}\n          >\n            Темы ({Object.keys(themes).length + 1})\n          </button>\n          <button \n            className={`tab-button ${activeTab === 'photos' ? 'active' : ''}`}\n            onClick={() => handleTabChange('photos')}\n          >\n            Фото ({photos.length})\n          </button>\n        </div>\n\n        {/* Содержимое вкладок */}\n        <div className=\"tab-content\">\n          {activeTab === 'reservations' && (\n            <div className=\"reservations-tab\">\n              <h2>Заявки на бронирование</h2>\n              \n              {reservations.length === 0 ? (\n                <p className=\"no-data\">Нет заявок на бронь</p>\n              ) : (\n                <div className=\"reservations-list\">\n                  {reservations.map(reservation => (\n                    <div key={reservation.id} className=\"reservation-card\">\n                      <div className=\"reservation-header\">\n                        <h3>{reservation.name}</h3>\n                        <span className=\"reservation-date\">\n                          {new Date(reservation.createdAt).toLocaleDateString('ru-RU')}\n                        </span>\n                      </div>\n                      <div className=\"reservation-details\">\n                        <p><strong>Телефон:</strong> {reservation.phone}</p>\n                        <p><strong>Дата:</strong> {reservation.date} в {reservation.time}</p>\n                        <p><strong>Гостей:</strong> {reservation.guests}</p>\n                        {reservation.comments && (\n                          <p><strong>Комментарий:</strong> {reservation.comments}</p>\n                        )}\n                      </div>\n                      <button \n                        onClick={() => {\n                          if (window.confirm('Вы уверены, что хотите удалить эту заявку?')) {\n                            deleteReservation(reservation.id);\n                          }\n                        }}\n                        className=\"delete-btn\"\n                      >\n                        Удалить\n                      </button>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n\n          {activeTab === 'menu' && (\n            <div className=\"menu-tab\">\n              <div className=\"menu-header\">\n                <h2>Управление меню</h2>\n                <button \n                  onClick={() => setEditingItem({})}\n                  className=\"add-btn\"\n                >\n                  + Добавить блюдо\n                </button>\n              </div>\n\n              {menuItems.length === 0 ? (\n                <p className=\"no-data\">Меню пусто. Добавьте новые блюда через форму выше.</p>\n              ) : (\n                <div className=\"menu-items-grid\">\n                  {menuItems.map(item => (\n                    <div key={item.id} className=\"menu-item-card\">\n                      <div className=\"item-image\">\n                        <img \n                          src={item.image} \n                          alt={item.name}\n                          onError={handleImageError}\n                        />\n                      </div>\n                      <div className=\"item-content\">\n                        <h4>{item.name}</h4>\n                        <p className=\"item-price\">{formatPrice(item.price)} · {item.weight}</p>\n                        <p className=\"item-description\">{item.description}</p>\n                        <p className=\"item-category\">\n                          {categories.find(cat => cat.key === item.category)?.name || item.category}\n                        </p>\n                      </div>\n                      <div className=\"item-actions\">\n                        <button \n                          onClick={() => startEditing(item)}\n                          className=\"edit-btn\"\n                        >\n                          Редактировать\n                        </button>\n                        <button \n                          onClick={() => {\n                            if (window.confirm('Вы уверены, что хотите удалить это блюдо?')) {\n                              deleteMenuItem(item.id);\n                            }\n                          }}\n                          className=\"delete-btn\"\n                        >\n                          Удалить\n                        </button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n\n          {activeTab === 'categories' && (\n            <div className=\"categories-tab\">\n              <div className=\"categories-header\">\n                <h2>Управление категориями</h2>\n                <button \n                  onClick={addCategory}\n                  className=\"add-btn\"\n                >\n                  + Добавить категорию\n                </button>\n              </div>\n\n              {categories.length === 0 ? (\n                <p className=\"no-data\">Категорий нет. Добавьте новую категорию.</p>\n              ) : (\n                <div className=\"categories-list\">\n                  {categories.map((category, index) => (\n                    <div key={category.id} className=\"category-card\">\n                      {editingCategory && editingCategory.id === category.id ? (\n                        <div className=\"category-edit-form\">\n                          <input\n                            type=\"text\"\n                            value={editingCategory.name}\n                            onChange={(e) => setEditingCategory({ ...editingCategory, name: e.target.value })}\n                            className=\"category-name-input\"\n                            placeholder=\"Название категории\"\n                            autoFocus\n                          />\n                          <div className=\"category-edit-actions\">\n                            <button \n                              onClick={() => updateCategory(editingCategory)}\n                              className=\"save-btn\"\n                            >\n                              Сохранить\n                            </button>\n                            <button \n                              onClick={() => setEditingCategory(null)}\n                              className=\"cancel-btn\"\n                            >\n                              Отмена\n                            </button>\n                          </div>\n                        </div>\n                      ) : (\n                        <>\n                          <div className=\"category-info\">\n                            <h4>{category.name}</h4>\n                            <p className=\"category-key\">Ключ: {category.key}</p>\n                            <p className=\"category-order\">Порядок: {category.order}</p>\n                            <p className=\"category-items-count\">\n                              Блюд в категории: {menuItems.filter(item => item.category === category.key).length}\n                            </p>\n                          </div>\n                          <div className=\"category-actions\">\n                            <div className=\"category-order-controls\">\n                              <button\n                                onClick={() => moveCategory(category.id, 'up')}\n                                className=\"move-btn\"\n                                disabled={index === 0}\n                                title=\"Переместить вверх\"\n                              >\n                                ↑\n                              </button>\n                              <button\n                                onClick={() => moveCategory(category.id, 'down')}\n                                className=\"move-btn\"\n                                disabled={index === categories.length - 1}\n                                title=\"Переместить вниз\"\n                              >\n                                ↓\n                              </button>\n                            </div>\n                            <button \n                              onClick={() => setEditingCategory({ ...category })}\n                              className=\"edit-btn\"\n                            >\n                              Редактировать\n                            </button>\n                            <button \n                              onClick={() => {\n                                if (window.confirm('Вы уверены, что хотите удалить эту категорию?')) {\n                                  deleteCategory(category.id);\n                                }\n                              }}\n                              className=\"delete-btn\"\n                            >\n                              Удалить\n                            </button>\n                          </div>\n                        </>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n\n          {activeTab === 'themes' && (\n            <div className=\"themes-tab\">\n              <div className=\"themes-header\">\n                <h2>Управление темами</h2>\n                <button \n                  onClick={addTheme}\n                  className=\"add-btn\"\n                >\n                  + Добавить тему\n                </button>\n              </div>\n\n              <div className=\"themes-list\">\n                {/* Тема по умолчанию */}\n                <div className={`theme-card ${currentTheme === 'default' ? 'active' : ''}`}>\n                  <div className=\"theme-preview\">\n                    <div className=\"theme-preview-colors\">\n                      <div className=\"preview-color\" style={{ background: '#8B7355' }}></div>\n                      <div className=\"preview-color\" style={{ background: '#A8D8EA' }}></div>\n                      <div className=\"preview-color\" style={{ background: '#D4B896' }}></div>\n                    </div>\n                  </div>\n                  <div className=\"theme-info\">\n                    <h4>По умолчанию</h4>\n                    <p className=\"theme-description\">Базовая земляная тема</p>\n                  </div>\n                  <div className=\"theme-actions\">\n                    <button \n                      onClick={() => applyTheme('default')}\n                      className={`apply-btn ${currentTheme === 'default' ? 'active' : ''}`}\n                    >\n                      {currentTheme === 'default' ? '✓ Применена' : 'Применить'}\n                    </button>\n                  </div>\n                </div>\n\n                {/* Базовые темы */}\n                {Object.values(defaultThemes).map(theme => (\n                  <div key={theme.id} className={`theme-card ${currentTheme === theme.id ? 'active' : ''}`}>\n                    <div className=\"theme-preview\">\n                      <div className=\"theme-preview-colors\">\n                        <div className=\"preview-color\" style={{ background: theme.primaryColor }}></div>\n                        <div className=\"preview-color\" style={{ background: theme.secondaryColor }}></div>\n                        <div className=\"preview-color\" style={{ background: theme.accentColor }}></div>\n                      </div>\n                    </div>\n                    <div className=\"theme-info\">\n                      <h4>{theme.name}</h4>\n                      <p className=\"theme-description\">Базовая тема</p>\n                    </div>\n                    <div className=\"theme-actions\">\n                      <button \n                        onClick={() => applyTheme(theme.id)}\n                        className={`apply-btn ${currentTheme === theme.id ? 'active' : ''}`}\n                      >\n                        {currentTheme === theme.id ? '✓ Применена' : 'Применить'}\n                      </button>\n                    </div>\n                  </div>\n                ))}\n\n                {/* Пользовательские темы */}\n                {Object.values(themes).filter(theme => !defaultThemes[theme.id]).map(theme => (\n                  <div key={theme.id} className={`theme-card ${currentTheme === theme.id ? 'active' : ''}`}>\n                    {editingTheme && editingTheme.id === theme.id ? (\n                      <ThemeEditForm\n                        theme={editingTheme}\n                        onSave={updateTheme}\n                        onCancel={() => setEditingTheme(null)}\n                      />\n                    ) : (\n                      <>\n                        <div className=\"theme-preview\">\n                          <div className=\"theme-preview-colors\">\n                            <div className=\"preview-color\" style={{ background: theme.primaryColor }}></div>\n                            <div className=\"preview-color\" style={{ background: theme.secondaryColor }}></div>\n                            <div className=\"preview-color\" style={{ background: theme.accentColor }}></div>\n                          </div>\n                        </div>\n                        <div className=\"theme-info\">\n                          <h4>{theme.name}</h4>\n                          <p className=\"theme-description\">Пользовательская тема</p>\n                        </div>\n                        <div className=\"theme-actions\">\n                          <button \n                            onClick={() => applyTheme(theme.id)}\n                            className={`apply-btn ${currentTheme === theme.id ? 'active' : ''}`}\n                          >\n                            {currentTheme === theme.id ? '✓ Применена' : 'Применить'}\n                          </button>\n                          <button \n                            onClick={() => setEditingTheme({ ...theme })}\n                            className=\"edit-btn\"\n                          >\n                            Редактировать\n                          </button>\n                          {!defaultThemes[theme.id] && (\n                            <button \n                              onClick={() => {\n                                if (window.confirm('Вы уверены, что хотите удалить эту тему?')) {\n                                  deleteTheme(theme.id);\n                                }\n                              }}\n                              className=\"delete-btn\"\n                            >\n                              Удалить\n                            </button>\n                          )}\n                        </div>\n                      </>\n                    )}\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {activeTab === 'photos' && (\n            <div className=\"photos-tab\">\n              <div className=\"photos-header\">\n                <h2>Управление фотографиями</h2>\n                <button\n                  onClick={() => {\n                    // Используем стабильный объект для новой формы\n                    setEditingPhoto(newPhotoObjectRef.current);\n                  }}\n                  className=\"add-btn\"\n                >\n                  + Добавить фото\n                </button>\n              </div>\n\n              {photos.length === 0 ? (\n                <p className=\"no-data\">Фотографий нет. Добавьте новую фотографию.</p>\n              ) : (\n                <div className=\"photos-grid\">\n                  {photos.map(photo => (\n                    <div key={photo.id} className=\"photo-card\">\n                      <div className=\"photo-image\">\n                        <img\n                          src={photo.image}\n                          alt={photo.caption || 'Фото'}\n                          onError={(e) => {\n                            e.target.src = 'https://via.placeholder.com/300x200/8B7355/FFFFFF?text=Тбилиси';\n                          }}\n                        />\n                      </div>\n                      <div className=\"photo-info\">\n                        {photo.caption && (\n                          <p className=\"photo-caption\">{photo.caption}</p>\n                        )}\n                        {!photo.caption && (\n                          <p className=\"photo-caption-empty\">Без подписи</p>\n                        )}\n                      </div>\n                      <div className=\"photo-actions\">\n                        <button\n                          onClick={() => setEditingPhoto({ ...photo })}\n                          className=\"edit-btn\"\n                        >\n                          Редактировать\n                        </button>\n                        <button\n                          onClick={() => {\n                            if (window.confirm('Вы уверены, что хотите удалить это фото?')) {\n                              deletePhoto(photo.id);\n                            }\n                          }}\n                          className=\"delete-btn\"\n                        >\n                          Удалить\n                        </button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n\n        {/* Модальное окно для редактирования/добавления */}\n        {editingItem !== null && (\n          <MenuItemForm\n            key={editingItem?.id || newMenuItemKeyRef.current} // Стабильный key\n            item={editingItem.id ? editingItem : null}\n            onSave={saveMenuItem}\n            onCancel={cancelEditing}\n            onAlert={showAlert}\n            menuImagesStore={menuImagesStore.current} // Передаем хранилище для сохранения состояния\n            formKey={editingItem?.id || newMenuItemKeyRef.current} // Уникальный ключ формы\n          />\n        )}\n\n        {/* Модальное окно для редактирования/добавления фотографий */}\n        {editingPhoto !== null && (\n          <PhotoForm\n            key={editingPhoto?.id || newPhotoKeyRef.current} // Стабильный key\n            photo={stablePhotoForForm}\n            onSave={savePhoto}\n            onCancel={cancelPhotoEditing}\n            onAlert={showAlert}\n            uploadedImagesStore={uploadedImagesStore.current} // Передаем хранилище для сохранения состояния\n            formKey={editingPhoto?.id || newPhotoKeyRef.current} // Уникальный ключ формы\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Admin;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}