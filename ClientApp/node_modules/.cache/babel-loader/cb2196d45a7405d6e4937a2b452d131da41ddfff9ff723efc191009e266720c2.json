{"ast":null,"code":"import _objectSpread from\"C:/restaurant-website (2)/restaurant-website/Backend/ClientApp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef,useMemo,useCallback}from'react';import'./Admin.css';import{autoSaveReservations,autoSaveMenu,autoSavePhotos,loadTheme,loadMenu,loadReservations,loadCategories,loadPhotos,saveTheme,saveCategories}from'../utils/fileStorage';import{defaultMenu}from'../data/defaultMenu';// –ë–∞–∑–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const defaultCategories=[{id:1,key:'cold',name:'–•–æ–ª–æ–¥–Ω—ã–µ –∑–∞–∫—É—Å–∫–∏',order:1},{id:2,key:'salads',name:'–°–∞–ª–∞—Ç—ã',order:2},{id:3,key:'hot',name:'–ì–æ—Ä—è—á–∏–µ –±–ª—é–¥–∞',order:3},{id:4,key:'drinks',name:'–ù–∞–ø–∏—Ç–∫–∏',order:4}];// –ë–∞–∑–æ–≤—ã–µ —Ç–µ–º—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\nconst defaultThemes={elegant:{id:'elegant',name:'–≠–ª–µ–≥–∞–Ω—Ç–Ω–∞—è —Å–∏–Ω—è—è',primaryColor:'#2C3E50',primaryLight:'#34495E',primaryDark:'#1C2833',secondaryColor:'#3498DB',secondaryLight:'#5DADE2',secondaryDark:'#2980B9',accentColor:'#E74C3C',backgroundColor:'#ECF0F1',textColor:'#2C3E50',textLight:'#566573'}};const Admin=()=>{// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ ID\nconst generateUniqueId=existingItems=>{let newId;let attempts=0;const maxAttempts=100;do{// –ò—Å–ø–æ–ª—å–∑—É–µ–º timestamp + —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏\nnewId=Date.now()+Math.floor(Math.random()*1000);attempts++;// –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ç–∞–∫–æ–≥–æ ID –Ω–µ—Ç –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–∞—Ö\nconst exists=existingItems.some(item=>item.id===newId);if(!exists){return newId;}}while(attempts<maxAttempts);// –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞ 100 –ø–æ–ø—ã—Ç–æ–∫, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Å—Ç–æ timestamp\nconsole.warn('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞ 100 –ø–æ–ø—ã—Ç–æ–∫, –∏—Å–ø–æ–ª—å–∑—É–µ–º timestamp');return Date.now();};// –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∏–∑ localStorage –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ\nconst[isAuthenticated,setIsAuthenticated]=useState(()=>{return localStorage.getItem('admin-authenticated')==='true';});const[activeTab,setActiveTab]=useState('reservations');const[reservations,setReservations]=useState([]);const[menuItems,setMenuItems]=useState([]);const[categories,setCategories]=useState([]);const[themes,setThemes]=useState({});const[currentTheme,setCurrentTheme]=useState('default');const[photos,setPhotos]=useState([]);const[editingItem,setEditingItem]=useState(null);const[editingCategory,setEditingCategory]=useState(null);const[editingTheme,setEditingTheme]=useState(null);const[editingPhoto,setEditingPhoto]=useState(null);const newPhotoKeyRef=useRef(\"new-photo-\".concat(Date.now()));// –°—Ç–∞–±–∏–ª—å–Ω—ã–π key –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã\nconst newPhotoObjectRef=useRef({});// –°—Ç–∞–±–∏–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã\n// –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–≤–Ω–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, —á—Ç–æ–±—ã –Ω–µ —Ç–µ—Ä—è—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–µ)\nconst uploadedImagesStore=useRef(new Map());// key -> base64 image\nconst newMenuItemKeyRef=useRef(\"new-menu-item-\".concat(Date.now()));// –°—Ç–∞–±–∏–ª—å–Ω—ã–π key –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã –º–µ–Ω—é\n// –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–µ–Ω—é\nconst menuImagesStore=useRef(new Map());// key -> base64 image\nconst[showNotification,setShowNotification]=useState(false);const[notificationMessage,setNotificationMessage]=useState('');const[notificationType,setNotificationType]=useState('success');// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫ —Å –∑–∞–∫—Ä—ã—Ç–∏–µ–º –≤—Å–µ—Ö –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω\nconst handleTabChange=tab=>{// –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞\n// –û—á–∏—â–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –≤–∫–ª–∞–¥–æ–∫\nif(editingItem){const formKey=(editingItem===null||editingItem===void 0?void 0:editingItem.id)||newMenuItemKeyRef.current;if(menuImagesStore.current.has(formKey)){menuImagesStore.current.delete(formKey);}}setEditingItem(null);setEditingCategory(null);setEditingTheme(null);if(editingPhoto){const formKey=(editingPhoto===null||editingPhoto===void 0?void 0:editingPhoto.id)||newPhotoKeyRef.current;if(uploadedImagesStore.current.has(formKey)){uploadedImagesStore.current.delete(formKey);}}setEditingPhoto(null);// –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –≤–∫–ª–∞–¥–∫—É\nsetActiveTab(tab);};useEffect(()=>{const loadCategoriesFromFile=async()=>{try{const loadedCategories=await loadCategories();if(Array.isArray(loadedCategories)){// –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ - —ç—Ç–æ –≤–∞–ª–∏–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–∏–ª –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)\n// –ù–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –µ—Å–ª–∏ –º–∞—Å—Å–∏–≤ –ø—Ä–æ—Å—Ç–æ –ø—É—Å—Ç–æ–π\nconst sorted=[...loadedCategories].sort((a,b)=>a.order-b.order);setCategories(sorted);console.log(\"\\uD83D\\uDCE5 loadCategoriesFromFile: \\u0417\\u0430\\u0433\\u0440\\u0443\\u0436\\u0435\\u043D\\u043E \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0439: \".concat(sorted.length));}else{// –ï—Å–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –º–∞—Å—Å–∏–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ\n// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ localStorage\nconst stored=localStorage.getItem('restaurant-categories');if(stored){try{const parsed=JSON.parse(stored);if(Array.isArray(parsed)){// –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö (–¥–∞–∂–µ –µ—Å–ª–∏ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤)\nconsole.warn('‚ö†Ô∏è loadCategoriesFromFile: –î–∞–Ω–Ω—ã–µ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º, –Ω–æ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤.');setCategories([]);}else{// –ï—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –º–∞—Å—Å–∏–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏\nconsole.log('üì• loadCategoriesFromFile: –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –º–∞—Å—Å–∏–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏');setCategories([...defaultCategories]);}}catch(e){// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏\nconsole.log('üì• loadCategoriesFromFile: –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏');setCategories([...defaultCategories]);}}else{// –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–ø–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞), –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏\nconsole.log('üì• loadCategoriesFromFile: –ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏');setCategories([...defaultCategories]);}}}catch(error){console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:',error);// –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏\nconst stored=localStorage.getItem('restaurant-categories');if(stored){try{const parsed=JSON.parse(stored);if(Array.isArray(parsed)){// –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö (–¥–∞–∂–µ –µ—Å–ª–∏ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤)\nconsole.warn('‚ö†Ô∏è loadCategoriesFromFile: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏, –Ω–æ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤.');setCategories([]);}else{console.log('üì• loadCategoriesFromFile: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –º–∞—Å—Å–∏–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏');setCategories([...defaultCategories]);}}catch(e){console.log('üì• loadCategoriesFromFile: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏');setCategories([...defaultCategories]);}}else{// –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏\nconsole.log('üì• loadCategoriesFromFile: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏');setCategories([...defaultCategories]);}}};const loadReservationsFromFile=async()=>{try{const loadedReservations=await loadReservations();setReservations(loadedReservations);}catch(error){console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫:',error);setReservations([]);}};const loadMenuItemsFromFile=async()=>{try{const loadedMenu=await loadMenu();if(Array.isArray(loadedMenu)){// –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ - —ç—Ç–æ –≤–∞–ª–∏–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–∏–ª –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏)\n// –ù–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é, –µ—Å–ª–∏ –º–∞—Å—Å–∏–≤ –ø—Ä–æ—Å—Ç–æ –ø—É—Å—Ç–æ–π\nsetMenuItems(loadedMenu);console.log(\"\\uD83D\\uDCE5 loadMenuItemsFromFile: \\u0417\\u0430\\u0433\\u0440\\u0443\\u0436\\u0435\\u043D\\u043E \\u043F\\u043E\\u0437\\u0438\\u0446\\u0438\\u0439: \".concat(loadedMenu.length));}else{// –ï—Å–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –º–∞—Å—Å–∏–≤, –ø—Ä–æ–≤–µ—Ä—è–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ\n// –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º –º–∞—Å—Å–∏–≤–æ–º \"[]\", —á—Ç–æ —Ç–æ–∂–µ –≤–∞–ª–∏–¥–Ω–æ\nconst metadataStr=localStorage.getItem('restaurant-menu-metadata');if(metadataStr){try{const metadata=JSON.parse(metadataStr);// –ï—Å–ª–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç (–¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤), –∑–Ω–∞—á–∏—Ç –º–µ–Ω—é –±—ã–ª–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ\n// –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤, –∞ –Ω–µ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é\nconsole.warn('‚ö†Ô∏è loadMenuItemsFromFile: –î–∞–Ω–Ω—ã–µ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º, –Ω–æ –µ—Å—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ. –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤.');setMenuItems([]);}catch(e){// –ï—Å–ª–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é\nconsole.log('üì• loadMenuItemsFromFile: –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é');setMenuItems([...defaultMenu]);}}else{// –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (–ø–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞), –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é\nconsole.log('üì• loadMenuItemsFromFile: –ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é');setMenuItems([...defaultMenu]);}}}catch(error){console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–Ω—é:',error);// –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ\nconst metadataStr=localStorage.getItem('restaurant-menu-metadata');if(metadataStr){try{const metadata=JSON.parse(metadataStr);// –ï—Å–ª–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç, –∑–Ω–∞—á–∏—Ç –º–µ–Ω—é –±—ã–ª–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤\nconsole.warn('‚ö†Ô∏è loadMenuItemsFromFile: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏, –Ω–æ –µ—Å—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ. –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤.');setMenuItems([]);}catch(e){// –ï—Å–ª–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é\nconsole.log('üì• loadMenuItemsFromFile: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é');setMenuItems([...defaultMenu]);}}else{// –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é\nconsole.log('üì• loadMenuItemsFromFile: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –Ω–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é');setMenuItems([...defaultMenu]);}}};const loadThemesFromFile=async()=>{try{const themeData=await loadTheme();// –û–±—ä–µ–¥–∏–Ω—è–µ–º –±–∞–∑–æ–≤—ã–µ —Ç–µ–º—ã —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏\nconst allThemes=_objectSpread(_objectSpread({},defaultThemes),themeData.themes);setThemes(allThemes);// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â—É—é —Ç–µ–º—É\nconst currentThemeId=themeData.currentTheme||'default';setCurrentTheme(currentThemeId);// –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ç–µ–º\napplyThemeOnLoad(currentThemeId,allThemes);}catch(error){console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ–º:',error);setThemes(defaultThemes);setCurrentTheme('default');applyThemeOnLoad('default',defaultThemes);}};const applyThemeOnLoad=function(themeId){let themesToUse=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;// –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ —Ç–µ–º—ã –∏–ª–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è\nconst allThemes=themesToUse||_objectSpread(_objectSpread({},defaultThemes),themes);if(themeId==='default'){document.documentElement.className='';const root=document.documentElement;root.style.removeProperty('--primary-color');root.style.removeProperty('--primary-light');root.style.removeProperty('--primary-dark');root.style.removeProperty('--secondary-color');root.style.removeProperty('--secondary-light');root.style.removeProperty('--secondary-dark');root.style.removeProperty('--accent-color');root.style.removeProperty('--background-color');root.style.removeProperty('--text-color');root.style.removeProperty('--text-light');// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω html –≤ —Ü–≤–µ—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\ndocument.documentElement.style.backgroundColor='#8B7355';return;}// –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–∑–æ–≤—ã–µ —Ç–µ–º—ã\nif(defaultThemes[themeId]){const theme=defaultThemes[themeId];const root=document.documentElement;root.style.setProperty('--primary-color',theme.primaryColor);root.style.setProperty('--primary-light',theme.primaryLight);root.style.setProperty('--primary-dark',theme.primaryDark);root.style.setProperty('--secondary-color',theme.secondaryColor);root.style.setProperty('--secondary-light',theme.secondaryLight);root.style.setProperty('--secondary-dark',theme.secondaryDark);root.style.setProperty('--accent-color',theme.accentColor);root.style.setProperty('--background-color',theme.backgroundColor);root.style.setProperty('--text-color',theme.textColor);root.style.setProperty('--text-light',theme.textLight);// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω html –¥–ª—è overscroll\ndocument.documentElement.style.backgroundColor=theme.primaryColor;return;}// –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ç–µ–º—ã\nconst theme=allThemes[themeId];if(theme){const root=document.documentElement;root.style.setProperty('--primary-color',theme.primaryColor);root.style.setProperty('--primary-light',theme.primaryLight);root.style.setProperty('--primary-dark',theme.primaryDark);root.style.setProperty('--secondary-color',theme.secondaryColor);root.style.setProperty('--secondary-light',theme.secondaryLight);root.style.setProperty('--secondary-dark',theme.secondaryDark);root.style.setProperty('--accent-color',theme.accentColor);root.style.setProperty('--background-color',theme.backgroundColor);root.style.setProperty('--text-color',theme.textColor);root.style.setProperty('--text-light',theme.textLight);// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω html –¥–ª—è overscroll\ndocument.documentElement.style.backgroundColor=theme.primaryColor;}};const loadPhotosFromFile=async()=>{try{const loadedPhotos=await loadPhotos();if(Array.isArray(loadedPhotos)&&loadedPhotos.length>0){setPhotos(loadedPhotos);}else{setPhotos([]);}}catch(error){console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π:',error);setPhotos([]);}};loadCategoriesFromFile();loadReservationsFromFile();loadMenuItemsFromFile();loadThemesFromFile();loadPhotosFromFile();},[]);const saveCategoriesToFile=async updatedCategories=>{// –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –ø–æ—Ä—è–¥–∫—É –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º\nconst sorted=[...updatedCategories].sort((a,b)=>a.order-b.order);setCategories(sorted);const saveResult=await saveCategories(sorted);if(!saveResult.success){showAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0441\\u043A\\u0430\\u0447\\u0438\\u0432\\u0430\\u043D\\u0438\\u044F \\u0444\\u0430\\u0439\\u043B\\u0430 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0439: \".concat(saveResult.message),'error');}else{showAlert('–§–∞–π–ª categories.json —Å–∫–∞—á–∞–Ω','success');}};const addCategory=async()=>{const newCategory={id:Date.now(),key:\"category_\".concat(Date.now()),name:'–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è',order:categories.length+1};const updated=[...categories,newCategory];await saveCategoriesToFile(updated);setEditingCategory(newCategory);showAlert('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞','success');};const updateCategory=async category=>{if(!category.name||!category.name.trim()){showAlert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏','error');return;}const updated=categories.map(cat=>cat.id===category.id?category:cat);await saveCategoriesToFile(updated);setEditingCategory(null);showAlert('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞','success');};const deleteCategory=async id=>{// –ù–∞—Ö–æ–¥–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (–¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è)\nconst categoryToDelete=categories.find(cat=>cat.id===id);if(categoryToDelete){console.log('üóëÔ∏è deleteCategory: –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:',{id:categoryToDelete.id,name:categoryToDelete.name,key:categoryToDelete.key});}// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –≤ –±–ª—é–¥–∞—Ö\nconst category=categories.find(cat=>cat.id===id);if(category){const itemsInCategory=menuItems.filter(item=>item.category===category.key);if(itemsInCategory.length>0){showAlert(\"\\u041D\\u0435\\u043B\\u044C\\u0437\\u044F \\u0443\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044E: \\u0432 \\u043D\\u0435\\u0439 \\u0435\\u0441\\u0442\\u044C \".concat(itemsInCategory.length,\" \\u0431\\u043B\\u044E\\u0434(\\u0430)\"),'error');return;}}// –£–¥–∞–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–∑ –º–∞—Å—Å–∏–≤–∞\nconst updated=categories.filter(cat=>cat.id!==id);console.log(\"\\uD83D\\uDDD1\\uFE0F deleteCategory: \\u041E\\u0441\\u0442\\u0430\\u043B\\u043E\\u0441\\u044C \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0439: \".concat(updated.length));// –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Ä—è–¥–æ–∫ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π\nupdated.forEach((cat,index)=>{cat.order=index+1;});// –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ (–¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω –ø—É—Å—Ç–æ–π)\nawait saveCategoriesToFile(updated);if(updated.length===0){console.log('‚úÖ deleteCategory: –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É–¥–∞–ª–µ–Ω—ã, –º–∞—Å—Å–∏–≤ –ø—É—Å—Ç–æ–π');}else{console.log('‚úÖ deleteCategory: –ö–∞—Ç–µ–≥–æ—Ä–∏—è —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞');}showAlert('–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É–¥–∞–ª–µ–Ω–∞','success');};const moveCategory=async(id,direction)=>{const index=categories.findIndex(cat=>cat.id===id);if(index===-1)return;const newIndex=direction==='up'?index-1:index+1;if(newIndex<0||newIndex>=categories.length)return;const updated=[...categories];[updated[index].order,updated[newIndex].order]=[updated[newIndex].order,updated[index].order];await saveCategoriesToFile(updated);};const showAlert=useCallback(function(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'success';setNotificationMessage(message);setNotificationType(type);setShowNotification(true);setTimeout(()=>setShowNotification(false),4000);},[]);// –§—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\nconst handleLogin=(username,password)=>{if(username==='admin'&&password==='Tbil4dSokol'){setIsAuthenticated(true);localStorage.setItem('admin-authenticated','true');showAlert('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å!','success');return true;}else{showAlert('–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å','error');return false;}};// –§—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞\nconst handleLogout=()=>{setIsAuthenticated(false);localStorage.removeItem('admin-authenticated');showAlert('–í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏','success');};// –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–º–∞–º–∏\nconst applyTheme=async themeId=>{setCurrentTheme(themeId);if(themeId==='default'){document.documentElement.className='';const root=document.documentElement;root.style.removeProperty('--primary-color');root.style.removeProperty('--primary-light');root.style.removeProperty('--primary-dark');root.style.removeProperty('--secondary-color');root.style.removeProperty('--secondary-light');root.style.removeProperty('--secondary-dark');root.style.removeProperty('--accent-color');root.style.removeProperty('--background-color');root.style.removeProperty('--text-color');root.style.removeProperty('--text-light');// –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–º—É –≤ —Ñ–∞–π–ª\nconst saveResult=await saveTheme({currentTheme:themeId,themes:themes});if(saveResult.success){showAlert('–¢–µ–º–∞ \"–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é\" –ø—Ä–∏–º–µ–Ω–µ–Ω–∞. –§–∞–π–ª theme.json —Å–∫–∞—á–∞–Ω.','success');}else{showAlert(\"\\u0422\\u0435\\u043C\\u0430 \\u043F\\u0440\\u0438\\u043C\\u0435\\u043D\\u0435\\u043D\\u0430, \\u043D\\u043E \\u0444\\u0430\\u0439\\u043B \\u043D\\u0435 \\u0441\\u043A\\u0430\\u0447\\u0430\\u043D: \".concat(saveResult.message),'error');}return;}// –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–∑–æ–≤—ã–µ —Ç–µ–º—ã\nif(defaultThemes[themeId]){const theme=defaultThemes[themeId];const root=document.documentElement;root.style.setProperty('--primary-color',theme.primaryColor);root.style.setProperty('--primary-light',theme.primaryLight);root.style.setProperty('--primary-dark',theme.primaryDark);root.style.setProperty('--secondary-color',theme.secondaryColor);root.style.setProperty('--secondary-light',theme.secondaryLight);root.style.setProperty('--secondary-dark',theme.secondaryDark);root.style.setProperty('--accent-color',theme.accentColor);root.style.setProperty('--background-color',theme.backgroundColor);root.style.setProperty('--text-color',theme.textColor);root.style.setProperty('--text-light',theme.textLight);// –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–º—É –≤ —Ñ–∞–π–ª\nconst saveResult=await saveTheme({currentTheme:themeId,themes:themes});if(saveResult.success){showAlert(\"\\u0422\\u0435\\u043C\\u0430 \\\"\".concat(theme.name,\"\\\" \\u043F\\u0440\\u0438\\u043C\\u0435\\u043D\\u0435\\u043D\\u0430. \\u0424\\u0430\\u0439\\u043B theme.json \\u0441\\u043A\\u0430\\u0447\\u0430\\u043D.\"),'success');}else{showAlert(\"\\u0422\\u0435\\u043C\\u0430 \\u043F\\u0440\\u0438\\u043C\\u0435\\u043D\\u0435\\u043D\\u0430, \\u043D\\u043E \\u0444\\u0430\\u0439\\u043B \\u043D\\u0435 \\u0441\\u043A\\u0430\\u0447\\u0430\\u043D: \".concat(saveResult.message),'error');}return;}// –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ç–µ–º—ã\nconst theme=themes[themeId];if(theme){const root=document.documentElement;root.style.setProperty('--primary-color',theme.primaryColor);root.style.setProperty('--primary-light',theme.primaryLight);root.style.setProperty('--primary-dark',theme.primaryDark);root.style.setProperty('--secondary-color',theme.secondaryColor);root.style.setProperty('--secondary-light',theme.secondaryLight);root.style.setProperty('--secondary-dark',theme.secondaryDark);root.style.setProperty('--accent-color',theme.accentColor);root.style.setProperty('--background-color',theme.backgroundColor);root.style.setProperty('--text-color',theme.textColor);root.style.setProperty('--text-light',theme.textLight);// –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–º—É –≤ —Ñ–∞–π–ª\nconst saveResult=await saveTheme({currentTheme:themeId,themes:themes});if(saveResult.success){showAlert(\"\\u0422\\u0435\\u043C\\u0430 \\\"\".concat(theme.name,\"\\\" \\u043F\\u0440\\u0438\\u043C\\u0435\\u043D\\u0435\\u043D\\u0430. \\u0424\\u0430\\u0439\\u043B theme.json \\u0441\\u043A\\u0430\\u0447\\u0430\\u043D.\"),'success');}else{showAlert(\"\\u0422\\u0435\\u043C\\u0430 \\u043F\\u0440\\u0438\\u043C\\u0435\\u043D\\u0435\\u043D\\u0430, \\u043D\\u043E \\u0444\\u0430\\u0439\\u043B \\u043D\\u0435 \\u0441\\u043A\\u0430\\u0447\\u0430\\u043D: \".concat(saveResult.message),'error');}}};const saveThemes=async updatedThemes=>{// –û–±—ä–µ–¥–∏–Ω—è–µ–º –±–∞–∑–æ–≤—ã–µ —Ç–µ–º—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è\nconst allThemes=_objectSpread(_objectSpread({},defaultThemes),updatedThemes);setThemes(allThemes);// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ñ–∞–π–ª\nconst saveResult=await saveTheme({currentTheme:currentTheme,themes:allThemes});if(!saveResult.success){showAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0441\\u043A\\u0430\\u0447\\u0438\\u0432\\u0430\\u043D\\u0438\\u044F \\u0444\\u0430\\u0439\\u043B\\u0430 \\u0442\\u0435\\u043C: \".concat(saveResult.message),'error');}else{showAlert('–§–∞–π–ª theme.json —Å–∫–∞—á–∞–Ω','success');}};// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–≤–µ—Ç–ª–æ–≥–æ –∏ —Ç–µ–º–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ü–≤–µ—Ç–∞\nconst hexToRgb=hex=>{const result=/^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null;};const rgbToHex=(r,g,b)=>{return\"#\"+[r,g,b].map(x=>{const hex=x.toString(16);return hex.length===1?\"0\"+hex:hex;}).join(\"\");};const lightenColor=function(hex){let percent=arguments.length>1&&arguments[1]!==undefined?arguments[1]:20;const rgb=hexToRgb(hex);if(!rgb)return hex;const r=Math.min(255,Math.round(rgb.r+(255-rgb.r)*(percent/100)));const g=Math.min(255,Math.round(rgb.g+(255-rgb.g)*(percent/100)));const b=Math.min(255,Math.round(rgb.b+(255-rgb.b)*(percent/100)));return rgbToHex(r,g,b);};const darkenColor=function(hex){let percent=arguments.length>1&&arguments[1]!==undefined?arguments[1]:20;const rgb=hexToRgb(hex);if(!rgb)return hex;const r=Math.max(0,Math.round(rgb.r*(1-percent/100)));const g=Math.max(0,Math.round(rgb.g*(1-percent/100)));const b=Math.max(0,Math.round(rgb.b*(1-percent/100)));return rgbToHex(r,g,b);};const addTheme=()=>{const basePrimaryColor='#8B7355';const newTheme={id:\"theme_\".concat(Date.now()),name:'–ù–æ–≤–∞—è —Ç–µ–º–∞',primaryColor:basePrimaryColor,primaryLight:lightenColor(basePrimaryColor,20),primaryDark:darkenColor(basePrimaryColor,20),secondaryColor:'#A8D8EA',secondaryLight:'#C5E7F5',secondaryDark:'#7BB8D4',accentColor:'#D4B896',backgroundColor:'#FDF6E3',textColor:'#333333',textLight:'#666666'};const updated=_objectSpread(_objectSpread({},themes),{},{[newTheme.id]:newTheme});saveThemes(updated);setEditingTheme(newTheme);showAlert('–¢–µ–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞','success');};const updateTheme=theme=>{if(!theme.name||!theme.name.trim()){showAlert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã','error');return;}// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ–º —Å–≤–µ—Ç–ª—ã–π –∏ —Ç–µ–º–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞\nconst updatedTheme=_objectSpread(_objectSpread({},theme),{},{primaryLight:lightenColor(theme.primaryColor,20),primaryDark:darkenColor(theme.primaryColor,20)});const updated=_objectSpread(_objectSpread({},themes),{},{[updatedTheme.id]:updatedTheme});saveThemes(updated);setEditingTheme(null);showAlert('–¢–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞','success');};const deleteTheme=id=>{if(defaultThemes[id]){showAlert('–ë–∞–∑–æ–≤—ã–µ —Ç–µ–º—ã –Ω–µ–ª—å–∑—è —É–¥–∞–ª—è—Ç—å','error');return;}const updated=_objectSpread({},themes);delete updated[id];saveThemes(updated);if(currentTheme===id){applyTheme('default');}showAlert('–¢–µ–º–∞ —É–¥–∞–ª–µ–Ω–∞','success');};const deleteReservation=async id=>{const updated=reservations.filter(res=>res.id!==id);setReservations(updated);const saveResult=await autoSaveReservations(updated);if(saveResult.success){showAlert('–ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞','success');}else{showAlert(\"\\u0417\\u0430\\u044F\\u0432\\u043A\\u0430 \\u0443\\u0434\\u0430\\u043B\\u0435\\u043D\\u0430, \\u043D\\u043E \\u0444\\u0430\\u0439\\u043B \\u043D\\u0435 \\u0441\\u043A\\u0430\\u0447\\u0430\\u043D: \".concat(saveResult.message),'error');}};const deleteMenuItem=async id=>{// –ù–∞—Ö–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (–¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è)\nconst itemToDelete=menuItems.find(item=>item.id===id);if(itemToDelete){const hasImage=itemToDelete.image&&itemToDelete.image.startsWith('data:image');console.log('üóëÔ∏è deleteMenuItem: –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –º–µ–Ω—é:',{id:itemToDelete.id,name:itemToDelete.name,hasImage:hasImage,imageSize:hasImage?itemToDelete.image.length:0});}// –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –º–µ–Ω—é (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å —ç–ª–µ–º–µ–Ω—Ç–æ–º, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–æ —á–∞—Å—Ç—å JSON)\nconst updated=menuItems.filter(item=>item.id!==id);setMenuItems(updated);// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —Ñ–∞–π–ª\n// –ü—Ä–∏ —ç—Ç–æ–º —Å—Ç–∞—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (base64) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ —ç–ª–µ–º–µ–Ω—Ç —É–¥–∞–ª–µ–Ω –∏–∑ –º–∞—Å—Å–∏–≤–∞\nconst saveResult=await autoSaveMenu(updated);if(saveResult.success){console.log('‚úÖ deleteMenuItem: –ü–æ–∑–∏—Ü–∏—è –º–µ–Ω—é –∏ –µ—ë –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã');showAlert('–ë–ª—é–¥–æ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–æ','success');}else{console.error('‚ùå deleteMenuItem: –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è:',saveResult.message);showAlert(\"\\u0411\\u043B\\u044E\\u0434\\u043E \\u0443\\u0434\\u0430\\u043B\\u0435\\u043D\\u043E, \\u043D\\u043E \\u0444\\u0430\\u0439\\u043B \\u043D\\u0435 \\u0441\\u043A\\u0430\\u0447\\u0430\\u043D: \".concat(saveResult.message),'error');}};const cancelPhotoEditing=useCallback(()=>{// –û—á–∏—â–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ\nconst formKey=(editingPhoto===null||editingPhoto===void 0?void 0:editingPhoto.id)||newPhotoKeyRef.current;if(uploadedImagesStore.current.has(formKey)){uploadedImagesStore.current.delete(formKey);}setEditingPhoto(null);},[editingPhoto]);const savePhoto=useCallback(async photo=>{try{// –í–∞–ª–∏–¥–∞—Ü–∏—è: –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è\nif(!photo.image||!photo.image.trim()){showAlert('–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ','error');return;}// –í–∞–ª–∏–¥–∞—Ü–∏—è: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å base64\nif(!photo.image.startsWith('data:image')){showAlert('–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è','error');return;}// –í–∞–ª–∏–¥–∞—Ü–∏—è: –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—É—Å—Ç—ã–µ –æ–±—ä–µ–∫—Ç—ã –∏–ª–∏ –æ–±—ä–µ–∫—Ç—ã —Ç–æ–ª—å–∫–æ —Å —Ç–µ–∫—Å—Ç–æ–º (–±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)\n// –≠—Ç–æ —É–∂–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤—ã—à–µ, –Ω–æ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –µ—â–µ —Ä–∞–∑\nconst hasValidImage=photo.image&&photo.image.trim()&&photo.image.startsWith('data:image');if(!hasValidImage){showAlert('–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ','error');return;}let updated;if(photo.id){// –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏\nconst oldPhoto=photos.find(p=>p.id===photo.id);const imageChanged=(oldPhoto===null||oldPhoto===void 0?void 0:oldPhoto.image)!==photo.image;console.log('üíæ savePhoto: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏:',{id:photo.id,caption:photo.caption,oldImageSize:oldPhoto!==null&&oldPhoto!==void 0&&oldPhoto.image?oldPhoto.image.length:0,newImageSize:photo.image?photo.image.length:0,imageChanged:imageChanged});// –ó–∞–º–µ–Ω—è–µ–º —Å—Ç–∞—Ä—É—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –Ω–æ–≤–æ–π (—Å—Ç–∞—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å–æ —Å—Ç–∞—Ä—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º)\nupdated=photos.map(p=>p.id===photo.id?photo:p);if(imageChanged){console.log('üîÑ savePhoto: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–º–µ–Ω–µ–Ω–æ, —Å—Ç–∞—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏');}}else{// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏\n// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID, –ø—Ä–æ–≤–µ—Ä—è—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏\nconst newId=generateUniqueId(photos);const newPhoto=_objectSpread(_objectSpread({},photo),{},{id:newId});updated=[...photos,newPhoto];}// –§–∏–ª—å—Ç—Ä—É–µ–º –ø—É—Å—Ç—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º\nconst validPhotos=updated.filter(p=>{return p&&p.image&&p.image.trim()&&p.image.startsWith('data:image');});setPhotos(validPhotos);// –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä\nconst saveResult=await autoSavePhotos(validPhotos);if(!saveResult.success){// –ï—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –Ω–µ —É–¥–∞–ª–æ—Å—å, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –∏ –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ\nshowAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0441\\u043E\\u0445\\u0440\\u0430\\u043D\\u0435\\u043D\\u0438\\u044F \\u043D\\u0430 \\u0441\\u0435\\u0440\\u0432\\u0435\\u0440: \".concat(saveResult.message),'error');console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏:',saveResult);return;// –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞\n}// –û—á–∏—â–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —ç—Ç–æ–π —Ñ–æ—Ä–º—ã –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è\nconst formKey=photo.id||newPhotoKeyRef.current;if(uploadedImagesStore.current.has(formKey)){uploadedImagesStore.current.delete(formKey);}setEditingPhoto(null);showAlert(photo.id?'–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞':'–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞','success');}catch(error){console.error('–ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏:',error);showAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0441\\u043E\\u0445\\u0440\\u0430\\u043D\\u0435\\u043D\\u0438\\u0438 \\u0444\\u043E\\u0442\\u043E\\u0433\\u0440\\u0430\\u0444\\u0438\\u0438: \".concat(error.message),'error');}},[photos]);const deletePhoto=async id=>{// –ù–∞—Ö–æ–¥–∏–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (–¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è)\nconst photoToDelete=photos.find(p=>p.id===id);if(photoToDelete){const hasImage=photoToDelete.image&&photoToDelete.image.startsWith('data:image');console.log('üóëÔ∏è deletePhoto: –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏:',{id:photoToDelete.id,caption:photoToDelete.caption,hasImage:hasImage,imageSize:hasImage?photoToDelete.image.length:0});}// –£–¥–∞–ª—è–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –∏–∑ –º–∞—Å—Å–∏–≤–∞ (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å —ç–ª–µ–º–µ–Ω—Ç–æ–º, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–æ —á–∞—Å—Ç—å JSON)\nconst updated=photos.filter(p=>p.id!==id);setPhotos(updated);// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –≤ —Ñ–∞–π–ª\n// –ü—Ä–∏ —ç—Ç–æ–º —Å—Ç–∞—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (base64) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ —ç–ª–µ–º–µ–Ω—Ç —É–¥–∞–ª–µ–Ω –∏–∑ –º–∞—Å—Å–∏–≤–∞\nconst saveResult=await autoSavePhotos(updated);if(saveResult.success){console.log('‚úÖ deletePhoto: –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –∏ –µ—ë –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã');showAlert('–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è —É–¥–∞–ª–µ–Ω–∞','success');}else{showAlert(\"\\u0424\\u043E\\u0442\\u043E\\u0433\\u0440\\u0430\\u0444\\u0438\\u044F \\u0443\\u0434\\u0430\\u043B\\u0435\\u043D\\u0430, \\u043D\\u043E \\u0444\\u0430\\u0439\\u043B \\u043D\\u0435 \\u0441\\u043A\\u0430\\u0447\\u0430\\u043D: \".concat(saveResult.message),'error');}};const validateMenuItem=item=>{if(!item.name||!item.name.trim()){showAlert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞','error');return false;}if(!item.price||isNaN(parseFloat(item.price))||parseFloat(item.price)<=0){showAlert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ü–µ–Ω—É (–±–æ–ª—å—à–µ 0)','error');return false;}if(!item.weight||!item.weight.trim()){showAlert('–í–≤–µ–¥–∏—Ç–µ –≤–µ—Å/–æ–±—ä–µ–º','error');return false;}if(!item.description||!item.description.trim()){showAlert('–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –±–ª—é–¥–∞','error');return false;}if(!item.image||!item.image.trim()){showAlert('–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ','error');return false;}if(!item.image.startsWith('data:image')){showAlert('–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è','error');return false;}return true;};const saveMenuItem=async item=>{if(!validateMenuItem(item))return;console.log('üíæ saveMenuItem: –ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:',{id:item.id,name:item.name,hasImage:!!item.image,imageLength:item.image?item.image.length:0,imageStart:item.image?item.image.substring(0,50):'–Ω–µ—Ç'});// –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ü–µ–Ω—É (—É–±–∏—Ä–∞–µ–º \"‚ÇΩ\" –µ—Å–ª–∏ –µ—Å—Ç—å –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —á–∏—Å–ª–æ)\nconst formattedItem=_objectSpread(_objectSpread({},item),{},{price:item.price.toString().replace(' ‚ÇΩ','')});// –í–ê–ñ–ù–û: —É–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ\nif(item.image){formattedItem.image=item.image;}console.log('üíæ saveMenuItem: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:',{id:formattedItem.id,name:formattedItem.name,hasImage:!!formattedItem.image,imageLength:formattedItem.image?formattedItem.image.length:0,imageStart:formattedItem.image?formattedItem.image.substring(0,50):'–Ω–µ—Ç'});let updatedItems;if(editingItem&&editingItem.id){// –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –±–ª—é–¥–∞ (–ª—é–±–æ–≥–æ, –≤–∫–ª—é—á–∞—è –±–∞–∑–æ–≤—ã–µ)\nconst oldItem=menuItems.find(mi=>mi.id===editingItem.id);const imageChanged=(oldItem===null||oldItem===void 0?void 0:oldItem.image)!==formattedItem.image;console.log('üíæ saveMenuItem: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞:',{id:editingItem.id,name:formattedItem.name,oldImageSize:oldItem!==null&&oldItem!==void 0&&oldItem.image?oldItem.image.length:0,newImageSize:formattedItem.image?formattedItem.image.length:0,imageChanged:imageChanged});// –ó–∞–º–µ–Ω—è–µ–º —Å—Ç–∞—Ä—ã–π —ç–ª–µ–º–µ–Ω—Ç –Ω–æ–≤—ã–º (—Å—Ç–∞—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å–æ —Å—Ç–∞—Ä—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º)\nupdatedItems=menuItems.map(menuItem=>menuItem.id===editingItem.id?_objectSpread(_objectSpread({},formattedItem),{},{id:editingItem.id}):menuItem);if(imageChanged){console.log('üîÑ saveMenuItem: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–º–µ–Ω–µ–Ω–æ, —Å—Ç–∞—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏');}showAlert('–ë–ª—é–¥–æ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ','success');}else{// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –±–ª—é–¥–∞\n// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID, –ø—Ä–æ–≤–µ—Ä—è—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã\nconst newId=generateUniqueId(menuItems);const newItem=_objectSpread(_objectSpread({},formattedItem),{},{id:newId});updatedItems=[...menuItems,newItem];showAlert('–ë–ª—é–¥–æ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ','success');}setMenuItems(updatedItems);// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —Ñ–∞–π–ª (–≤–∫–ª—é—á–∞—è –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–∞–∑–æ–≤—ã–µ)\nconst saveResult=await autoSaveMenu(updatedItems);if(!saveResult.success){showAlert(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0441\\u043A\\u0430\\u0447\\u0438\\u0432\\u0430\\u043D\\u0438\\u044F \\u0444\\u0430\\u0439\\u043B\\u0430 \\u043C\\u0435\\u043D\\u044E: \".concat(saveResult.message),'error');}else{showAlert('–§–∞–π–ª menu.json —Å–∫–∞—á–∞–Ω','success');}// –û—á–∏—â–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —ç—Ç–æ–π —Ñ–æ—Ä–º—ã –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è\nconst formKey=(editingItem===null||editingItem===void 0?void 0:editingItem.id)||newMenuItemKeyRef.current;if(menuImagesStore.current.has(formKey)){menuImagesStore.current.delete(formKey);}setEditingItem(null);};const startEditing=item=>{setEditingItem(item);};const cancelEditing=useCallback(()=>{// –û—á–∏—â–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ\nconst formKey=(editingItem===null||editingItem===void 0?void 0:editingItem.id)||newMenuItemKeyRef.current;if(menuImagesStore.current.has(formKey)){menuImagesStore.current.delete(formKey);}// –û—á–∏—â–∞–µ–º localStorage —Å –¥–∞–Ω–Ω—ã–º–∏ —Ñ–æ—Ä–º—ã –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤)\nif(!(editingItem!==null&&editingItem!==void 0&&editingItem.id)){try{const formDataStorageKey=\"menu-item-form-\".concat(formKey);localStorage.removeItem(formDataStorageKey);console.log('üóëÔ∏è cancelEditing: –î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã —É–¥–∞–ª–µ–Ω—ã –∏–∑ localStorage –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ');}catch(e){console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã –∏–∑ localStorage:',e);}}setEditingItem(null);},[editingItem]);// –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–æ—Ä–º—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–º—ã\nconst ThemeEditForm=_ref=>{let{theme,onSave,onCancel}=_ref;const[formData,setFormData]=useState(theme);// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ü–≤–µ—Ç–∞ (–ª–æ–∫–∞–ª—å–Ω—ã–µ –∫–æ–ø–∏–∏)\nconst hexToRgbLocal=hex=>{const result=/^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null;};const rgbToHexLocal=(r,g,b)=>{return\"#\"+[r,g,b].map(x=>{const hex=x.toString(16);return hex.length===1?\"0\"+hex:hex;}).join(\"\");};const lightenColorLocal=function(hex){let percent=arguments.length>1&&arguments[1]!==undefined?arguments[1]:20;const rgb=hexToRgbLocal(hex);if(!rgb)return hex;const r=Math.min(255,Math.round(rgb.r+(255-rgb.r)*(percent/100)));const g=Math.min(255,Math.round(rgb.g+(255-rgb.g)*(percent/100)));const b=Math.min(255,Math.round(rgb.b+(255-rgb.b)*(percent/100)));return rgbToHexLocal(r,g,b);};const darkenColorLocal=function(hex){let percent=arguments.length>1&&arguments[1]!==undefined?arguments[1]:20;const rgb=hexToRgbLocal(hex);if(!rgb)return hex;const r=Math.max(0,Math.round(rgb.r*(1-percent/100)));const g=Math.max(0,Math.round(rgb.g*(1-percent/100)));const b=Math.max(0,Math.round(rgb.b*(1-percent/100)));return rgbToHexLocal(r,g,b);};const handleChange=(field,value)=>{const updated=_objectSpread(_objectSpread({},formData),{},{[field]:value});// –ï—Å–ª–∏ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ–º —Å–≤–µ—Ç–ª—ã–π –∏ —Ç–µ–º–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç—ã\nif(field==='primaryColor'){updated.primaryLight=lightenColorLocal(value,20);updated.primaryDark=darkenColorLocal(value,20);}setFormData(updated);};const handleSubmit=e=>{e.preventDefault();onSave(formData);};const colorFields=[{key:'primaryColor',label:'–û—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç'},{key:'secondaryColor',label:'–¶–≤–µ—Ç –∫–Ω–æ–ø–æ–∫ –∏ —Å—Å—ã–ª–æ–∫'},{key:'secondaryLight',label:'–¶–≤–µ—Ç –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏'},{key:'secondaryDark',label:'–¶–≤–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤'},{key:'accentColor',label:'–ê–∫—Ü–µ–Ω—Ç–Ω—ã–π —Ü–≤–µ—Ç (–≤—ã–¥–µ–ª–µ–Ω–∏—è)'},{key:'backgroundColor',label:'–¶–≤–µ—Ç —Ñ–æ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã'},{key:'textColor',label:'–¶–≤–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞'},{key:'textLight',label:'–¶–≤–µ—Ç –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞'}];return/*#__PURE__*/_jsx(\"div\",{className:\"theme-edit-form\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0442\\u0435\\u043C\\u044B *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.name,onChange:e=>handleChange('name',e.target.value),placeholder:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0442\\u0435\\u043C\\u044B\",required:true})]}),/*#__PURE__*/_jsx(\"div\",{className:\"theme-colors-grid\",children:colorFields.map(field=>/*#__PURE__*/_jsxs(\"div\",{className:\"color-picker-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:field.label}),/*#__PURE__*/_jsxs(\"div\",{className:\"color-picker-wrapper\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"color\",value:formData[field.key],onChange:e=>handleChange(field.key,e.target.value),className:\"color-picker\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData[field.key],onChange:e=>handleChange(field.key,e.target.value),className:\"color-input\",placeholder:\"#000000\"}),/*#__PURE__*/_jsx(\"div\",{className:\"color-preview\",style:{background:formData[field.key]}})]})]},field.key))}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"save-btn\",children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"cancel-btn\",onClick:onCancel,children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"})]})]})});};// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º\n// –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ MIME-—Ç–∏–ø, –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –≤—Å–µ—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤\nconst isImageFile=file=>{// –ü—Ä–æ–≤–µ—Ä—è–µ–º MIME-—Ç–∏–ø (–æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)\nif(file.type&&file.type.startsWith('image/')){return true;}// Fallback: –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞\n// –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –≤—Å–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π\nconst imageExtensions=['jpg','jpeg','png','gif','webp','bmp','svg','ico','tiff','tif','heic','heif','avif','apng'];const fileName=file.name.toLowerCase();const extension=fileName.split('.').pop();return imageExtensions.includes(extension);};const convertFileToBase64=file=>{return new Promise((resolve,reject)=>{const reader=new FileReader();reader.onload=()=>resolve(reader.result);reader.onerror=reject;reader.readAsDataURL(file);});};// –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\nconst LoginForm=_ref2=>{let{onLogin}=_ref2;const[username,setUsername]=useState('');const[password,setPassword]=useState('');const[error,setError]=useState('');const handleSubmit=e=>{e.preventDefault();setError('');if(!username.trim()||!password.trim()){setError('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');return;}const success=onLogin(username,password);if(!success){setError('–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å');setPassword('');}};return/*#__PURE__*/_jsx(\"div\",{className:\"admin-login-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"admin-login-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"admin-login-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0410\\u0434\\u043C\\u0438\\u043D-\\u043F\\u0430\\u043D\\u0435\\u043B\\u044C\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u0412\\u043E\\u0439\\u0434\\u0438\\u0442\\u0435 \\u0434\\u043B\\u044F \\u0443\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u044F \\u0441\\u0430\\u0439\\u0442\\u043E\\u043C\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"login-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",children:\"\\u041B\\u043E\\u0433\\u0438\\u043D\"}),/*#__PURE__*/_jsx(\"input\",{id:\"username\",type:\"text\",value:username,onChange:e=>setUsername(e.target.value),placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043B\\u043E\\u0433\\u0438\\u043D\",autoFocus:true,className:error?'error':''})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\"}),/*#__PURE__*/_jsx(\"input\",{id:\"password\",type:\"password\",value:password,onChange:e=>setPassword(e.target.value),placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\",className:error?'error':''})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"login-error\",children:error}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"login-submit-btn\",children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"})]})]})});};// –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–æ—Ä–º—ã –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π\nconst PhotoForm=_ref3=>{let{photo,onSave,onCancel,onAlert,uploadedImagesStore,formKey}=_ref3;// –ò–∑–≤–ª–µ–∫–∞–µ–º ID —Ñ–æ—Ç–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π\n// –ò—Å–ø–æ–ª—å–∑—É–µ–º useMemo –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ª–∏—à–Ω–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π\nconst photoId=useMemo(()=>photo===null||photo===void 0?void 0:photo.id,[photo===null||photo===void 0?void 0:photo.id]);// –°–æ—Ö—Ä–∞–Ω—è–µ–º ID —Ñ–æ—Ç–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π\n// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º ref —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\nconst photoIdRef=useRef(photoId);const isInitialMountRef=useRef(true);// –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è\n// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\n// –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, –µ—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—ã–ª–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ —Ä–∞–Ω–µ–µ\nconst[image,setImage]=useState(()=>{// –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ\nif(uploadedImagesStore&&uploadedImagesStore.has(formKey)){return uploadedImagesStore.get(formKey);}return(photo===null||photo===void 0?void 0:photo.image)||'';});const[caption,setCaption]=useState((photo===null||photo===void 0?void 0:photo.caption)||'');const[isUploading,setIsUploading]=useState(false);const[isDragging,setIsDragging]=useState(false);const fileInputRef=useRef(null);const userHasUploadedRef=useRef(false);// –§–ª–∞–≥: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\nconst uploadedImageRef=useRef(null);// –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\nconst isProcessingFileRef=useRef(false);// –§–ª–∞–≥: —Ñ–∞–π–ª –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è\n// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ ID —Ñ–æ—Ç–æ (–Ω–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ)\nuseEffect(()=>{const isInitialMount=isInitialMountRef.current;isInitialMountRef.current=false;// –ï—Å–ª–∏ ID –∏–∑–º–µ–Ω–∏–ª—Å—è (–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ)\nif(photoIdRef.current!==photoId){photoIdRef.current=photoId;// –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã, –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –µ–≥–æ\nif(userHasUploadedRef.current&&!photoId&&uploadedImageRef.current){// –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\nsetImage(uploadedImageRef.current);return;// –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n}// –ï—Å–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Ñ–æ—Ç–æ - –∑–∞–≥—Ä—É–∂–∞–µ–º –µ–≥–æ –¥–∞–Ω–Ω—ã–µ\nif(photoId&&photo){userHasUploadedRef.current=false;uploadedImageRef.current=null;setImage(photo.image||'');setCaption(photo.caption||'');}else{// –ù–æ–≤–∞—è —Ñ–æ—Ä–º–∞ - —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â–µ –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª\nif(!userHasUploadedRef.current&&!uploadedImageRef.current){setImage('');setCaption('');}else if(uploadedImageRef.current){// –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\nsetImage(uploadedImageRef.current);}}}// –ù–ï –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º isInitialMount –∑–¥–µ—Å—å - —ç—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–µ\n},[photoId]);// –ó–∞–≤–∏—Å–∏–º –¢–û–õ–¨–ö–û –æ—Ç photoId - —ç—Ç–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ\n// –û—Ç–¥–µ–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\nuseEffect(()=>{if(isInitialMountRef.current&&!photoId&&image&&image.startsWith('data:image')){uploadedImageRef.current=image;}},[]);// –¢–æ–ª—å–∫–æ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\n// –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–±—Ä–æ—Å–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–µ\n// –≠—Ç–æ—Ç —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, –µ—Å–ª–∏ –æ–Ω–æ –±—ã–ª–æ —Å–±—Ä–æ—à–µ–Ω–æ\nuseEffect(()=>{// –¢–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã (–±–µ–∑ ID) –∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n// –ò –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –±—ã–ª–æ —è–≤–Ω–æ —É–¥–∞–ª–µ–Ω–æ (ref –Ω–µ null)\nif(!photoId&&userHasUploadedRef.current&&uploadedImageRef.current){// –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—É—Å—Ç–æ–µ, –Ω–æ –≤ ref –∏–ª–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –µ—Å—Ç—å - –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º\nif(!image){// –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ\nconst storedImage=uploadedImagesStore&&uploadedImagesStore.has(formKey)?uploadedImagesStore.get(formKey):null;if(storedImage){// –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞\nuploadedImageRef.current=storedImage;setImage(storedImage);return;}// –ï—Å–ª–∏ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–µ—Ç, –Ω–æ –≤ ref –µ—Å—Ç—å - –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑ ref\nif(uploadedImageRef.current){// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –±—É–¥—É—â–∏—Ö –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–æ–≤\nif(uploadedImagesStore&&formKey){uploadedImagesStore.set(formKey,uploadedImageRef.current);}setImage(uploadedImageRef.current);}}}});// –ë–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π - —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ –¥–ª—è –∑–∞—â–∏—Ç—ã\nconst handleChange=e=>{if(e.target.name==='caption'){setCaption(e.target.value);}};const processFile=async file=>{if(!file){return;}// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø —Ñ–∞–π–ª–∞ (MIME-—Ç–∏–ø –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)\nif(!isImageFile(file)){onAlert('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (JPG, PNG, GIF, WEBP, BMP, SVG, HEIC –∏ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã)','error');return;}// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–º–∞–∫—Å–∏–º—É–º 5MB)\nif(file.size>5*1024*1024){onAlert('–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å 5MB','error');return;}setIsUploading(true);try{const base64=await convertFileToBase64(file);// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\nuserHasUploadedRef.current=true;uploadedImageRef.current=base64;// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ ref –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Å–±—Ä–æ—Å–∞\n// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–µ\nif(uploadedImagesStore&&formKey){uploadedImagesStore.set(formKey,base64);}// –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ\n// —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ\nsetImage(prevImage=>{// –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç, –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ–º\nif(prevImage===base64){return prevImage;}return base64;});// –û—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º –≤—ã–∑–æ–≤ onAlert, —á—Ç–æ–±—ã –¥–∞—Ç—å React –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ\n// –ò—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–¥–µ—Ä–∂–∫—É, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ\n// –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —É—Å–ø–µ–ª –æ—Ç—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å—Å—è —Å –Ω–æ–≤—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º\nsetTimeout(()=>{// –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º onAlert\nsetImage(currentImage=>{// –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—ã–ª–æ —Å–±—Ä–æ—à–µ–Ω–æ, –Ω–æ –≤ ref –æ–Ω–æ –µ—Å—Ç—å - –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º\nif(!currentImage&&uploadedImageRef.current){return uploadedImageRef.current;}return currentImage;});// –í—ã–∑—ã–≤–∞–µ–º onAlert —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ\nonAlert('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ','success');},150);}catch(error){console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞:',error);onAlert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞','error');}finally{setIsUploading(false);}};const handleFileChange=async e=>{var _e$target$files;// –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤\nif(isProcessingFileRef.current){return;}const file=(_e$target$files=e.target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0];if(!file){return;}// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –æ–±—Ä–∞–±–æ—Ç–∫–∏\nisProcessingFileRef.current=true;// –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ input –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏\nconst input=e.target;try{await processFile(file);}finally{// –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –æ–±—Ä–∞–±–æ—Ç–∫–∏\nisProcessingFileRef.current=false;// –û—á–∏—â–∞–µ–º input –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ—Ç –∂–µ —Ñ–∞–π–ª —Å–Ω–æ–≤–∞\n// –î–µ–ª–∞–µ–º —ç—Ç–æ —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π, —á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–µ\nsetTimeout(()=>{if(input){input.value='';}},100);}};const handleDragOver=e=>{e.preventDefault();e.stopPropagation();setIsDragging(true);};const handleDragLeave=e=>{e.preventDefault();e.stopPropagation();setIsDragging(false);};const handleDrop=async e=>{var _e$dataTransfer$files;e.preventDefault();e.stopPropagation();setIsDragging(false);const file=(_e$dataTransfer$files=e.dataTransfer.files)===null||_e$dataTransfer$files===void 0?void 0:_e$dataTransfer$files[0];if(file){console.log('–§–∞–π–ª –ø–µ—Ä–µ—Ç–∞—â–µ–Ω (PhotoForm):',file.name,file.type,file.size);await processFile(file);}};const handleSubmit=e=>{e.preventDefault();e.stopPropagation();if(!image||!image.trim()){onAlert('–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ','error');return;}if(!image.startsWith('data:image')){onAlert('–û—à–∏–±–∫–∞: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ','error');return;}const photoData=_objectSpread(_objectSpread({},(photo===null||photo===void 0?void 0:photo.id)&&{id:photo.id}),{},{image:image.trim(),caption:caption.trim()||undefined});onSave(photoData);};return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsx(\"h2\",{children:photo?'–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ç–æ':'–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,noValidate:true,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"file-upload-dropzone \".concat(isDragging?'dragging':'',\" \").concat(image?'has-image':''),onDragOver:handleDragOver,onDragLeave:handleDragLeave,onDrop:handleDrop,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"file-upload-wrapper\",children:[/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\"image/*\",onChange:handleFileChange,className:\"file-input-hidden\",disabled:isUploading}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"file-upload-button\",onClick:e=>{e.preventDefault();if(fileInputRef.current){fileInputRef.current.click();}},disabled:isUploading,children:isUploading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"upload-icon\",children:\"\\u23F3\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"upload-icon\",children:\"\\uD83D\\uDCF7\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0412\\u044B\\u0431\\u0440\\u0430\\u0442\\u044C \\u0438\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0435\"})]})}),image&&!isUploading&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"file-remove-button\",onClick:()=>{userHasUploadedRef.current=false;// –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏\nuploadedImageRef.current=null;// –û—á–∏—â–∞–µ–º ref\n// –û—á–∏—â–∞–µ–º –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞\nif(uploadedImagesStore&&formKey){uploadedImagesStore.delete(formKey);}setImage('');if(fileInputRef.current){fileInputRef.current.value='';}},children:\"\\u2715\"})]}),!image&&/*#__PURE__*/_jsx(\"p\",{className:\"drag-drop-hint\",children:\"\\u0438\\u043B\\u0438 \\u043F\\u0435\\u0440\\u0435\\u0442\\u0430\\u0449\\u0438\\u0442\\u0435 \\u0438\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0435 \\u0441\\u044E\\u0434\\u0430\"})]})]}),image&&image.trim()?/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"photo-preview-modern\",children:[/*#__PURE__*/_jsx(\"img\",{src:image,alt:\"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\",onError:e=>{e.target.src='https://via.placeholder.com/300x200/8B7355/FFFFFF?text=–¢–±–∏–ª–∏—Å–∏';}}),/*#__PURE__*/_jsx(\"div\",{className:\"photo-preview-overlay\",children:/*#__PURE__*/_jsx(\"span\",{className:\"preview-badge\",children:\"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\"})})]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"p\",{style:{color:'#999',fontStyle:'italic',fontSize:'0.9rem'},children:\"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440 \\u043F\\u043E\\u044F\\u0432\\u0438\\u0442\\u0441\\u044F \\u043F\\u043E\\u0441\\u043B\\u0435 \\u0432\\u044B\\u0431\\u043E\\u0440\\u0430 \\u0444\\u0430\\u0439\\u043B\\u0430\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u041F\\u043E\\u0434\\u043F\\u0438\\u0441\\u044C (\\u043D\\u0435\\u043E\\u0431\\u044F\\u0437\\u0430\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"caption\",value:caption,onChange:handleChange,placeholder:\"\\u041F\\u043E\\u0434\\u043F\\u0438\\u0441\\u044C \\u043A \\u0444\\u043E\\u0442\\u043E\\u0433\\u0440\\u0430\\u0444\\u0438\\u0438\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"save-btn\",children:photo?'–û–±–Ω–æ–≤–∏—Ç—å':'–î–æ–±–∞–≤–∏—Ç—å'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"cancel-btn\",onClick:onCancel,children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"})]})]})]})});};const MenuItemForm=_ref4=>{let{item,onSave,onCancel,onAlert,menuImagesStore,formKey}=_ref4;const defaultCategory=categories.length>0?categories[0].key:'cold';// –ò–∑–≤–ª–µ–∫–∞–µ–º ID —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π\nconst itemId=useMemo(()=>item===null||item===void 0?void 0:item.id,[item===null||item===void 0?void 0:item.id]);// –°–æ—Ö—Ä–∞–Ω—è–µ–º ID —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π\nconst itemIdRef=useRef(itemId);const isInitialMountRef=useRef(true);// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º refs –î–û useState, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–µ\nconst fileInputRef=useRef(null);const isProcessingFileRef=useRef(false);// –§–ª–∞–≥: —Ñ–∞–π–ª –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è\nconst uploadedImageRef=useRef(null);// –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\nconst userHasUploadedRef=useRef(false);// –§–ª–∞–≥: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n// –ö–ª—é—á –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã –≤ localStorage\nconst formDataStorageKey=\"menu-item-form-\".concat(formKey);// –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–∫–∞–∫ –≤ PhotoForm)\nconst[image,setImage]=useState(()=>{// –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ\nif(menuImagesStore&&menuImagesStore.has(formKey)){const storedImage=menuImagesStore.get(formKey);// –ï—Å–ª–∏ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –µ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥–∏\nif(storedImage&&storedImage.startsWith('data:image')){userHasUploadedRef.current=true;uploadedImageRef.current=storedImage;}return storedImage;}return(item===null||item===void 0?void 0:item.image)||'';});const[formData,setFormData]=useState(()=>{// –ï—Å–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç - –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –¥–∞–Ω–Ω—ã–µ\nif(item){return{name:item.name||'',price:item.price.toString().replace(' ‚ÇΩ',''),weight:item.weight||'',description:item.description||'',category:item.category||defaultCategory};}// –î–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã - –ø—ã—Ç–∞–µ–º—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ localStorage\nconst savedFormData=localStorage.getItem(formDataStorageKey);if(savedFormData){try{const parsed=JSON.parse(savedFormData);return{name:parsed.name||'',price:parsed.price||'',weight:parsed.weight||'',description:parsed.description||'',category:parsed.category||defaultCategory};}catch(e){console.error('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã –∏–∑ localStorage:',e);}}// –ï—Å–ª–∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö - —Å–æ–∑–¥–∞–µ–º –ø—É—Å—Ç—É—é —Ñ–æ—Ä–º—É\nreturn{name:'',price:'',weight:'',description:'',category:defaultCategory};});const[errors,setErrors]=useState({});const[isUploading,setIsUploading]=useState(false);// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ ID —ç–ª–µ–º–µ–Ω—Ç–∞ (–Ω–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ)\nuseEffect(()=>{const isInitialMount=isInitialMountRef.current;isInitialMountRef.current=false;// –ï—Å–ª–∏ ID –∏–∑–º–µ–Ω–∏–ª—Å—è (–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ)\nif(itemIdRef.current!==itemId){itemIdRef.current=itemId;// –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã, –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –µ–≥–æ\nif(userHasUploadedRef.current&&!itemId&&uploadedImageRef.current){// –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\nsetImage(uploadedImageRef.current);return;// –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n}// –ï—Å–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç - –∑–∞–≥—Ä—É–∂–∞–µ–º –µ–≥–æ –¥–∞–Ω–Ω—ã–µ\nif(itemId&&item){// –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞–≥—Ä—É–∑–∏–ª –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏, –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –µ–≥–æ\nif(userHasUploadedRef.current&&uploadedImageRef.current){// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ\nconst storedImage=menuImagesStore&&menuImagesStore.has(formKey)?menuImagesStore.get(formKey):uploadedImageRef.current;// –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\nsetImage(storedImage);uploadedImageRef.current=storedImage;// –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ñ–æ—Ä–º—É, –Ω–æ –Ω–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\nsetFormData({name:item.name||'',price:item.price.toString().replace(' ‚ÇΩ',''),weight:item.weight||'',description:item.description||'',category:item.category||defaultCategory});}else{// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ\nuserHasUploadedRef.current=false;uploadedImageRef.current=null;setImage(item.image||'');setFormData({name:item.name||'',price:item.price.toString().replace(' ‚ÇΩ',''),weight:item.weight||'',description:item.description||'',category:item.category||defaultCategory});}}else{// –ù–æ–≤–∞—è —Ñ–æ—Ä–º–∞ - —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â–µ –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª\nif(!userHasUploadedRef.current&&!uploadedImageRef.current){setImage('');setFormData({name:'',price:'',weight:'',description:'',category:defaultCategory});}else if(uploadedImageRef.current){// –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\nsetImage(uploadedImageRef.current);}}}},[itemId,item,defaultCategory]);// –û—Ç–¥–µ–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\nuseEffect(()=>{if(isInitialMountRef.current&&!itemId&&image&&image.startsWith('data:image')){uploadedImageRef.current=image;}},[]);// –¢–æ–ª—å–∫–æ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\n// –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–±—Ä–æ—Å–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–µ\n// –≠—Ç–æ—Ç —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, –µ—Å–ª–∏ –æ–Ω–æ –±—ã–ª–æ —Å–±—Ä–æ—à–µ–Ω–æ\n// –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–æ—Ä–º (–±–µ–∑ itemId) –∏ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ (—Å itemId), –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\nuseEffect(()=>{// –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã –∏–ª–∏ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏)\nif(userHasUploadedRef.current){// –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ\nconst storedImage=menuImagesStore&&menuImagesStore.has(formKey)?menuImagesStore.get(formKey):null;if(storedImage){// –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞\nuploadedImageRef.current=storedImage;// –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–µ–∫—É—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è\nsetImage(prevImage=>{if(prevImage!==storedImage){return storedImage;}return prevImage;});return;}// –ï—Å–ª–∏ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–µ—Ç, –Ω–æ –≤ ref –µ—Å—Ç—å - –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑ ref\nif(uploadedImageRef.current){// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –±—É–¥—É—â–∏—Ö –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–æ–≤\nif(menuImagesStore&&formKey){menuImagesStore.set(formKey,uploadedImageRef.current);}// –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–µ–∫—É—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è\nsetImage(prevImage=>{if(prevImage!==uploadedImageRef.current){return uploadedImageRef.current;}return prevImage;});}}});// –ë–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π - —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ –¥–ª—è –∑–∞—â–∏—Ç—ã\nconst validateField=(name,value)=>{const newErrors=_objectSpread({},errors);switch(name){case'name':if(!value.trim())newErrors.name='–ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ';else delete newErrors.name;break;case'price':if(!value||isNaN(parseFloat(value))||parseFloat(value)<=0)newErrors.price='–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ü–µ–Ω—É';else delete newErrors.price;break;case'weight':if(!value.trim())newErrors.weight='–í–µ—Å/–æ–±—ä–µ–º –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω';else delete newErrors.weight;break;case'description':if(!value.trim())newErrors.description='–û–ø–∏—Å–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ';else delete newErrors.description;break;case'image':if(!value.trim())newErrors.image='–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ';else if(!value.startsWith('data:image')){newErrors.image='–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è';}else delete newErrors.image;break;default:break;}setErrors(newErrors);};const handleChange=e=>{const{name,value}=e.target;setFormData(prev=>{const updated=_objectSpread(_objectSpread({},prev),{},{[name]:value});// –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –≤ localStorage –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏\n// –¢–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–Ω–µ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏)\nif(!item){try{const dataToSave=_objectSpread(_objectSpread({},updated),{},{image:image// –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è\n});localStorage.setItem(formDataStorageKey,JSON.stringify(dataToSave));console.log('üíæ MenuItemForm: –î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ localStorage');}catch(e){console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã –≤ localStorage:',e);}}validateField(name,value);return updated;});};const handleFileChange=async e=>{var _e$target$files2;// –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤\nif(isProcessingFileRef.current){return;}const file=(_e$target$files2=e.target.files)===null||_e$target$files2===void 0?void 0:_e$target$files2[0];if(!file){return;}// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –æ–±—Ä–∞–±–æ—Ç–∫–∏\nisProcessingFileRef.current=true;// –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ input –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏\nconst input=e.target;// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø —Ñ–∞–π–ª–∞ (MIME-—Ç–∏–ø –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)\nif(!isImageFile(file)){onAlert('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (JPG, PNG, GIF, WEBP, BMP, SVG, HEIC –∏ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã)','error');isProcessingFileRef.current=false;return;}// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–º–∞–∫—Å–∏–º—É–º 5MB)\nif(file.size>5*1024*1024){onAlert('–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å 5MB','error');isProcessingFileRef.current=false;return;}setIsUploading(true);try{const base64=await convertFileToBase64(file);// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\nuserHasUploadedRef.current=true;uploadedImageRef.current=base64;// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ ref –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Å–±—Ä–æ—Å–∞\n// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–µ\nif(menuImagesStore&&formKey){menuImagesStore.set(formKey,base64);}// –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ\n// —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ\nsetImage(prevImage=>{// –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç, –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ–º\nif(prevImage===base64){return prevImage;}return base64;});// –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –≤ localStorage –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è\n// –¢–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–Ω–µ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏)\nif(!item){try{const dataToSave=_objectSpread(_objectSpread({},formData),{},{image:base64});localStorage.setItem(formDataStorageKey,JSON.stringify(dataToSave));console.log('üíæ handleFileChange: –î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ localStorage');}catch(e){console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã –≤ localStorage:',e);}}// –í–∞–ª–∏–¥–∞—Ü–∏—é –≤—ã–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è\nsetTimeout(()=>validateField('image',base64),0);// –û—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º –≤—ã–∑–æ–≤ onAlert, —á—Ç–æ–±—ã –¥–∞—Ç—å React –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ\nsetTimeout(()=>{// –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º onAlert\nsetImage(currentImage=>{// –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—ã–ª–æ —Å–±—Ä–æ—à–µ–Ω–æ, –Ω–æ –≤ ref –æ–Ω–æ –µ—Å—Ç—å - –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º\nif(!currentImage&&uploadedImageRef.current){return uploadedImageRef.current;}return currentImage;});// –í—ã–∑—ã–≤–∞–µ–º onAlert —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ\nonAlert('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ','success');},150);}catch(error){console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ (MenuItemForm):',error);onAlert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞','error');}finally{setIsUploading(false);// –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –æ–±—Ä–∞–±–æ—Ç–∫–∏\nisProcessingFileRef.current=false;// –û—á–∏—â–∞–µ–º input –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ—Ç –∂–µ —Ñ–∞–π–ª —Å–Ω–æ–≤–∞\nsetTimeout(()=>{if(input){input.value='';}},100);}};const handleSubmit=e=>{var _formData$name,_formData$weight,_formData$description;e.preventDefault();e.stopPropagation();// –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π\nconst newErrors={};// –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è\nif(!image||!image.trim()){newErrors.image='–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ';}else if(!image.startsWith('data:image')){newErrors.image='–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è';}// –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π\nif(!((_formData$name=formData.name)!==null&&_formData$name!==void 0&&_formData$name.trim())){newErrors.name='–ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ';}if(!formData.price||isNaN(parseFloat(formData.price))||parseFloat(formData.price)<=0){newErrors.price='–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ü–µ–Ω—É';}if(!((_formData$weight=formData.weight)!==null&&_formData$weight!==void 0&&_formData$weight.trim())){newErrors.weight='–í–µ—Å/–æ–±—ä–µ–º –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω';}if(!((_formData$description=formData.description)!==null&&_formData$description!==void 0&&_formData$description.trim())){newErrors.description='–û–ø–∏—Å–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ';}setErrors(newErrors);if(Object.keys(newErrors).length===0&&image&&image.startsWith('data:image')){// –û—á–∏—â–∞–µ–º localStorage –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏\nif(!item){try{localStorage.removeItem(formDataStorageKey);console.log('üóëÔ∏è MenuItemForm: –î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã —É–¥–∞–ª–µ–Ω—ã –∏–∑ localStorage –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');}catch(e){console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã –∏–∑ localStorage:',e);}}// –ü–µ—Ä–µ–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º\nonSave(_objectSpread(_objectSpread({},formData),{},{image:image.trim()}));}else{if(!image||!image.startsWith('data:image')){onAlert('–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ','error');}else{onAlert('–ò—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏ –≤ —Ñ–æ—Ä–º–µ','error');}}};const isFormValid=()=>{return formData.name&&formData.price&&formData.weight&&formData.description&&image&&Object.keys(errors).length===0;};return/*#__PURE__*/_jsx(\"div\",{className:\"form-modal\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:item?'–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –±–ª—é–¥–æ':'–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –±–ª—é–¥–æ'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,noValidate:true,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:formData.name,onChange:handleChange,className:errors.name?'error':'',placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0431\\u043B\\u044E\\u0434\\u0430\",required:true}),errors.name&&/*#__PURE__*/_jsx(\"span\",{className:\"error-text\",children:errors.name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0426\\u0435\\u043D\\u0430 (\\u20BD) *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"price\",value:formData.price,onChange:handleChange,className:errors.price?'error':'',placeholder:\"0\",min:\"1\",required:true}),errors.price&&/*#__PURE__*/_jsx(\"span\",{className:\"error-text\",children:errors.price})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0412\\u0435\\u0441/\\u041E\\u0431\\u044A\\u0435\\u043C *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"weight\",value:formData.weight,onChange:handleChange,className:errors.weight?'error':'',placeholder:\"150 \\u0433 \\u0438\\u043B\\u0438 500 \\u043C\\u043B\",required:true}),errors.weight&&/*#__PURE__*/_jsx(\"span\",{className:\"error-text\",children:errors.weight})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044F *\"}),/*#__PURE__*/_jsx(\"select\",{name:\"category\",value:formData.category,onChange:handleChange,children:categories.map(cat=>/*#__PURE__*/_jsx(\"option\",{value:cat.key,children:cat.name},cat.id))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435 *\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"description\",value:formData.description,onChange:handleChange,className:errors.description?'error':'',rows:\"3\",placeholder:\"\\u041E\\u043F\\u0438\\u0448\\u0438\\u0442\\u0435 \\u0431\\u043B\\u044E\\u0434\\u043E\",required:true}),errors.description&&/*#__PURE__*/_jsx(\"span\",{className:\"error-text\",children:errors.description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"file-upload-wrapper\",children:[/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\"image/*\",onChange:handleFileChange,className:\"file-input-hidden\",disabled:isUploading}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"file-upload-button\",onClick:e=>{e.preventDefault();if(fileInputRef.current){console.log('–ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ (MenuItemForm), –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª–æ–≤—ã–π –¥–∏–∞–ª–æ–≥');fileInputRef.current.click();}else{console.error('fileInputRef.current is null (MenuItemForm)');}},disabled:isUploading,children:isUploading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"upload-icon\",children:\"\\u23F3\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"upload-icon\",children:\"\\uD83D\\uDCF7\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0412\\u044B\\u0431\\u0440\\u0430\\u0442\\u044C \\u0438\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0435\"})]})}),image&&!isUploading&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"file-remove-button\",onClick:()=>{userHasUploadedRef.current=false;uploadedImageRef.current=null;// –û—á–∏—â–∞–µ–º –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞\nif(menuImagesStore&&formKey){menuImagesStore.delete(formKey);}setImage('');if(fileInputRef.current){fileInputRef.current.value='';}validateField('image','');},children:\"\\u2715\"})]}),errors.image&&/*#__PURE__*/_jsx(\"span\",{className:\"error-text\",children:errors.image})]}),image&&image.trim()&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"photo-preview-modern\",children:[/*#__PURE__*/_jsx(\"img\",{src:image,alt:\"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\",onLoad:()=>console.log('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –≤ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä (MenuItemForm)'),onError:e=>{console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä (MenuItemForm)');e.target.src='https://via.placeholder.com/300x200/8B7355/FFFFFF?text=–¢–±–∏–ª–∏—Å–∏';}},image.substring(0,50)),/*#__PURE__*/_jsx(\"div\",{className:\"photo-preview-overlay\",children:/*#__PURE__*/_jsx(\"span\",{className:\"preview-badge\",children:\"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\"})})]})]}),!image&&/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"p\",{style:{color:'#999',fontStyle:'italic',fontSize:'0.9rem'},children:\"\\u041F\\u0440\\u0435\\u0434\\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440 \\u043F\\u043E\\u044F\\u0432\\u0438\\u0442\\u0441\\u044F \\u043F\\u043E\\u0441\\u043B\\u0435 \\u0432\\u044B\\u0431\\u043E\\u0440\\u0430 \\u0444\\u0430\\u0439\\u043B\\u0430\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"save-btn\",disabled:!isFormValid(),children:item?'–û–±–Ω–æ–≤–∏—Ç—å':'–î–æ–±–∞–≤–∏—Ç—å'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"cancel-btn\",onClick:onCancel,children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"})]})]})]})});};const formatPrice=price=>{if(typeof price==='string'&&price.includes('‚ÇΩ')){return price;}const priceNum=parseInt(price);return isNaN(priceNum)?'0 ‚ÇΩ':\"\".concat(priceNum,\" \\u20BD\");};const handleImageError=e=>{e.target.src='https://via.placeholder.com/300x200/8B7355/FFFFFF?text=–¢–±–∏–ª–∏—Å–∏';};// –°—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ–º photo prop –¥–ª—è PhotoForm, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞\nconst stablePhotoForForm=useMemo(()=>{if(editingPhoto===null)return null;return editingPhoto.id?editingPhoto:null;},[editingPhoto===null||editingPhoto===void 0?void 0:editingPhoto.id]);// –ï—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –≤—Ö–æ–¥–∞\nif(!isAuthenticated){return/*#__PURE__*/_jsx(LoginForm,{onLogin:handleLogin});}return/*#__PURE__*/_jsx(\"div\",{className:\"admin-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"admin-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"admin-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0410\\u0434\\u043C\\u0438\\u043D-\\u043F\\u0430\\u043D\\u0435\\u043B\\u044C \\\"\\u0422\\u0431\\u0438\\u043B\\u0438\\u0441\\u0438\\\"\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"logout-btn\",children:\"\\u0412\\u044B\\u0439\\u0442\\u0438\"})]}),showNotification&&/*#__PURE__*/_jsxs(\"div\",{className:\"admin-notification \".concat(notificationType),children:[notificationMessage,/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowNotification(false),children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-tabs\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"tab-button \".concat(activeTab==='reservations'?'active':''),onClick:()=>handleTabChange('reservations'),children:[\"\\u0417\\u0430\\u044F\\u0432\\u043A\\u0438 (\",reservations.length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"tab-button \".concat(activeTab==='menu'?'active':''),onClick:()=>handleTabChange('menu'),children:[\"\\u041C\\u0435\\u043D\\u044E (\",menuItems.length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"tab-button \".concat(activeTab==='categories'?'active':''),onClick:()=>handleTabChange('categories'),children:[\"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438 (\",categories.length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"tab-button \".concat(activeTab==='themes'?'active':''),onClick:()=>handleTabChange('themes'),children:[\"\\u0422\\u0435\\u043C\\u044B (\",Object.keys(themes).length+1,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"tab-button \".concat(activeTab==='photos'?'active':''),onClick:()=>handleTabChange('photos'),children:[\"\\u0424\\u043E\\u0442\\u043E (\",photos.length,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"tab-content\",children:[activeTab==='reservations'&&/*#__PURE__*/_jsxs(\"div\",{className:\"reservations-tab\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0417\\u0430\\u044F\\u0432\\u043A\\u0438 \\u043D\\u0430 \\u0431\\u0440\\u043E\\u043D\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\"}),reservations.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-data\",children:\"\\u041D\\u0435\\u0442 \\u0437\\u0430\\u044F\\u0432\\u043E\\u043A \\u043D\\u0430 \\u0431\\u0440\\u043E\\u043D\\u044C\"}):/*#__PURE__*/_jsx(\"div\",{className:\"reservations-list\",children:reservations.map(reservation=>/*#__PURE__*/_jsxs(\"div\",{className:\"reservation-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"reservation-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:reservation.name}),/*#__PURE__*/_jsx(\"span\",{className:\"reservation-date\",children:new Date(reservation.createdAt).toLocaleDateString('ru-RU')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"reservation-details\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D:\"}),\" \",reservation.phone]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0414\\u0430\\u0442\\u0430:\"}),\" \",reservation.date,\" \\u0432 \",reservation.time]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0413\\u043E\\u0441\\u0442\\u0435\\u0439:\"}),\" \",reservation.guests]}),reservation.comments&&/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u041A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439:\"}),\" \",reservation.comments]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(window.confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞—è–≤–∫—É?')){deleteReservation(reservation.id);}},className:\"delete-btn\",children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]},reservation.id))})]}),activeTab==='menu'&&/*#__PURE__*/_jsxs(\"div\",{className:\"menu-tab\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"menu-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0423\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u043C\\u0435\\u043D\\u044E\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingItem({}),className:\"add-btn\",children:\"+ \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0431\\u043B\\u044E\\u0434\\u043E\"})]}),menuItems.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-data\",children:\"\\u041C\\u0435\\u043D\\u044E \\u043F\\u0443\\u0441\\u0442\\u043E. \\u0414\\u043E\\u0431\\u0430\\u0432\\u044C\\u0442\\u0435 \\u043D\\u043E\\u0432\\u044B\\u0435 \\u0431\\u043B\\u044E\\u0434\\u0430 \\u0447\\u0435\\u0440\\u0435\\u0437 \\u0444\\u043E\\u0440\\u043C\\u0443 \\u0432\\u044B\\u0448\\u0435.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"menu-items-grid\",children:menuItems.map(item=>{var _categories$find;return/*#__PURE__*/_jsxs(\"div\",{className:\"menu-item-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-image\",children:/*#__PURE__*/_jsx(\"img\",{src:item.image,alt:item.name,onError:handleImageError})}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-content\",children:[/*#__PURE__*/_jsx(\"h4\",{children:item.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"item-price\",children:[formatPrice(item.price),\" \\xB7 \",item.weight]}),/*#__PURE__*/_jsx(\"p\",{className:\"item-description\",children:item.description}),/*#__PURE__*/_jsx(\"p\",{className:\"item-category\",children:((_categories$find=categories.find(cat=>cat.key===item.category))===null||_categories$find===void 0?void 0:_categories$find.name)||item.category})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>startEditing(item),className:\"edit-btn\",children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(window.confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ –±–ª—é–¥–æ?')){deleteMenuItem(item.id);}},className:\"delete-btn\",children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]})]},item.id);})})]}),activeTab==='categories'&&/*#__PURE__*/_jsxs(\"div\",{className:\"categories-tab\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"categories-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0423\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044F\\u043C\\u0438\"}),/*#__PURE__*/_jsx(\"button\",{onClick:addCategory,className:\"add-btn\",children:\"+ \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044E\"})]}),categories.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-data\",children:\"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0439 \\u043D\\u0435\\u0442. \\u0414\\u043E\\u0431\\u0430\\u0432\\u044C\\u0442\\u0435 \\u043D\\u043E\\u0432\\u0443\\u044E \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044E.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"categories-list\",children:categories.map((category,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"category-card\",children:editingCategory&&editingCategory.id===category.id?/*#__PURE__*/_jsxs(\"div\",{className:\"category-edit-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editingCategory.name,onChange:e=>setEditingCategory(_objectSpread(_objectSpread({},editingCategory),{},{name:e.target.value})),className:\"category-name-input\",placeholder:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438\",autoFocus:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"category-edit-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>updateCategory(editingCategory),className:\"save-btn\",children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingCategory(null),className:\"cancel-btn\",children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"category-info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:category.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"category-key\",children:[\"\\u041A\\u043B\\u044E\\u0447: \",category.key]}),/*#__PURE__*/_jsxs(\"p\",{className:\"category-order\",children:[\"\\u041F\\u043E\\u0440\\u044F\\u0434\\u043E\\u043A: \",category.order]}),/*#__PURE__*/_jsxs(\"p\",{className:\"category-items-count\",children:[\"\\u0411\\u043B\\u044E\\u0434 \\u0432 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438: \",menuItems.filter(item=>item.category===category.key).length]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"category-actions\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"category-order-controls\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>moveCategory(category.id,'up'),className:\"move-btn\",disabled:index===0,title:\"\\u041F\\u0435\\u0440\\u0435\\u043C\\u0435\\u0441\\u0442\\u0438\\u0442\\u044C \\u0432\\u0432\\u0435\\u0440\\u0445\",children:\"\\u2191\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>moveCategory(category.id,'down'),className:\"move-btn\",disabled:index===categories.length-1,title:\"\\u041F\\u0435\\u0440\\u0435\\u043C\\u0435\\u0441\\u0442\\u0438\\u0442\\u044C \\u0432\\u043D\\u0438\\u0437\",children:\"\\u2193\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingCategory(_objectSpread({},category)),className:\"edit-btn\",children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(window.confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é?')){deleteCategory(category.id);}},className:\"delete-btn\",children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]})]})},category.id))})]}),activeTab==='themes'&&/*#__PURE__*/_jsxs(\"div\",{className:\"themes-tab\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"themes-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0423\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u0442\\u0435\\u043C\\u0430\\u043C\\u0438\"}),/*#__PURE__*/_jsx(\"button\",{onClick:addTheme,className:\"add-btn\",children:\"+ \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0442\\u0435\\u043C\\u0443\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"themes-list\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"theme-card \".concat(currentTheme==='default'?'active':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"theme-preview\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"theme-preview-colors\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"preview-color\",style:{background:'#8B7355'}}),/*#__PURE__*/_jsx(\"div\",{className:\"preview-color\",style:{background:'#A8D8EA'}}),/*#__PURE__*/_jsx(\"div\",{className:\"preview-color\",style:{background:'#D4B896'}})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"theme-info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u041F\\u043E \\u0443\\u043C\\u043E\\u043B\\u0447\\u0430\\u043D\\u0438\\u044E\"}),/*#__PURE__*/_jsx(\"p\",{className:\"theme-description\",children:\"\\u0411\\u0430\\u0437\\u043E\\u0432\\u0430\\u044F \\u0437\\u0435\\u043C\\u043B\\u044F\\u043D\\u0430\\u044F \\u0442\\u0435\\u043C\\u0430\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"theme-actions\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>applyTheme('default'),className:\"apply-btn \".concat(currentTheme==='default'?'active':''),children:currentTheme==='default'?'‚úì –ü—Ä–∏–º–µ–Ω–µ–Ω–∞':'–ü—Ä–∏–º–µ–Ω–∏—Ç—å'})})]}),Object.values(defaultThemes).map(theme=>/*#__PURE__*/_jsxs(\"div\",{className:\"theme-card \".concat(currentTheme===theme.id?'active':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"theme-preview\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"theme-preview-colors\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"preview-color\",style:{background:theme.primaryColor}}),/*#__PURE__*/_jsx(\"div\",{className:\"preview-color\",style:{background:theme.secondaryColor}}),/*#__PURE__*/_jsx(\"div\",{className:\"preview-color\",style:{background:theme.accentColor}})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"theme-info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:theme.name}),/*#__PURE__*/_jsx(\"p\",{className:\"theme-description\",children:\"\\u0411\\u0430\\u0437\\u043E\\u0432\\u0430\\u044F \\u0442\\u0435\\u043C\\u0430\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"theme-actions\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>applyTheme(theme.id),className:\"apply-btn \".concat(currentTheme===theme.id?'active':''),children:currentTheme===theme.id?'‚úì –ü—Ä–∏–º–µ–Ω–µ–Ω–∞':'–ü—Ä–∏–º–µ–Ω–∏—Ç—å'})})]},theme.id)),Object.values(themes).filter(theme=>!defaultThemes[theme.id]).map(theme=>/*#__PURE__*/_jsx(\"div\",{className:\"theme-card \".concat(currentTheme===theme.id?'active':''),children:editingTheme&&editingTheme.id===theme.id?/*#__PURE__*/_jsx(ThemeEditForm,{theme:editingTheme,onSave:updateTheme,onCancel:()=>setEditingTheme(null)}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"theme-preview\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"theme-preview-colors\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"preview-color\",style:{background:theme.primaryColor}}),/*#__PURE__*/_jsx(\"div\",{className:\"preview-color\",style:{background:theme.secondaryColor}}),/*#__PURE__*/_jsx(\"div\",{className:\"preview-color\",style:{background:theme.accentColor}})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"theme-info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:theme.name}),/*#__PURE__*/_jsx(\"p\",{className:\"theme-description\",children:\"\\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C\\u0441\\u043A\\u0430\\u044F \\u0442\\u0435\\u043C\\u0430\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"theme-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>applyTheme(theme.id),className:\"apply-btn \".concat(currentTheme===theme.id?'active':''),children:currentTheme===theme.id?'‚úì –ü—Ä–∏–º–µ–Ω–µ–Ω–∞':'–ü—Ä–∏–º–µ–Ω–∏—Ç—å'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingTheme(_objectSpread({},theme)),className:\"edit-btn\",children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"}),!defaultThemes[theme.id]&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(window.confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ç–µ–º—É?')){deleteTheme(theme.id);}},className:\"delete-btn\",children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]})]})},theme.id))]})]}),activeTab==='photos'&&/*#__PURE__*/_jsxs(\"div\",{className:\"photos-tab\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"photos-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0423\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u0444\\u043E\\u0442\\u043E\\u0433\\u0440\\u0430\\u0444\\u0438\\u044F\\u043C\\u0438\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{// –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã\nsetEditingPhoto(newPhotoObjectRef.current);},className:\"add-btn\",children:\"+ \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0444\\u043E\\u0442\\u043E\"})]}),photos.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-data\",children:\"\\u0424\\u043E\\u0442\\u043E\\u0433\\u0440\\u0430\\u0444\\u0438\\u0439 \\u043D\\u0435\\u0442. \\u0414\\u043E\\u0431\\u0430\\u0432\\u044C\\u0442\\u0435 \\u043D\\u043E\\u0432\\u0443\\u044E \\u0444\\u043E\\u0442\\u043E\\u0433\\u0440\\u0430\\u0444\\u0438\\u044E.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"photos-grid\",children:photos.map(photo=>/*#__PURE__*/_jsxs(\"div\",{className:\"photo-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"photo-image\",children:/*#__PURE__*/_jsx(\"img\",{src:photo.image,alt:photo.caption||'–§–æ—Ç–æ',onError:e=>{e.target.src='https://via.placeholder.com/300x200/8B7355/FFFFFF?text=–¢–±–∏–ª–∏—Å–∏';}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"photo-info\",children:[photo.caption&&/*#__PURE__*/_jsx(\"p\",{className:\"photo-caption\",children:photo.caption}),!photo.caption&&/*#__PURE__*/_jsx(\"p\",{className:\"photo-caption-empty\",children:\"\\u0411\\u0435\\u0437 \\u043F\\u043E\\u0434\\u043F\\u0438\\u0441\\u0438\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"photo-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingPhoto(_objectSpread({},photo)),className:\"edit-btn\",children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(window.confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ —Ñ–æ—Ç–æ?')){deletePhoto(photo.id);}},className:\"delete-btn\",children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]})]},photo.id))})]})]}),editingItem!==null&&/*#__PURE__*/_jsx(MenuItemForm,{// –°—Ç–∞–±–∏–ª—å–Ω—ã–π key\nitem:editingItem.id?editingItem:null,onSave:saveMenuItem,onCancel:cancelEditing,onAlert:showAlert,menuImagesStore:menuImagesStore.current// –ü–µ—Ä–µ–¥–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è\n,formKey:(editingItem===null||editingItem===void 0?void 0:editingItem.id)||newMenuItemKeyRef.current// –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á —Ñ–æ—Ä–º—ã\n},(editingItem===null||editingItem===void 0?void 0:editingItem.id)||newMenuItemKeyRef.current),editingPhoto!==null&&/*#__PURE__*/_jsx(PhotoForm,{// –°—Ç–∞–±–∏–ª—å–Ω—ã–π key\nphoto:stablePhotoForForm,onSave:savePhoto,onCancel:cancelPhotoEditing,onAlert:showAlert,uploadedImagesStore:uploadedImagesStore.current// –ü–µ—Ä–µ–¥–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è\n,formKey:(editingPhoto===null||editingPhoto===void 0?void 0:editingPhoto.id)||newPhotoKeyRef.current// –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á —Ñ–æ—Ä–º—ã\n},(editingPhoto===null||editingPhoto===void 0?void 0:editingPhoto.id)||newPhotoKeyRef.current)]})});};export default Admin;","map":{"version":3,"names":["React","useState","useEffect","useRef","useMemo","useCallback","autoSaveReservations","autoSaveMenu","autoSavePhotos","loadTheme","loadMenu","loadReservations","loadCategories","loadPhotos","saveTheme","saveCategories","defaultMenu","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","defaultCategories","id","key","name","order","defaultThemes","elegant","primaryColor","primaryLight","primaryDark","secondaryColor","secondaryLight","secondaryDark","accentColor","backgroundColor","textColor","textLight","Admin","generateUniqueId","existingItems","newId","attempts","maxAttempts","Date","now","Math","floor","random","exists","some","item","console","warn","isAuthenticated","setIsAuthenticated","localStorage","getItem","activeTab","setActiveTab","reservations","setReservations","menuItems","setMenuItems","categories","setCategories","themes","setThemes","currentTheme","setCurrentTheme","photos","setPhotos","editingItem","setEditingItem","editingCategory","setEditingCategory","editingTheme","setEditingTheme","editingPhoto","setEditingPhoto","newPhotoKeyRef","concat","newPhotoObjectRef","uploadedImagesStore","Map","newMenuItemKeyRef","menuImagesStore","showNotification","setShowNotification","notificationMessage","setNotificationMessage","notificationType","setNotificationType","handleTabChange","tab","formKey","current","has","delete","loadCategoriesFromFile","loadedCategories","Array","isArray","sorted","sort","a","b","log","length","stored","parsed","JSON","parse","e","error","loadReservationsFromFile","loadedReservations","loadMenuItemsFromFile","loadedMenu","metadataStr","metadata","loadThemesFromFile","themeData","allThemes","_objectSpread","currentThemeId","applyThemeOnLoad","themeId","themesToUse","arguments","undefined","document","documentElement","className","root","style","removeProperty","theme","setProperty","loadPhotosFromFile","loadedPhotos","saveCategoriesToFile","updatedCategories","saveResult","success","showAlert","message","addCategory","newCategory","updated","updateCategory","category","trim","map","cat","deleteCategory","categoryToDelete","find","itemsInCategory","filter","forEach","index","moveCategory","direction","findIndex","newIndex","type","setTimeout","handleLogin","username","password","setItem","handleLogout","removeItem","applyTheme","saveThemes","updatedThemes","hexToRgb","hex","result","exec","r","parseInt","g","rgbToHex","x","toString","join","lightenColor","percent","rgb","min","round","darkenColor","max","addTheme","basePrimaryColor","newTheme","updateTheme","updatedTheme","deleteTheme","deleteReservation","res","deleteMenuItem","itemToDelete","hasImage","image","startsWith","imageSize","cancelPhotoEditing","savePhoto","photo","hasValidImage","oldPhoto","p","imageChanged","caption","oldImageSize","newImageSize","newPhoto","validPhotos","deletePhoto","photoToDelete","validateMenuItem","price","isNaN","parseFloat","weight","description","saveMenuItem","imageLength","imageStart","substring","formattedItem","replace","updatedItems","oldItem","mi","menuItem","newItem","startEditing","cancelEditing","formDataStorageKey","ThemeEditForm","_ref","onSave","onCancel","formData","setFormData","hexToRgbLocal","rgbToHexLocal","lightenColorLocal","darkenColorLocal","handleChange","field","value","handleSubmit","preventDefault","colorFields","label","children","onSubmit","onChange","target","placeholder","required","background","onClick","isImageFile","file","imageExtensions","fileName","toLowerCase","extension","split","pop","includes","convertFileToBase64","Promise","resolve","reject","reader","FileReader","onload","onerror","readAsDataURL","LoginForm","_ref2","onLogin","setUsername","setPassword","setError","htmlFor","autoFocus","PhotoForm","_ref3","onAlert","photoId","photoIdRef","isInitialMountRef","setImage","get","setCaption","isUploading","setIsUploading","isDragging","setIsDragging","fileInputRef","userHasUploadedRef","uploadedImageRef","isProcessingFileRef","isInitialMount","storedImage","set","processFile","size","base64","prevImage","currentImage","handleFileChange","_e$target$files","files","input","handleDragOver","stopPropagation","handleDragLeave","handleDrop","_e$dataTransfer$files","dataTransfer","photoData","noValidate","onDragOver","onDragLeave","onDrop","ref","accept","disabled","click","src","alt","onError","color","fontStyle","fontSize","MenuItemForm","_ref4","defaultCategory","itemId","itemIdRef","savedFormData","errors","setErrors","validateField","newErrors","prev","dataToSave","stringify","_e$target$files2","_formData$name","_formData$weight","_formData$description","Object","keys","isFormValid","rows","onLoad","formatPrice","priceNum","handleImageError","stablePhotoForForm","reservation","createdAt","toLocaleDateString","phone","date","time","guests","comments","window","confirm","_categories$find","title","values"],"sources":["C:/restaurant-website (2)/restaurant-website/Backend/ClientApp/src/pages/Admin.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useMemo, useCallback } from 'react';\nimport './Admin.css';\nimport { \n  autoSaveReservations, \n  autoSaveMenu, \n  autoSavePhotos, \n  loadTheme, \n  loadMenu, \n  loadReservations, \n  loadCategories,\n  loadPhotos,\n  saveTheme,\n  saveCategories\n} from '../utils/fileStorage';\nimport { defaultMenu } from '../data/defaultMenu';\n\n// –ë–∞–∑–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\nconst defaultCategories = [\n  { id: 1, key: 'cold', name: '–•–æ–ª–æ–¥–Ω—ã–µ –∑–∞–∫—É—Å–∫–∏', order: 1 },\n  { id: 2, key: 'salads', name: '–°–∞–ª–∞—Ç—ã', order: 2 },\n  { id: 3, key: 'hot', name: '–ì–æ—Ä—è—á–∏–µ –±–ª—é–¥–∞', order: 3 },\n  { id: 4, key: 'drinks', name: '–ù–∞–ø–∏—Ç–∫–∏', order: 4 }\n];\n\n// –ë–∞–∑–æ–≤—ã–µ —Ç–µ–º—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\nconst defaultThemes = {\n  elegant: {\n    id: 'elegant',\n    name: '–≠–ª–µ–≥–∞–Ω—Ç–Ω–∞—è —Å–∏–Ω—è—è',\n    primaryColor: '#2C3E50',\n    primaryLight: '#34495E',\n    primaryDark: '#1C2833',\n    secondaryColor: '#3498DB',\n    secondaryLight: '#5DADE2',\n    secondaryDark: '#2980B9',\n    accentColor: '#E74C3C',\n    backgroundColor: '#ECF0F1',\n    textColor: '#2C3E50',\n    textLight: '#566573'\n  }\n};\n\nconst Admin = () => {\n  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ ID\n  const generateUniqueId = (existingItems) => {\n    let newId;\n    let attempts = 0;\n    const maxAttempts = 100;\n    \n    do {\n      // –ò—Å–ø–æ–ª—å–∑—É–µ–º timestamp + —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏\n      newId = Date.now() + Math.floor(Math.random() * 1000);\n      attempts++;\n      \n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ç–∞–∫–æ–≥–æ ID –Ω–µ—Ç –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–∞—Ö\n      const exists = existingItems.some(item => item.id === newId);\n      if (!exists) {\n        return newId;\n      }\n    } while (attempts < maxAttempts);\n    \n    // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞ 100 –ø–æ–ø—ã—Ç–æ–∫, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Å—Ç–æ timestamp\n    console.warn('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞ 100 –ø–æ–ø—ã—Ç–æ–∫, –∏—Å–ø–æ–ª—å–∑—É–µ–º timestamp');\n    return Date.now();\n  };\n\n  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∏–∑ localStorage –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ\n  const [isAuthenticated, setIsAuthenticated] = useState(() => {\n    return localStorage.getItem('admin-authenticated') === 'true';\n  });\n  \n  const [activeTab, setActiveTab] = useState('reservations');\n  const [reservations, setReservations] = useState([]);\n  const [menuItems, setMenuItems] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [themes, setThemes] = useState({});\n  const [currentTheme, setCurrentTheme] = useState('default');\n  const [photos, setPhotos] = useState([]);\n  const [editingItem, setEditingItem] = useState(null);\n  const [editingCategory, setEditingCategory] = useState(null);\n  const [editingTheme, setEditingTheme] = useState(null);\n  const [editingPhoto, setEditingPhoto] = useState(null);\n  const newPhotoKeyRef = useRef(`new-photo-${Date.now()}`); // –°—Ç–∞–±–∏–ª—å–Ω—ã–π key –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã\n  const newPhotoObjectRef = useRef({}); // –°—Ç–∞–±–∏–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã\n  // –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–≤–Ω–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, —á—Ç–æ–±—ã –Ω–µ —Ç–µ—Ä—è—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–µ)\n  const uploadedImagesStore = useRef(new Map()); // key -> base64 image\n  const newMenuItemKeyRef = useRef(`new-menu-item-${Date.now()}`); // –°—Ç–∞–±–∏–ª—å–Ω—ã–π key –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã –º–µ–Ω—é\n  // –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–µ–Ω—é\n  const menuImagesStore = useRef(new Map()); // key -> base64 image\n  const [showNotification, setShowNotification] = useState(false);\n  const [notificationMessage, setNotificationMessage] = useState('');\n  const [notificationType, setNotificationType] = useState('success');\n\n  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫ —Å –∑–∞–∫—Ä—ã—Ç–∏–µ–º –≤—Å–µ—Ö –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω\n  const handleTabChange = (tab) => {\n    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞\n    // –û—á–∏—â–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –≤–∫–ª–∞–¥–æ–∫\n    if (editingItem) {\n      const formKey = editingItem?.id || newMenuItemKeyRef.current;\n      if (menuImagesStore.current.has(formKey)) {\n        menuImagesStore.current.delete(formKey);\n      }\n    }\n    setEditingItem(null);\n    setEditingCategory(null);\n    setEditingTheme(null);\n    if (editingPhoto) {\n      const formKey = editingPhoto?.id || newPhotoKeyRef.current;\n      if (uploadedImagesStore.current.has(formKey)) {\n        uploadedImagesStore.current.delete(formKey);\n      }\n    }\n    setEditingPhoto(null);\n    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –≤–∫–ª–∞–¥–∫—É\n    setActiveTab(tab);\n  };\n\n  useEffect(() => {\n    const loadCategoriesFromFile = async () => {\n      try {\n        const loadedCategories = await loadCategories();\n        if (Array.isArray(loadedCategories)) {\n          // –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ - —ç—Ç–æ –≤–∞–ª–∏–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–∏–ª –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)\n          // –ù–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –µ—Å–ª–∏ –º–∞—Å—Å–∏–≤ –ø—Ä–æ—Å—Ç–æ –ø—É—Å—Ç–æ–π\n          const sorted = [...loadedCategories].sort((a, b) => a.order - b.order);\n          setCategories(sorted);\n          console.log(`üì• loadCategoriesFromFile: –ó–∞–≥—Ä—É–∂–µ–Ω–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: ${sorted.length}`);\n        } else {\n          // –ï—Å–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –º–∞—Å—Å–∏–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ\n          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ localStorage\n          const stored = localStorage.getItem('restaurant-categories');\n          if (stored) {\n            try {\n              const parsed = JSON.parse(stored);\n              if (Array.isArray(parsed)) {\n                // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö (–¥–∞–∂–µ –µ—Å–ª–∏ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤)\n                console.warn('‚ö†Ô∏è loadCategoriesFromFile: –î–∞–Ω–Ω—ã–µ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º, –Ω–æ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤.');\n                setCategories([]);\n              } else {\n                // –ï—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –º–∞—Å—Å–∏–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏\n                console.log('üì• loadCategoriesFromFile: –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –º–∞—Å—Å–∏–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏');\n                setCategories([...defaultCategories]);\n              }\n            } catch (e) {\n              // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏\n              console.log('üì• loadCategoriesFromFile: –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏');\n              setCategories([...defaultCategories]);\n            }\n          } else {\n            // –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–ø–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞), –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏\n            console.log('üì• loadCategoriesFromFile: –ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏');\n            setCategories([...defaultCategories]);\n          }\n        }\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:', error);\n        // –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏\n        const stored = localStorage.getItem('restaurant-categories');\n        if (stored) {\n          try {\n            const parsed = JSON.parse(stored);\n            if (Array.isArray(parsed)) {\n              // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö (–¥–∞–∂–µ –µ—Å–ª–∏ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤)\n              console.warn('‚ö†Ô∏è loadCategoriesFromFile: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏, –Ω–æ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤.');\n              setCategories([]);\n            } else {\n              console.log('üì• loadCategoriesFromFile: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –º–∞—Å—Å–∏–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏');\n              setCategories([...defaultCategories]);\n            }\n          } catch (e) {\n            console.log('üì• loadCategoriesFromFile: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏');\n            setCategories([...defaultCategories]);\n          }\n        } else {\n          // –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏\n          console.log('üì• loadCategoriesFromFile: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏');\n          setCategories([...defaultCategories]);\n        }\n      }\n    };\n\n    const loadReservationsFromFile = async () => {\n      try {\n        const loadedReservations = await loadReservations();\n        setReservations(loadedReservations);\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫:', error);\n        setReservations([]);\n      }\n    };\n\n    const loadMenuItemsFromFile = async () => {\n      try {\n        const loadedMenu = await loadMenu();\n        if (Array.isArray(loadedMenu)) {\n          // –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ - —ç—Ç–æ –≤–∞–ª–∏–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–∏–ª –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏)\n          // –ù–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é, –µ—Å–ª–∏ –º–∞—Å—Å–∏–≤ –ø—Ä–æ—Å—Ç–æ –ø—É—Å—Ç–æ–π\n          setMenuItems(loadedMenu);\n          console.log(`üì• loadMenuItemsFromFile: –ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø–æ–∑–∏—Ü–∏–π: ${loadedMenu.length}`);\n        } else {\n          // –ï—Å–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –º–∞—Å—Å–∏–≤, –ø—Ä–æ–≤–µ—Ä—è–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ\n          // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º –º–∞—Å—Å–∏–≤–æ–º \"[]\", —á—Ç–æ —Ç–æ–∂–µ –≤–∞–ª–∏–¥–Ω–æ\n          const metadataStr = localStorage.getItem('restaurant-menu-metadata');\n          if (metadataStr) {\n            try {\n              const metadata = JSON.parse(metadataStr);\n              // –ï—Å–ª–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç (–¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤), –∑–Ω–∞—á–∏—Ç –º–µ–Ω—é –±—ã–ª–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ\n              // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤, –∞ –Ω–µ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é\n              console.warn('‚ö†Ô∏è loadMenuItemsFromFile: –î–∞–Ω–Ω—ã–µ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º, –Ω–æ –µ—Å—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ. –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤.');\n              setMenuItems([]);\n            } catch (e) {\n              // –ï—Å–ª–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é\n              console.log('üì• loadMenuItemsFromFile: –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é');\n              setMenuItems([...defaultMenu]);\n            }\n          } else {\n            // –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (–ø–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞), –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é\n            console.log('üì• loadMenuItemsFromFile: –ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é');\n            setMenuItems([...defaultMenu]);\n          }\n        }\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–Ω—é:', error);\n        // –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ\n        const metadataStr = localStorage.getItem('restaurant-menu-metadata');\n        if (metadataStr) {\n          try {\n            const metadata = JSON.parse(metadataStr);\n            // –ï—Å–ª–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç, –∑–Ω–∞—á–∏—Ç –º–µ–Ω—é –±—ã–ª–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤\n            console.warn('‚ö†Ô∏è loadMenuItemsFromFile: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏, –Ω–æ –µ—Å—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ. –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤.');\n            setMenuItems([]);\n          } catch (e) {\n            // –ï—Å–ª–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é\n            console.log('üì• loadMenuItemsFromFile: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é');\n            setMenuItems([...defaultMenu]);\n          }\n        } else {\n          // –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é\n          console.log('üì• loadMenuItemsFromFile: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –Ω–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –º–µ–Ω—é');\n          setMenuItems([...defaultMenu]);\n        }\n      }\n    };\n\n    const loadThemesFromFile = async () => {\n      try {\n        const themeData = await loadTheme();\n        // –û–±—ä–µ–¥–∏–Ω—è–µ–º –±–∞–∑–æ–≤—ã–µ —Ç–µ–º—ã —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏\n        const allThemes = { ...defaultThemes, ...themeData.themes };\n        setThemes(allThemes);\n        \n        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â—É—é —Ç–µ–º—É\n        const currentThemeId = themeData.currentTheme || 'default';\n        setCurrentTheme(currentThemeId);\n        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ç–µ–º\n        applyThemeOnLoad(currentThemeId, allThemes);\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ–º:', error);\n        setThemes(defaultThemes);\n        setCurrentTheme('default');\n        applyThemeOnLoad('default', defaultThemes);\n      }\n    };\n\n    const applyThemeOnLoad = (themeId, themesToUse = null) => {\n      // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ —Ç–µ–º—ã –∏–ª–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è\n      const allThemes = themesToUse || { ...defaultThemes, ...themes };\n      \n      if (themeId === 'default') {\n        document.documentElement.className = '';\n        const root = document.documentElement;\n        root.style.removeProperty('--primary-color');\n        root.style.removeProperty('--primary-light');\n        root.style.removeProperty('--primary-dark');\n        root.style.removeProperty('--secondary-color');\n        root.style.removeProperty('--secondary-light');\n        root.style.removeProperty('--secondary-dark');\n        root.style.removeProperty('--accent-color');\n        root.style.removeProperty('--background-color');\n        root.style.removeProperty('--text-color');\n        root.style.removeProperty('--text-light');\n        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω html –≤ —Ü–≤–µ—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\n        document.documentElement.style.backgroundColor = '#8B7355';\n        return;\n      }\n      \n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–∑–æ–≤—ã–µ —Ç–µ–º—ã\n      if (defaultThemes[themeId]) {\n        const theme = defaultThemes[themeId];\n        const root = document.documentElement;\n        root.style.setProperty('--primary-color', theme.primaryColor);\n        root.style.setProperty('--primary-light', theme.primaryLight);\n        root.style.setProperty('--primary-dark', theme.primaryDark);\n        root.style.setProperty('--secondary-color', theme.secondaryColor);\n        root.style.setProperty('--secondary-light', theme.secondaryLight);\n        root.style.setProperty('--secondary-dark', theme.secondaryDark);\n        root.style.setProperty('--accent-color', theme.accentColor);\n        root.style.setProperty('--background-color', theme.backgroundColor);\n        root.style.setProperty('--text-color', theme.textColor);\n        root.style.setProperty('--text-light', theme.textLight);\n        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω html –¥–ª—è overscroll\n        document.documentElement.style.backgroundColor = theme.primaryColor;\n        return;\n      }\n      \n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ç–µ–º—ã\n      const theme = allThemes[themeId];\n      if (theme) {\n        const root = document.documentElement;\n        root.style.setProperty('--primary-color', theme.primaryColor);\n        root.style.setProperty('--primary-light', theme.primaryLight);\n        root.style.setProperty('--primary-dark', theme.primaryDark);\n        root.style.setProperty('--secondary-color', theme.secondaryColor);\n        root.style.setProperty('--secondary-light', theme.secondaryLight);\n        root.style.setProperty('--secondary-dark', theme.secondaryDark);\n        root.style.setProperty('--accent-color', theme.accentColor);\n        root.style.setProperty('--background-color', theme.backgroundColor);\n        root.style.setProperty('--text-color', theme.textColor);\n        root.style.setProperty('--text-light', theme.textLight);\n        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω html –¥–ª—è overscroll\n        document.documentElement.style.backgroundColor = theme.primaryColor;\n      }\n    };\n\n    const loadPhotosFromFile = async () => {\n        try {\n        const loadedPhotos = await loadPhotos();\n        if (Array.isArray(loadedPhotos) && loadedPhotos.length > 0) {\n          setPhotos(loadedPhotos);\n        } else {\n          setPhotos([]);\n          }\n        } catch (error) {\n          console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π:', error);\n      setPhotos([]);\n      }\n    };\n\n    loadCategoriesFromFile();\n    loadReservationsFromFile();\n    loadMenuItemsFromFile();\n    loadThemesFromFile();\n    loadPhotosFromFile();\n  }, []);\n\n  const saveCategoriesToFile = async (updatedCategories) => {\n    // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –ø–æ—Ä—è–¥–∫—É –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º\n    const sorted = [...updatedCategories].sort((a, b) => a.order - b.order);\n    setCategories(sorted);\n    const saveResult = await saveCategories(sorted);\n    if (!saveResult.success) {\n      showAlert(`–û—à–∏–±–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: ${saveResult.message}`, 'error');\n    } else {\n      showAlert('–§–∞–π–ª categories.json —Å–∫–∞—á–∞–Ω', 'success');\n    }\n  };\n\n  const addCategory = async () => {\n    const newCategory = {\n      id: Date.now(),\n      key: `category_${Date.now()}`,\n      name: '–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è',\n      order: categories.length + 1\n    };\n    const updated = [...categories, newCategory];\n    await saveCategoriesToFile(updated);\n    setEditingCategory(newCategory);\n    showAlert('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞', 'success');\n  };\n\n  const updateCategory = async (category) => {\n    if (!category.name || !category.name.trim()) {\n      showAlert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏', 'error');\n      return;\n    }\n    const updated = categories.map(cat => \n      cat.id === category.id ? category : cat\n    );\n    await saveCategoriesToFile(updated);\n    setEditingCategory(null);\n    showAlert('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞', 'success');\n  };\n\n  const deleteCategory = async (id) => {\n    // –ù–∞—Ö–æ–¥–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (–¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è)\n    const categoryToDelete = categories.find(cat => cat.id === id);\n    if (categoryToDelete) {\n      console.log('üóëÔ∏è deleteCategory: –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:', {\n        id: categoryToDelete.id,\n        name: categoryToDelete.name,\n        key: categoryToDelete.key\n      });\n    }\n    \n    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –≤ –±–ª—é–¥–∞—Ö\n    const category = categories.find(cat => cat.id === id);\n    if (category) {\n      const itemsInCategory = menuItems.filter(item => item.category === category.key);\n      if (itemsInCategory.length > 0) {\n        showAlert(`–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é: –≤ –Ω–µ–π –µ—Å—Ç—å ${itemsInCategory.length} –±–ª—é–¥(–∞)`, 'error');\n        return;\n      }\n    }\n    \n    // –£–¥–∞–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–∑ –º–∞—Å—Å–∏–≤–∞\n    const updated = categories.filter(cat => cat.id !== id);\n    console.log(`üóëÔ∏è deleteCategory: –û—Å—Ç–∞–ª–æ—Å—å –∫–∞—Ç–µ–≥–æ—Ä–∏–π: ${updated.length}`);\n    \n    // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Ä—è–¥–æ–∫ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π\n    updated.forEach((cat, index) => {\n      cat.order = index + 1;\n    });\n    \n    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ (–¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω –ø—É—Å—Ç–æ–π)\n    await saveCategoriesToFile(updated);\n    \n    if (updated.length === 0) {\n      console.log('‚úÖ deleteCategory: –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É–¥–∞–ª–µ–Ω—ã, –º–∞—Å—Å–∏–≤ –ø—É—Å—Ç–æ–π');\n    } else {\n      console.log('‚úÖ deleteCategory: –ö–∞—Ç–µ–≥–æ—Ä–∏—è —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞');\n    }\n    \n    showAlert('–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É–¥–∞–ª–µ–Ω–∞', 'success');\n  };\n\n  const moveCategory = async (id, direction) => {\n    const index = categories.findIndex(cat => cat.id === id);\n    if (index === -1) return;\n    \n    const newIndex = direction === 'up' ? index - 1 : index + 1;\n    if (newIndex < 0 || newIndex >= categories.length) return;\n    \n    const updated = [...categories];\n    [updated[index].order, updated[newIndex].order] = [updated[newIndex].order, updated[index].order];\n    await saveCategoriesToFile(updated);\n  };\n\n  const showAlert = useCallback((message, type = 'success') => {\n    setNotificationMessage(message);\n    setNotificationType(type);\n    setShowNotification(true);\n    setTimeout(() => setShowNotification(false), 4000);\n  }, []);\n\n  // –§—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n  const handleLogin = (username, password) => {\n    if (username === 'admin' && password === 'Tbil4dSokol') {\n      setIsAuthenticated(true);\n      localStorage.setItem('admin-authenticated', 'true');\n      showAlert('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å!', 'success');\n      return true;\n    } else {\n      showAlert('–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å', 'error');\n      return false;\n    }\n  };\n\n  // –§—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞\n  const handleLogout = () => {\n    setIsAuthenticated(false);\n    localStorage.removeItem('admin-authenticated');\n    showAlert('–í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏', 'success');\n  };\n\n  // –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–º–∞–º–∏\n  const applyTheme = async (themeId) => {\n    setCurrentTheme(themeId);\n    \n    if (themeId === 'default') {\n      document.documentElement.className = '';\n      const root = document.documentElement;\n      root.style.removeProperty('--primary-color');\n      root.style.removeProperty('--primary-light');\n      root.style.removeProperty('--primary-dark');\n      root.style.removeProperty('--secondary-color');\n      root.style.removeProperty('--secondary-light');\n      root.style.removeProperty('--secondary-dark');\n      root.style.removeProperty('--accent-color');\n      root.style.removeProperty('--background-color');\n      root.style.removeProperty('--text-color');\n      root.style.removeProperty('--text-light');\n      // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–º—É –≤ —Ñ–∞–π–ª\n      const saveResult = await saveTheme({ currentTheme: themeId, themes: themes });\n      if (saveResult.success) {\n        showAlert('–¢–µ–º–∞ \"–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é\" –ø—Ä–∏–º–µ–Ω–µ–Ω–∞. –§–∞–π–ª theme.json —Å–∫–∞—á–∞–Ω.', 'success');\n      } else {\n        showAlert(`–¢–µ–º–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞, –Ω–æ —Ñ–∞–π–ª –Ω–µ —Å–∫–∞—á–∞–Ω: ${saveResult.message}`, 'error');\n      }\n      return;\n    }\n    \n    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–∑–æ–≤—ã–µ —Ç–µ–º—ã\n    if (defaultThemes[themeId]) {\n      const theme = defaultThemes[themeId];\n      const root = document.documentElement;\n      root.style.setProperty('--primary-color', theme.primaryColor);\n      root.style.setProperty('--primary-light', theme.primaryLight);\n      root.style.setProperty('--primary-dark', theme.primaryDark);\n      root.style.setProperty('--secondary-color', theme.secondaryColor);\n      root.style.setProperty('--secondary-light', theme.secondaryLight);\n      root.style.setProperty('--secondary-dark', theme.secondaryDark);\n      root.style.setProperty('--accent-color', theme.accentColor);\n      root.style.setProperty('--background-color', theme.backgroundColor);\n      root.style.setProperty('--text-color', theme.textColor);\n      root.style.setProperty('--text-light', theme.textLight);\n      // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–º—É –≤ —Ñ–∞–π–ª\n      const saveResult = await saveTheme({ currentTheme: themeId, themes: themes });\n      if (saveResult.success) {\n        showAlert(`–¢–µ–º–∞ \"${theme.name}\" –ø—Ä–∏–º–µ–Ω–µ–Ω–∞. –§–∞–π–ª theme.json —Å–∫–∞—á–∞–Ω.`, 'success');\n      } else {\n        showAlert(`–¢–µ–º–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞, –Ω–æ —Ñ–∞–π–ª –Ω–µ —Å–∫–∞—á–∞–Ω: ${saveResult.message}`, 'error');\n      }\n      return;\n    }\n    \n    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ç–µ–º—ã\n    const theme = themes[themeId];\n    if (theme) {\n      const root = document.documentElement;\n      root.style.setProperty('--primary-color', theme.primaryColor);\n      root.style.setProperty('--primary-light', theme.primaryLight);\n      root.style.setProperty('--primary-dark', theme.primaryDark);\n      root.style.setProperty('--secondary-color', theme.secondaryColor);\n      root.style.setProperty('--secondary-light', theme.secondaryLight);\n      root.style.setProperty('--secondary-dark', theme.secondaryDark);\n      root.style.setProperty('--accent-color', theme.accentColor);\n      root.style.setProperty('--background-color', theme.backgroundColor);\n      root.style.setProperty('--text-color', theme.textColor);\n      root.style.setProperty('--text-light', theme.textLight);\n      // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–º—É –≤ —Ñ–∞–π–ª\n      const saveResult = await saveTheme({ currentTheme: themeId, themes: themes });\n      if (saveResult.success) {\n        showAlert(`–¢–µ–º–∞ \"${theme.name}\" –ø—Ä–∏–º–µ–Ω–µ–Ω–∞. –§–∞–π–ª theme.json —Å–∫–∞—á–∞–Ω.`, 'success');\n      } else {\n        showAlert(`–¢–µ–º–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞, –Ω–æ —Ñ–∞–π–ª –Ω–µ —Å–∫–∞—á–∞–Ω: ${saveResult.message}`, 'error');\n      }\n    }\n  };\n\n  const saveThemes = async (updatedThemes) => {\n    // –û–±—ä–µ–¥–∏–Ω—è–µ–º –±–∞–∑–æ–≤—ã–µ —Ç–µ–º—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è\n    const allThemes = { ...defaultThemes, ...updatedThemes };\n    setThemes(allThemes);\n    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ñ–∞–π–ª\n    const saveResult = await saveTheme({ currentTheme: currentTheme, themes: allThemes });\n    if (!saveResult.success) {\n      showAlert(`–û—à–∏–±–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ —Ç–µ–º: ${saveResult.message}`, 'error');\n    } else {\n      showAlert('–§–∞–π–ª theme.json —Å–∫–∞—á–∞–Ω', 'success');\n    }\n  };\n\n  // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–≤–µ—Ç–ª–æ–≥–æ –∏ —Ç–µ–º–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ü–≤–µ—Ç–∞\n  const hexToRgb = (hex) => {\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? {\n      r: parseInt(result[1], 16),\n      g: parseInt(result[2], 16),\n      b: parseInt(result[3], 16)\n    } : null;\n  };\n\n  const rgbToHex = (r, g, b) => {\n    return \"#\" + [r, g, b].map(x => {\n      const hex = x.toString(16);\n      return hex.length === 1 ? \"0\" + hex : hex;\n    }).join(\"\");\n  };\n\n  const lightenColor = (hex, percent = 20) => {\n    const rgb = hexToRgb(hex);\n    if (!rgb) return hex;\n    \n    const r = Math.min(255, Math.round(rgb.r + (255 - rgb.r) * (percent / 100)));\n    const g = Math.min(255, Math.round(rgb.g + (255 - rgb.g) * (percent / 100)));\n    const b = Math.min(255, Math.round(rgb.b + (255 - rgb.b) * (percent / 100)));\n    \n    return rgbToHex(r, g, b);\n  };\n\n  const darkenColor = (hex, percent = 20) => {\n    const rgb = hexToRgb(hex);\n    if (!rgb) return hex;\n    \n    const r = Math.max(0, Math.round(rgb.r * (1 - percent / 100)));\n    const g = Math.max(0, Math.round(rgb.g * (1 - percent / 100)));\n    const b = Math.max(0, Math.round(rgb.b * (1 - percent / 100)));\n    \n    return rgbToHex(r, g, b);\n  };\n\n  const addTheme = () => {\n    const basePrimaryColor = '#8B7355';\n    const newTheme = {\n      id: `theme_${Date.now()}`,\n      name: '–ù–æ–≤–∞—è —Ç–µ–º–∞',\n      primaryColor: basePrimaryColor,\n      primaryLight: lightenColor(basePrimaryColor, 20),\n      primaryDark: darkenColor(basePrimaryColor, 20),\n      secondaryColor: '#A8D8EA',\n      secondaryLight: '#C5E7F5',\n      secondaryDark: '#7BB8D4',\n      accentColor: '#D4B896',\n      backgroundColor: '#FDF6E3',\n      textColor: '#333333',\n      textLight: '#666666'\n    };\n    const updated = { ...themes, [newTheme.id]: newTheme };\n    saveThemes(updated);\n    setEditingTheme(newTheme);\n    showAlert('–¢–µ–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞', 'success');\n  };\n\n  const updateTheme = (theme) => {\n    if (!theme.name || !theme.name.trim()) {\n      showAlert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã', 'error');\n      return;\n    }\n    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ–º —Å–≤–µ—Ç–ª—ã–π –∏ —Ç–µ–º–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞\n    const updatedTheme = {\n      ...theme,\n      primaryLight: lightenColor(theme.primaryColor, 20),\n      primaryDark: darkenColor(theme.primaryColor, 20)\n    };\n    const updated = { ...themes, [updatedTheme.id]: updatedTheme };\n    saveThemes(updated);\n    setEditingTheme(null);\n    showAlert('–¢–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞', 'success');\n  };\n\n  const deleteTheme = (id) => {\n    if (defaultThemes[id]) {\n      showAlert('–ë–∞–∑–æ–≤—ã–µ —Ç–µ–º—ã –Ω–µ–ª—å–∑—è —É–¥–∞–ª—è—Ç—å', 'error');\n      return;\n    }\n    const updated = { ...themes };\n    delete updated[id];\n    saveThemes(updated);\n    if (currentTheme === id) {\n      applyTheme('default');\n    }\n    showAlert('–¢–µ–º–∞ —É–¥–∞–ª–µ–Ω–∞', 'success');\n  };\n\n  const deleteReservation = async (id) => {\n    const updated = reservations.filter(res => res.id !== id);\n    setReservations(updated);\n    const saveResult = await autoSaveReservations(updated);\n    if (saveResult.success) {\n      showAlert('–ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞', 'success');\n    } else {\n      showAlert(`–ó–∞—è–≤–∫–∞ —É–¥–∞–ª–µ–Ω–∞, –Ω–æ —Ñ–∞–π–ª –Ω–µ —Å–∫–∞—á–∞–Ω: ${saveResult.message}`, 'error');\n    }\n  };\n\n  const deleteMenuItem = async (id) => {\n    // –ù–∞—Ö–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (–¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è)\n    const itemToDelete = menuItems.find(item => item.id === id);\n    if (itemToDelete) {\n      const hasImage = itemToDelete.image && itemToDelete.image.startsWith('data:image');\n      console.log('üóëÔ∏è deleteMenuItem: –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –º–µ–Ω—é:', {\n        id: itemToDelete.id,\n        name: itemToDelete.name,\n        hasImage: hasImage,\n        imageSize: hasImage ? itemToDelete.image.length : 0\n      });\n    }\n    \n    // –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –º–µ–Ω—é (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å —ç–ª–µ–º–µ–Ω—Ç–æ–º, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–æ —á–∞—Å—Ç—å JSON)\n    const updated = menuItems.filter(item => item.id !== id);\n    setMenuItems(updated);\n    \n    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —Ñ–∞–π–ª\n    // –ü—Ä–∏ —ç—Ç–æ–º —Å—Ç–∞—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (base64) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ —ç–ª–µ–º–µ–Ω—Ç —É–¥–∞–ª–µ–Ω –∏–∑ –º–∞—Å—Å–∏–≤–∞\n    const saveResult = await autoSaveMenu(updated);\n    if (saveResult.success) {\n      console.log('‚úÖ deleteMenuItem: –ü–æ–∑–∏—Ü–∏—è –º–µ–Ω—é –∏ –µ—ë –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã');\n      showAlert('–ë–ª—é–¥–æ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–æ', 'success');\n    } else {\n      console.error('‚ùå deleteMenuItem: –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è:', saveResult.message);\n      showAlert(`–ë–ª—é–¥–æ —É–¥–∞–ª–µ–Ω–æ, –Ω–æ —Ñ–∞–π–ª –Ω–µ —Å–∫–∞—á–∞–Ω: ${saveResult.message}`, 'error');\n    }\n  };\n\n  const cancelPhotoEditing = useCallback(() => {\n    // –û—á–∏—â–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ\n    const formKey = editingPhoto?.id || newPhotoKeyRef.current;\n    if (uploadedImagesStore.current.has(formKey)) {\n      uploadedImagesStore.current.delete(formKey);\n    }\n    setEditingPhoto(null);\n  }, [editingPhoto]);\n\n  const savePhoto = useCallback(async (photo) => {\n    try {\n    // –í–∞–ª–∏–¥–∞—Ü–∏—è: –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è\n    if (!photo.image || !photo.image.trim()) {\n      showAlert('–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ', 'error');\n      return;\n    }\n    \n    // –í–∞–ª–∏–¥–∞—Ü–∏—è: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å base64\n    if (!photo.image.startsWith('data:image')) {\n      showAlert('–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è', 'error');\n      return;\n    }\n    \n    // –í–∞–ª–∏–¥–∞—Ü–∏—è: –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—É—Å—Ç—ã–µ –æ–±—ä–µ–∫—Ç—ã –∏–ª–∏ –æ–±—ä–µ–∫—Ç—ã —Ç–æ–ª—å–∫–æ —Å —Ç–µ–∫—Å—Ç–æ–º (–±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)\n    // –≠—Ç–æ —É–∂–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤—ã—à–µ, –Ω–æ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –µ—â–µ —Ä–∞–∑\n    const hasValidImage = photo.image && \n                          photo.image.trim() && \n                          photo.image.startsWith('data:image');\n    \n    if (!hasValidImage) {\n      showAlert('–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ', 'error');\n      return;\n    }\n\n    let updated;\n    if (photo.id) {\n      // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏\n      const oldPhoto = photos.find(p => p.id === photo.id);\n      const imageChanged = oldPhoto?.image !== photo.image;\n      \n      console.log('üíæ savePhoto: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏:', {\n        id: photo.id,\n        caption: photo.caption,\n        oldImageSize: oldPhoto?.image ? oldPhoto.image.length : 0,\n        newImageSize: photo.image ? photo.image.length : 0,\n        imageChanged: imageChanged\n      });\n      \n      // –ó–∞–º–µ–Ω—è–µ–º —Å—Ç–∞—Ä—É—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –Ω–æ–≤–æ–π (—Å—Ç–∞—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å–æ —Å—Ç–∞—Ä—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º)\n      updated = photos.map(p => p.id === photo.id ? photo : p);\n      \n      if (imageChanged) {\n        console.log('üîÑ savePhoto: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–º–µ–Ω–µ–Ω–æ, —Å—Ç–∞—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏');\n      }\n    } else {\n      // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏\n      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID, –ø—Ä–æ–≤–µ—Ä—è—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏\n      const newId = generateUniqueId(photos);\n      const newPhoto = {\n        ...photo,\n        id: newId\n      };\n      updated = [...photos, newPhoto];\n    }\n    \n    // –§–∏–ª—å—Ç—Ä—É–µ–º –ø—É—Å—Ç—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º\n    const validPhotos = updated.filter(p => {\n      return p && \n             p.image && \n             p.image.trim() && \n             p.image.startsWith('data:image');\n    });\n    \n    setPhotos(validPhotos);\n      \n      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä\n      const saveResult = await autoSavePhotos(validPhotos);\n    \n      if (!saveResult.success) {\n        // –ï—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –Ω–µ —É–¥–∞–ª–æ—Å—å, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –∏ –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ\n        showAlert(`–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä: ${saveResult.message}`, 'error');\n        console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏:', saveResult);\n        return; // –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞\n      }\n      \n      // –û—á–∏—â–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —ç—Ç–æ–π —Ñ–æ—Ä–º—ã –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è\n    const formKey = photo.id || newPhotoKeyRef.current;\n    if (uploadedImagesStore.current.has(formKey)) {\n      uploadedImagesStore.current.delete(formKey);\n    }\n    \n    setEditingPhoto(null);\n    showAlert(photo.id ? '–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞' : '–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞', 'success');\n    } catch (error) {\n      console.error('–ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏:', error);\n      showAlert(`–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏: ${error.message}`, 'error');\n    }\n  }, [photos]);\n\n  const deletePhoto = async (id) => {\n    // –ù–∞—Ö–æ–¥–∏–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (–¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è)\n    const photoToDelete = photos.find(p => p.id === id);\n    if (photoToDelete) {\n      const hasImage = photoToDelete.image && photoToDelete.image.startsWith('data:image');\n      console.log('üóëÔ∏è deletePhoto: –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏:', {\n        id: photoToDelete.id,\n        caption: photoToDelete.caption,\n        hasImage: hasImage,\n        imageSize: hasImage ? photoToDelete.image.length : 0\n      });\n    }\n    \n    // –£–¥–∞–ª—è–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –∏–∑ –º–∞—Å—Å–∏–≤–∞ (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å —ç–ª–µ–º–µ–Ω—Ç–æ–º, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–æ —á–∞—Å—Ç—å JSON)\n    const updated = photos.filter(p => p.id !== id);\n    setPhotos(updated);\n    \n    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –≤ —Ñ–∞–π–ª\n    // –ü—Ä–∏ —ç—Ç–æ–º —Å—Ç–∞—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (base64) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ —ç–ª–µ–º–µ–Ω—Ç —É–¥–∞–ª–µ–Ω –∏–∑ –º–∞—Å—Å–∏–≤–∞\n    const saveResult = await autoSavePhotos(updated);\n    if (saveResult.success) {\n      console.log('‚úÖ deletePhoto: –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –∏ –µ—ë –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã');\n    showAlert('–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è —É–¥–∞–ª–µ–Ω–∞', 'success');\n    } else {\n      showAlert(`–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è —É–¥–∞–ª–µ–Ω–∞, –Ω–æ —Ñ–∞–π–ª –Ω–µ —Å–∫–∞—á–∞–Ω: ${saveResult.message}`, 'error');\n    }\n  };\n\n  const validateMenuItem = (item) => {\n    if (!item.name || !item.name.trim()) {\n      showAlert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞', 'error');\n      return false;\n    }\n    if (!item.price || isNaN(parseFloat(item.price)) || parseFloat(item.price) <= 0) {\n      showAlert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ü–µ–Ω—É (–±–æ–ª—å—à–µ 0)', 'error');\n      return false;\n    }\n    if (!item.weight || !item.weight.trim()) {\n      showAlert('–í–≤–µ–¥–∏—Ç–µ –≤–µ—Å/–æ–±—ä–µ–º', 'error');\n      return false;\n    }\n    if (!item.description || !item.description.trim()) {\n      showAlert('–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –±–ª—é–¥–∞', 'error');\n      return false;\n    }\n    if (!item.image || !item.image.trim()) {\n      showAlert('–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ', 'error');\n      return false;\n    }\n    if (!item.image.startsWith('data:image')) {\n      showAlert('–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è', 'error');\n      return false;\n    }\n    return true;\n  };\n\n  const saveMenuItem = async (item) => {\n    if (!validateMenuItem(item)) return;\n\n    console.log('üíæ saveMenuItem: –ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', {\n      id: item.id,\n      name: item.name,\n      hasImage: !!item.image,\n      imageLength: item.image ? item.image.length : 0,\n      imageStart: item.image ? item.image.substring(0, 50) : '–Ω–µ—Ç'\n    });\n\n    // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ü–µ–Ω—É (—É–±–∏—Ä–∞–µ–º \"‚ÇΩ\" –µ—Å–ª–∏ –µ—Å—Ç—å –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —á–∏—Å–ª–æ)\n    const formattedItem = {\n      ...item,\n      price: item.price.toString().replace(' ‚ÇΩ', '')\n    };\n\n    // –í–ê–ñ–ù–û: —É–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ\n    if (item.image) {\n      formattedItem.image = item.image;\n    }\n\n    console.log('üíæ saveMenuItem: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:', {\n      id: formattedItem.id,\n      name: formattedItem.name,\n      hasImage: !!formattedItem.image,\n      imageLength: formattedItem.image ? formattedItem.image.length : 0,\n      imageStart: formattedItem.image ? formattedItem.image.substring(0, 50) : '–Ω–µ—Ç'\n    });\n\n    let updatedItems;\n    if (editingItem && editingItem.id) {\n      // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –±–ª—é–¥–∞ (–ª—é–±–æ–≥–æ, –≤–∫–ª—é—á–∞—è –±–∞–∑–æ–≤—ã–µ)\n      const oldItem = menuItems.find(mi => mi.id === editingItem.id);\n      const imageChanged = oldItem?.image !== formattedItem.image;\n      \n      console.log('üíæ saveMenuItem: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞:', {\n        id: editingItem.id,\n        name: formattedItem.name,\n        oldImageSize: oldItem?.image ? oldItem.image.length : 0,\n        newImageSize: formattedItem.image ? formattedItem.image.length : 0,\n        imageChanged: imageChanged\n      });\n      \n      // –ó–∞–º–µ–Ω—è–µ–º —Å—Ç–∞—Ä—ã–π —ç–ª–µ–º–µ–Ω—Ç –Ω–æ–≤—ã–º (—Å—Ç–∞—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å–æ —Å—Ç–∞—Ä—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º)\n      updatedItems = menuItems.map(menuItem => \n        menuItem.id === editingItem.id ? { ...formattedItem, id: editingItem.id } : menuItem\n      );\n      \n      if (imageChanged) {\n        console.log('üîÑ saveMenuItem: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–º–µ–Ω–µ–Ω–æ, —Å—Ç–∞—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏');\n      }\n      \n      showAlert('–ë–ª—é–¥–æ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ', 'success');\n    } else {\n      // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –±–ª—é–¥–∞\n      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID, –ø—Ä–æ–≤–µ—Ä—è—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã\n      const newId = generateUniqueId(menuItems);\n      const newItem = {\n        ...formattedItem,\n        id: newId\n      };\n      updatedItems = [...menuItems, newItem];\n      showAlert('–ë–ª—é–¥–æ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ', 'success');\n    }\n\n    setMenuItems(updatedItems);\n    \n    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —Ñ–∞–π–ª (–≤–∫–ª—é—á–∞—è –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–∞–∑–æ–≤—ã–µ)\n    const saveResult = await autoSaveMenu(updatedItems);\n    if (!saveResult.success) {\n      showAlert(`–û—à–∏–±–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ –º–µ–Ω—é: ${saveResult.message}`, 'error');\n    } else {\n      showAlert('–§–∞–π–ª menu.json —Å–∫–∞—á–∞–Ω', 'success');\n    }\n    \n    // –û—á–∏—â–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —ç—Ç–æ–π —Ñ–æ—Ä–º—ã –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è\n    const formKey = editingItem?.id || newMenuItemKeyRef.current;\n    if (menuImagesStore.current.has(formKey)) {\n      menuImagesStore.current.delete(formKey);\n    }\n    \n    setEditingItem(null);\n  };\n\n  const startEditing = (item) => {\n    setEditingItem(item);\n  };\n\n  const cancelEditing = useCallback(() => {\n    // –û—á–∏—â–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ\n    const formKey = editingItem?.id || newMenuItemKeyRef.current;\n    if (menuImagesStore.current.has(formKey)) {\n      menuImagesStore.current.delete(formKey);\n    }\n    // –û—á–∏—â–∞–µ–º localStorage —Å –¥–∞–Ω–Ω—ã–º–∏ —Ñ–æ—Ä–º—ã –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤)\n    if (!editingItem?.id) {\n      try {\n        const formDataStorageKey = `menu-item-form-${formKey}`;\n        localStorage.removeItem(formDataStorageKey);\n        console.log('üóëÔ∏è cancelEditing: –î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã —É–¥–∞–ª–µ–Ω—ã –∏–∑ localStorage –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ');\n      } catch (e) {\n        console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã –∏–∑ localStorage:', e);\n      }\n    }\n    setEditingItem(null);\n  }, [editingItem]);\n\n  // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–æ—Ä–º—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–º—ã\n  const ThemeEditForm = ({ theme, onSave, onCancel }) => {\n    const [formData, setFormData] = useState(theme);\n\n    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ü–≤–µ—Ç–∞ (–ª–æ–∫–∞–ª—å–Ω—ã–µ –∫–æ–ø–∏–∏)\n    const hexToRgbLocal = (hex) => {\n      const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n      return result ? {\n        r: parseInt(result[1], 16),\n        g: parseInt(result[2], 16),\n        b: parseInt(result[3], 16)\n      } : null;\n    };\n\n    const rgbToHexLocal = (r, g, b) => {\n      return \"#\" + [r, g, b].map(x => {\n        const hex = x.toString(16);\n        return hex.length === 1 ? \"0\" + hex : hex;\n      }).join(\"\");\n    };\n\n    const lightenColorLocal = (hex, percent = 20) => {\n      const rgb = hexToRgbLocal(hex);\n      if (!rgb) return hex;\n      \n      const r = Math.min(255, Math.round(rgb.r + (255 - rgb.r) * (percent / 100)));\n      const g = Math.min(255, Math.round(rgb.g + (255 - rgb.g) * (percent / 100)));\n      const b = Math.min(255, Math.round(rgb.b + (255 - rgb.b) * (percent / 100)));\n      \n      return rgbToHexLocal(r, g, b);\n    };\n\n    const darkenColorLocal = (hex, percent = 20) => {\n      const rgb = hexToRgbLocal(hex);\n      if (!rgb) return hex;\n      \n      const r = Math.max(0, Math.round(rgb.r * (1 - percent / 100)));\n      const g = Math.max(0, Math.round(rgb.g * (1 - percent / 100)));\n      const b = Math.max(0, Math.round(rgb.b * (1 - percent / 100)));\n      \n      return rgbToHexLocal(r, g, b);\n    };\n\n    const handleChange = (field, value) => {\n      const updated = {\n        ...formData,\n        [field]: value\n      };\n      \n      // –ï—Å–ª–∏ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ–º —Å–≤–µ—Ç–ª—ã–π –∏ —Ç–µ–º–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç—ã\n      if (field === 'primaryColor') {\n        updated.primaryLight = lightenColorLocal(value, 20);\n        updated.primaryDark = darkenColorLocal(value, 20);\n      }\n      \n      setFormData(updated);\n    };\n\n    const handleSubmit = (e) => {\n      e.preventDefault();\n      onSave(formData);\n    };\n\n    const colorFields = [\n      { key: 'primaryColor', label: '–û—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç' },\n      { key: 'secondaryColor', label: '–¶–≤–µ—Ç –∫–Ω–æ–ø–æ–∫ –∏ —Å—Å—ã–ª–æ–∫' },\n      { key: 'secondaryLight', label: '–¶–≤–µ—Ç –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏' },\n      { key: 'secondaryDark', label: '–¶–≤–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤' },\n      { key: 'accentColor', label: '–ê–∫—Ü–µ–Ω—Ç–Ω—ã–π —Ü–≤–µ—Ç (–≤—ã–¥–µ–ª–µ–Ω–∏—è)' },\n      { key: 'backgroundColor', label: '–¶–≤–µ—Ç —Ñ–æ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã' },\n      { key: 'textColor', label: '–¶–≤–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞' },\n      { key: 'textLight', label: '–¶–≤–µ—Ç –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞' }\n    ];\n\n    return (\n      <div className=\"theme-edit-form\">\n        <form onSubmit={handleSubmit}>\n          <div className=\"form-group\">\n            <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã *</label>\n            <input\n              type=\"text\"\n              value={formData.name}\n              onChange={(e) => handleChange('name', e.target.value)}\n              placeholder=\"–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã\"\n              required\n            />\n          </div>\n\n          <div className=\"theme-colors-grid\">\n            {colorFields.map(field => (\n              <div key={field.key} className=\"color-picker-group\">\n                <label>{field.label}</label>\n                <div className=\"color-picker-wrapper\">\n                  <input\n                    type=\"color\"\n                    value={formData[field.key]}\n                    onChange={(e) => handleChange(field.key, e.target.value)}\n                    className=\"color-picker\"\n                  />\n                  <input\n                    type=\"text\"\n                    value={formData[field.key]}\n                    onChange={(e) => handleChange(field.key, e.target.value)}\n                    className=\"color-input\"\n                    placeholder=\"#000000\"\n                  />\n                  <div \n                    className=\"color-preview\"\n                    style={{ background: formData[field.key] }}\n                  ></div>\n                </div>\n              </div>\n            ))}\n          </div>\n\n          <div className=\"form-actions\">\n            <button type=\"submit\" className=\"save-btn\">\n              –°–æ—Ö—Ä–∞–Ω–∏—Ç—å\n            </button>\n            <button type=\"button\" className=\"cancel-btn\" onClick={onCancel}>\n              –û—Ç–º–µ–Ω–∞\n            </button>\n          </div>\n        </form>\n      </div>\n    );\n  };\n\n  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º\n  // –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ MIME-—Ç–∏–ø, –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –≤—Å–µ—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤\n  const isImageFile = (file) => {\n    // –ü—Ä–æ–≤–µ—Ä—è–µ–º MIME-—Ç–∏–ø (–æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)\n    if (file.type && file.type.startsWith('image/')) {\n      return true;\n    }\n    \n    // Fallback: –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞\n    // –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º –≤—Å–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π\n    const imageExtensions = [\n      'jpg', 'jpeg', 'png', 'gif', 'webp', 'bmp', 'svg', \n      'ico', 'tiff', 'tif', 'heic', 'heif', 'avif', 'apng'\n    ];\n    \n    const fileName = file.name.toLowerCase();\n    const extension = fileName.split('.').pop();\n    \n    return imageExtensions.includes(extension);\n  };\n\n  const convertFileToBase64 = (file) => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = () => resolve(reader.result);\n      reader.onerror = reject;\n      reader.readAsDataURL(file);\n    });\n  };\n\n  // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n  const LoginForm = ({ onLogin }) => {\n    const [username, setUsername] = useState('');\n    const [password, setPassword] = useState('');\n    const [error, setError] = useState('');\n\n    const handleSubmit = (e) => {\n      e.preventDefault();\n      setError('');\n      \n      if (!username.trim() || !password.trim()) {\n        setError('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');\n        return;\n      }\n\n      const success = onLogin(username, password);\n      if (!success) {\n        setError('–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å');\n        setPassword('');\n      }\n    };\n\n    return (\n      <div className=\"admin-login-container\">\n        <div className=\"admin-login-form\">\n          <div className=\"admin-login-header\">\n            <h1>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>\n            <p>–í–æ–π–¥–∏—Ç–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∞–π—Ç–æ–º</p>\n          </div>\n          <form onSubmit={handleSubmit} className=\"login-form\">\n            <div className=\"form-group\">\n              <label htmlFor=\"username\">–õ–æ–≥–∏–Ω</label>\n              <input\n                id=\"username\"\n                type=\"text\"\n                value={username}\n                onChange={(e) => setUsername(e.target.value)}\n                placeholder=\"–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω\"\n                autoFocus\n                className={error ? 'error' : ''}\n              />\n            </div>\n            <div className=\"form-group\">\n              <label htmlFor=\"password\">–ü–∞—Ä–æ–ª—å</label>\n              <input\n                id=\"password\"\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                placeholder=\"–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å\"\n                className={error ? 'error' : ''}\n              />\n            </div>\n            {error && <div className=\"login-error\">{error}</div>}\n            <button type=\"submit\" className=\"login-submit-btn\">\n              –í–æ–π—Ç–∏\n            </button>\n          </form>\n        </div>\n      </div>\n    );\n  };\n\n  // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–æ—Ä–º—ã –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π\n  const PhotoForm = ({ photo, onSave, onCancel, onAlert, uploadedImagesStore, formKey }) => {\n    // –ò–∑–≤–ª–µ–∫–∞–µ–º ID —Ñ–æ—Ç–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π\n    // –ò—Å–ø–æ–ª—å–∑—É–µ–º useMemo –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ª–∏—à–Ω–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π\n    const photoId = useMemo(() => photo?.id, [photo?.id]);\n    \n    // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID —Ñ–æ—Ç–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π\n    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º ref —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\n    const photoIdRef = useRef(photoId);\n    const isInitialMountRef = useRef(true);\n    \n    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è\n    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\n    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, –µ—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—ã–ª–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ —Ä–∞–Ω–µ–µ\n    const [image, setImage] = useState(() => {\n      // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ\n      if (uploadedImagesStore && uploadedImagesStore.has(formKey)) {\n        return uploadedImagesStore.get(formKey);\n      }\n      return photo?.image || '';\n    });\n    const [caption, setCaption] = useState(photo?.caption || '');\n    const [isUploading, setIsUploading] = useState(false);\n    const [isDragging, setIsDragging] = useState(false);\n    const fileInputRef = useRef(null);\n    const userHasUploadedRef = useRef(false); // –§–ª–∞–≥: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n    const uploadedImageRef = useRef(null); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n    const isProcessingFileRef = useRef(false); // –§–ª–∞–≥: —Ñ–∞–π–ª –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è\n\n    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ ID —Ñ–æ—Ç–æ (–Ω–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ)\n    useEffect(() => {\n      const isInitialMount = isInitialMountRef.current;\n      isInitialMountRef.current = false;\n      \n      // –ï—Å–ª–∏ ID –∏–∑–º–µ–Ω–∏–ª—Å—è (–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ)\n      if (photoIdRef.current !== photoId) {\n        photoIdRef.current = photoId;\n        \n        // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã, –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –µ–≥–æ\n        if (userHasUploadedRef.current && !photoId && uploadedImageRef.current) {\n          // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n          setImage(uploadedImageRef.current);\n          return; // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n        }\n        \n        // –ï—Å–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Ñ–æ—Ç–æ - –∑–∞–≥—Ä—É–∂–∞–µ–º –µ–≥–æ –¥–∞–Ω–Ω—ã–µ\n        if (photoId && photo) {\n          userHasUploadedRef.current = false;\n          uploadedImageRef.current = null;\n          setImage(photo.image || '');\n          setCaption(photo.caption || '');\n        } else {\n          // –ù–æ–≤–∞—è —Ñ–æ—Ä–º–∞ - —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â–µ –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª\n          if (!userHasUploadedRef.current && !uploadedImageRef.current) {\n            setImage('');\n            setCaption('');\n          } else if (uploadedImageRef.current) {\n            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n            setImage(uploadedImageRef.current);\n          }\n        }\n      }\n      // –ù–ï –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º isInitialMount –∑–¥–µ—Å—å - —ç—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–µ\n    }, [photoId]); // –ó–∞–≤–∏—Å–∏–º –¢–û–õ–¨–ö–û –æ—Ç photoId - —ç—Ç–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ\n    \n    // –û—Ç–¥–µ–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\n    useEffect(() => {\n      if (isInitialMountRef.current && !photoId && image && image.startsWith('data:image')) {\n        uploadedImageRef.current = image;\n      }\n    }, []); // –¢–æ–ª—å–∫–æ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\n    \n    // –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–±—Ä–æ—Å–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–µ\n    // –≠—Ç–æ—Ç —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, –µ—Å–ª–∏ –æ–Ω–æ –±—ã–ª–æ —Å–±—Ä–æ—à–µ–Ω–æ\n    useEffect(() => {\n      // –¢–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã (–±–µ–∑ ID) –∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n      // –ò –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –±—ã–ª–æ —è–≤–Ω–æ —É–¥–∞–ª–µ–Ω–æ (ref –Ω–µ null)\n      if (!photoId && userHasUploadedRef.current && uploadedImageRef.current) {\n        // –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—É—Å—Ç–æ–µ, –Ω–æ –≤ ref –∏–ª–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –µ—Å—Ç—å - –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º\n        if (!image) {\n          // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ\n          const storedImage = uploadedImagesStore && uploadedImagesStore.has(formKey) \n            ? uploadedImagesStore.get(formKey) \n            : null;\n          \n          if (storedImage) {\n            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞\n            uploadedImageRef.current = storedImage;\n            setImage(storedImage);\n            return;\n          }\n          \n          // –ï—Å–ª–∏ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–µ—Ç, –Ω–æ –≤ ref –µ—Å—Ç—å - –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑ ref\n          if (uploadedImageRef.current) {\n            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –±—É–¥—É—â–∏—Ö –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–æ–≤\n            if (uploadedImagesStore && formKey) {\n              uploadedImagesStore.set(formKey, uploadedImageRef.current);\n            }\n            setImage(uploadedImageRef.current);\n          }\n        }\n      }\n    }); // –ë–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π - —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ –¥–ª—è –∑–∞—â–∏—Ç—ã\n\n    const handleChange = (e) => {\n      if (e.target.name === 'caption') {\n        setCaption(e.target.value);\n      }\n    };\n\n    const processFile = async (file) => {\n      if (!file) {\n        return;\n      }\n\n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø —Ñ–∞–π–ª–∞ (MIME-—Ç–∏–ø –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)\n      if (!isImageFile(file)) {\n        onAlert('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (JPG, PNG, GIF, WEBP, BMP, SVG, HEIC –∏ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã)', 'error');\n        return;\n      }\n\n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–º–∞–∫—Å–∏–º—É–º 5MB)\n      if (file.size > 5 * 1024 * 1024) {\n        onAlert('–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å 5MB', 'error');\n        return;\n      }\n\n      setIsUploading(true);\n      try {\n        const base64 = await convertFileToBase64(file);\n        \n        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n        userHasUploadedRef.current = true;\n        uploadedImageRef.current = base64; // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ ref –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Å–±—Ä–æ—Å–∞\n        \n        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–µ\n        if (uploadedImagesStore && formKey) {\n          uploadedImagesStore.set(formKey, base64);\n        }\n        \n        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ\n        // —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ\n        setImage(prevImage => {\n          // –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç, –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ–º\n          if (prevImage === base64) {\n            return prevImage;\n          }\n          return base64;\n        });\n        \n        // –û—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º –≤—ã–∑–æ–≤ onAlert, —á—Ç–æ–±—ã –¥–∞—Ç—å React –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ\n        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–¥–µ—Ä–∂–∫—É, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ\n        // –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —É—Å–ø–µ–ª –æ—Ç—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å—Å—è —Å –Ω–æ–≤—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º\n        setTimeout(() => {\n          // –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º onAlert\n          setImage(currentImage => {\n            // –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—ã–ª–æ —Å–±—Ä–æ—à–µ–Ω–æ, –Ω–æ –≤ ref –æ–Ω–æ –µ—Å—Ç—å - –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º\n            if (!currentImage && uploadedImageRef.current) {\n              return uploadedImageRef.current;\n            }\n            return currentImage;\n          });\n          \n          // –í—ã–∑—ã–≤–∞–µ–º onAlert —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ\n          onAlert('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ', 'success');\n        }, 150);\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞:', error);\n        onAlert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞', 'error');\n      } finally {\n        setIsUploading(false);\n      }\n    };\n\n    const handleFileChange = async (e) => {\n      // –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤\n      if (isProcessingFileRef.current) {\n        return;\n      }\n      \n      const file = e.target.files?.[0];\n      if (!file) {\n        return;\n      }\n      \n      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –æ–±—Ä–∞–±–æ—Ç–∫–∏\n      isProcessingFileRef.current = true;\n      \n      // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ input –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏\n      const input = e.target;\n      \n      try {\n        await processFile(file);\n      } finally {\n        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –æ–±—Ä–∞–±–æ—Ç–∫–∏\n        isProcessingFileRef.current = false;\n        \n        // –û—á–∏—â–∞–µ–º input –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ—Ç –∂–µ —Ñ–∞–π–ª —Å–Ω–æ–≤–∞\n        // –î–µ–ª–∞–µ–º —ç—Ç–æ —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π, —á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–µ\n        setTimeout(() => {\n          if (input) {\n            input.value = '';\n          }\n        }, 100);\n      }\n    };\n\n    const handleDragOver = (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      setIsDragging(true);\n    };\n\n    const handleDragLeave = (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      setIsDragging(false);\n    };\n\n    const handleDrop = async (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      setIsDragging(false);\n\n      const file = e.dataTransfer.files?.[0];\n      if (file) {\n        console.log('–§–∞–π–ª –ø–µ—Ä–µ—Ç–∞—â–µ–Ω (PhotoForm):', file.name, file.type, file.size);\n        await processFile(file);\n      }\n    };\n\n    const handleSubmit = (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      \n      if (!image || !image.trim()) {\n        onAlert('–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ', 'error');\n        return;\n      }\n      \n      if (!image.startsWith('data:image')) {\n        onAlert('–û—à–∏–±–∫–∞: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ', 'error');\n        return;\n      }\n      \n      const photoData = {\n        ...(photo?.id && { id: photo.id }),\n        image: image.trim(),\n        caption: caption.trim() || undefined\n      };\n      \n      onSave(photoData);\n    };\n\n    return (\n      <div className=\"modal-overlay\">\n        <div className=\"modal-content\">\n          <h2>{photo ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ç–æ' : '–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ'}</h2>\n          <form onSubmit={handleSubmit} noValidate>\n            <div className=\"form-group\">\n              <label>–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª *</label>\n              <div \n                className={`file-upload-dropzone ${isDragging ? 'dragging' : ''} ${image ? 'has-image' : ''}`}\n                onDragOver={handleDragOver}\n                onDragLeave={handleDragLeave}\n                onDrop={handleDrop}\n              >\n                <div className=\"file-upload-wrapper\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={handleFileChange}\n                    className=\"file-input-hidden\"\n                    disabled={isUploading}\n                  />\n                  <button\n                    type=\"button\"\n                    className=\"file-upload-button\"\n                    onClick={(e) => {\n                      e.preventDefault();\n                      if (fileInputRef.current) {\n                        fileInputRef.current.click();\n                      }\n                    }}\n                    disabled={isUploading}\n                  >\n                    {isUploading ? (\n                      <>\n                        <span className=\"upload-icon\">‚è≥</span>\n                        <span>–ó–∞–≥—Ä—É–∑–∫–∞...</span>\n                      </>\n                    ) : (\n                      <>\n                        <span className=\"upload-icon\">üì∑</span>\n                        <span>–í—ã–±—Ä–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</span>\n                      </>\n                    )}\n                  </button>\n                  {image && !isUploading && (\n                    <button\n                      type=\"button\"\n                      className=\"file-remove-button\"\n                      onClick={() => {\n                        userHasUploadedRef.current = false; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏\n                        uploadedImageRef.current = null; // –û—á–∏—â–∞–µ–º ref\n                        // –û—á–∏—â–∞–µ–º –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞\n                        if (uploadedImagesStore && formKey) {\n                          uploadedImagesStore.delete(formKey);\n                        }\n                        setImage('');\n                        if (fileInputRef.current) {\n                          fileInputRef.current.value = '';\n                        }\n                      }}\n                    >\n                      ‚úï\n                    </button>\n                  )}\n                </div>\n                {!image && (\n                  <p className=\"drag-drop-hint\">\n                    –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—é–¥–∞\n                  </p>\n                )}\n              </div>\n            </div>\n\n            {image && image.trim() ? (\n              <div className=\"form-group\">\n                <label>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:</label>\n                <div className=\"photo-preview-modern\">\n                  <img\n                    src={image}\n                    alt=\"–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä\"\n                    onError={(e) => {\n                      e.target.src = 'https://via.placeholder.com/300x200/8B7355/FFFFFF?text=–¢–±–∏–ª–∏—Å–∏';\n                    }}\n                  />\n                  <div className=\"photo-preview-overlay\">\n                    <span className=\"preview-badge\">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</span>\n                  </div>\n                </div>\n              </div>\n            ) : (\n              <div className=\"form-group\">\n                <p style={{ color: '#999', fontStyle: 'italic', fontSize: '0.9rem' }}>\n                  –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞\n                </p>\n              </div>\n            )}\n\n            <div className=\"form-group\">\n              <label>–ü–æ–¥–ø–∏—Å—å (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>\n              <input\n                type=\"text\"\n                name=\"caption\"\n                value={caption}\n                onChange={handleChange}\n                placeholder=\"–ü–æ–¥–ø–∏—Å—å –∫ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏\"\n              />\n            </div>\n\n            <div className=\"form-actions\">\n              <button type=\"submit\" className=\"save-btn\">\n                {photo ? '–û–±–Ω–æ–≤–∏—Ç—å' : '–î–æ–±–∞–≤–∏—Ç—å'}\n              </button>\n              <button type=\"button\" className=\"cancel-btn\" onClick={onCancel}>\n                –û—Ç–º–µ–Ω–∞\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    );\n  };\n\n  const MenuItemForm = ({ item, onSave, onCancel, onAlert, menuImagesStore, formKey }) => {\n    const defaultCategory = categories.length > 0 ? categories[0].key : 'cold';\n    \n    // –ò–∑–≤–ª–µ–∫–∞–µ–º ID —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π\n    const itemId = useMemo(() => item?.id, [item?.id]);\n    \n    // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π\n    const itemIdRef = useRef(itemId);\n    const isInitialMountRef = useRef(true);\n    \n    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º refs –î–û useState, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–µ\n    const fileInputRef = useRef(null);\n    const isProcessingFileRef = useRef(false); // –§–ª–∞–≥: —Ñ–∞–π–ª –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è\n    const uploadedImageRef = useRef(null); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n    const userHasUploadedRef = useRef(false); // –§–ª–∞–≥: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n    \n    // –ö–ª—é—á –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã –≤ localStorage\n    const formDataStorageKey = `menu-item-form-${formKey}`;\n    \n    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–∫–∞–∫ –≤ PhotoForm)\n    const [image, setImage] = useState(() => {\n      // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ\n      if (menuImagesStore && menuImagesStore.has(formKey)) {\n        const storedImage = menuImagesStore.get(formKey);\n        // –ï—Å–ª–∏ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –µ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥–∏\n        if (storedImage && storedImage.startsWith('data:image')) {\n          userHasUploadedRef.current = true;\n          uploadedImageRef.current = storedImage;\n        }\n        return storedImage;\n      }\n      return item?.image || '';\n    });\n    \n    const [formData, setFormData] = useState(() => {\n      // –ï—Å–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç - –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –¥–∞–Ω–Ω—ã–µ\n      if (item) {\n        return {\n          name: item.name || '',\n          price: item.price.toString().replace(' ‚ÇΩ', ''),\n          weight: item.weight || '',\n          description: item.description || '',\n          category: item.category || defaultCategory\n        };\n      }\n      \n      // –î–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã - –ø—ã—Ç–∞–µ–º—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ localStorage\n      const savedFormData = localStorage.getItem(formDataStorageKey);\n      if (savedFormData) {\n        try {\n          const parsed = JSON.parse(savedFormData);\n          return {\n            name: parsed.name || '',\n            price: parsed.price || '',\n            weight: parsed.weight || '',\n            description: parsed.description || '',\n            category: parsed.category || defaultCategory\n          };\n        } catch (e) {\n          console.error('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã –∏–∑ localStorage:', e);\n        }\n      }\n      \n      // –ï—Å–ª–∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö - —Å–æ–∑–¥–∞–µ–º –ø—É—Å—Ç—É—é —Ñ–æ—Ä–º—É\n      return {\n        name: '',\n        price: '',\n        weight: '',\n        description: '',\n        category: defaultCategory\n      };\n    });\n\n    const [errors, setErrors] = useState({});\n    const [isUploading, setIsUploading] = useState(false);\n    \n    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ ID —ç–ª–µ–º–µ–Ω—Ç–∞ (–Ω–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ)\n    useEffect(() => {\n      const isInitialMount = isInitialMountRef.current;\n      isInitialMountRef.current = false;\n      \n      // –ï—Å–ª–∏ ID –∏–∑–º–µ–Ω–∏–ª—Å—è (–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ)\n      if (itemIdRef.current !== itemId) {\n        itemIdRef.current = itemId;\n        \n        // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã, –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –µ–≥–æ\n        if (userHasUploadedRef.current && !itemId && uploadedImageRef.current) {\n          // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n          setImage(uploadedImageRef.current);\n          return; // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n        }\n        \n        // –ï—Å–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç - –∑–∞–≥—Ä—É–∂–∞–µ–º –µ–≥–æ –¥–∞–Ω–Ω—ã–µ\n        if (itemId && item) {\n          // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞–≥—Ä—É–∑–∏–ª –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏, –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –µ–≥–æ\n          if (userHasUploadedRef.current && uploadedImageRef.current) {\n            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ\n            const storedImage = menuImagesStore && menuImagesStore.has(formKey) \n              ? menuImagesStore.get(formKey) \n              : uploadedImageRef.current;\n            \n            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n            setImage(storedImage);\n            uploadedImageRef.current = storedImage;\n            \n            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ñ–æ—Ä–º—É, –Ω–æ –Ω–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n            setFormData({\n              name: item.name || '',\n              price: item.price.toString().replace(' ‚ÇΩ', ''),\n              weight: item.weight || '',\n              description: item.description || '',\n              category: item.category || defaultCategory\n            });\n          } else {\n            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ\n          userHasUploadedRef.current = false;\n          uploadedImageRef.current = null;\n          setImage(item.image || '');\n          setFormData({\n            name: item.name || '',\n            price: item.price.toString().replace(' ‚ÇΩ', ''),\n            weight: item.weight || '',\n            description: item.description || '',\n            category: item.category || defaultCategory\n          });\n          }\n        } else {\n          // –ù–æ–≤–∞—è —Ñ–æ—Ä–º–∞ - —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â–µ –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª\n          if (!userHasUploadedRef.current && !uploadedImageRef.current) {\n            setImage('');\n            setFormData({\n              name: '',\n              price: '',\n              weight: '',\n              description: '',\n              category: defaultCategory\n            });\n          } else if (uploadedImageRef.current) {\n            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n            setImage(uploadedImageRef.current);\n          }\n        }\n      }\n    }, [itemId, item, defaultCategory]);\n    \n    // –û—Ç–¥–µ–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\n    useEffect(() => {\n      if (isInitialMountRef.current && !itemId && image && image.startsWith('data:image')) {\n        uploadedImageRef.current = image;\n      }\n    }, []); // –¢–æ–ª—å–∫–æ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\n    \n    // –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–±—Ä–æ—Å–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–µ\n    // –≠—Ç–æ—Ç —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, –µ—Å–ª–∏ –æ–Ω–æ –±—ã–ª–æ —Å–±—Ä–æ—à–µ–Ω–æ\n    // –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–æ—Ä–º (–±–µ–∑ itemId) –∏ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ (—Å itemId), –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n    useEffect(() => {\n      // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã –∏–ª–∏ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏)\n      if (userHasUploadedRef.current) {\n        // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ\n        const storedImage = menuImagesStore && menuImagesStore.has(formKey) \n          ? menuImagesStore.get(formKey) \n          : null;\n        \n        if (storedImage) {\n          // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞\n          uploadedImageRef.current = storedImage;\n          // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–µ–∫—É—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è\n          setImage(prevImage => {\n            if (prevImage !== storedImage) {\n              return storedImage;\n            }\n            return prevImage;\n          });\n          return;\n        }\n        \n        // –ï—Å–ª–∏ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–µ—Ç, –Ω–æ –≤ ref –µ—Å—Ç—å - –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑ ref\n        if (uploadedImageRef.current) {\n          // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –±—É–¥—É—â–∏—Ö –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–æ–≤\n          if (menuImagesStore && formKey) {\n            menuImagesStore.set(formKey, uploadedImageRef.current);\n          }\n          // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–µ–∫—É—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è\n          setImage(prevImage => {\n            if (prevImage !== uploadedImageRef.current) {\n              return uploadedImageRef.current;\n            }\n            return prevImage;\n          });\n        }\n      }\n    }); // –ë–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π - —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ –¥–ª—è –∑–∞—â–∏—Ç—ã\n\n    const validateField = (name, value) => {\n      const newErrors = { ...errors };\n      \n      switch (name) {\n        case 'name':\n          if (!value.trim()) newErrors.name = '–ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ';\n          else delete newErrors.name;\n          break;\n        case 'price':\n          if (!value || isNaN(parseFloat(value)) || parseFloat(value) <= 0) \n            newErrors.price = '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ü–µ–Ω—É';\n          else delete newErrors.price;\n          break;\n        case 'weight':\n          if (!value.trim()) newErrors.weight = '–í–µ—Å/–æ–±—ä–µ–º –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω';\n          else delete newErrors.weight;\n          break;\n        case 'description':\n          if (!value.trim()) newErrors.description = '–û–ø–∏—Å–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ';\n          else delete newErrors.description;\n          break;\n        case 'image':\n          if (!value.trim()) newErrors.image = '–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ';\n          else if (!value.startsWith('data:image')) {\n            newErrors.image = '–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è';\n          }\n          else delete newErrors.image;\n          break;\n        default:\n          break;\n      }\n      \n      setErrors(newErrors);\n    };\n\n    const handleChange = (e) => {\n      const { name, value } = e.target;\n      setFormData(prev => {\n        const updated = {\n          ...prev,\n          [name]: value\n        };\n        \n        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –≤ localStorage –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏\n        // –¢–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–Ω–µ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏)\n        if (!item) {\n          try {\n            const dataToSave = {\n              ...updated,\n              image: image // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è\n            };\n            localStorage.setItem(formDataStorageKey, JSON.stringify(dataToSave));\n            console.log('üíæ MenuItemForm: –î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ localStorage');\n          } catch (e) {\n            console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã –≤ localStorage:', e);\n          }\n        }\n        \n        validateField(name, value);\n        return updated;\n      });\n    };\n\n    const handleFileChange = async (e) => {\n      // –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤\n      if (isProcessingFileRef.current) {\n        return;\n      }\n      \n      const file = e.target.files?.[0];\n      if (!file) {\n        return;\n      }\n      \n      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –æ–±—Ä–∞–±–æ—Ç–∫–∏\n      isProcessingFileRef.current = true;\n      \n      // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ input –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏\n      const input = e.target;\n\n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø —Ñ–∞–π–ª–∞ (MIME-—Ç–∏–ø –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)\n      if (!isImageFile(file)) {\n        onAlert('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (JPG, PNG, GIF, WEBP, BMP, SVG, HEIC –∏ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã)', 'error');\n        isProcessingFileRef.current = false;\n        return;\n      }\n\n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–º–∞–∫—Å–∏–º—É–º 5MB)\n      if (file.size > 5 * 1024 * 1024) {\n        onAlert('–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å 5MB', 'error');\n        isProcessingFileRef.current = false;\n        return;\n      }\n\n      setIsUploading(true);\n      try {\n        const base64 = await convertFileToBase64(file);\n        \n        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\n        userHasUploadedRef.current = true;\n        uploadedImageRef.current = base64; // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ ref –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Å–±—Ä–æ—Å–∞\n        \n        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–µ\n        if (menuImagesStore && formKey) {\n          menuImagesStore.set(formKey, base64);\n        }\n        \n        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ\n        // —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ\n        setImage(prevImage => {\n          // –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç, –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ–º\n          if (prevImage === base64) {\n            return prevImage;\n          }\n          return base64;\n        });\n        \n        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –≤ localStorage –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è\n        // –¢–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–Ω–µ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏)\n        if (!item) {\n          try {\n            const dataToSave = {\n              ...formData,\n              image: base64\n            };\n            localStorage.setItem(formDataStorageKey, JSON.stringify(dataToSave));\n            console.log('üíæ handleFileChange: –î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ localStorage');\n          } catch (e) {\n            console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã –≤ localStorage:', e);\n          }\n        }\n        \n        // –í–∞–ª–∏–¥–∞—Ü–∏—é –≤—ã–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è\n        setTimeout(() => validateField('image', base64), 0);\n        \n        // –û—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º –≤—ã–∑–æ–≤ onAlert, —á—Ç–æ–±—ã –¥–∞—Ç—å React –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ\n        setTimeout(() => {\n          // –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º onAlert\n          setImage(currentImage => {\n            // –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—ã–ª–æ —Å–±—Ä–æ—à–µ–Ω–æ, –Ω–æ –≤ ref –æ–Ω–æ –µ—Å—Ç—å - –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º\n            if (!currentImage && uploadedImageRef.current) {\n              return uploadedImageRef.current;\n            }\n            return currentImage;\n          });\n          \n          // –í—ã–∑—ã–≤–∞–µ–º onAlert —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ\n          onAlert('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ', 'success');\n        }, 150);\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ (MenuItemForm):', error);\n        onAlert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞', 'error');\n      } finally {\n        setIsUploading(false);\n        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –æ–±—Ä–∞–±–æ—Ç–∫–∏\n        isProcessingFileRef.current = false;\n        \n        // –û—á–∏—â–∞–µ–º input –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ—Ç –∂–µ —Ñ–∞–π–ª —Å–Ω–æ–≤–∞\n        setTimeout(() => {\n          if (input) {\n            input.value = '';\n          }\n        }, 100);\n      }\n    };\n\n    const handleSubmit = (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      \n      // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π\n      const newErrors = {};\n      \n      // –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è\n      if (!image || !image.trim()) {\n        newErrors.image = '–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ';\n      } else if (!image.startsWith('data:image')) {\n        newErrors.image = '–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è';\n      }\n      \n      // –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π\n      if (!formData.name?.trim()) {\n        newErrors.name = '–ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ';\n      }\n      if (!formData.price || isNaN(parseFloat(formData.price)) || parseFloat(formData.price) <= 0) {\n        newErrors.price = '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ü–µ–Ω—É';\n      }\n      if (!formData.weight?.trim()) {\n        newErrors.weight = '–í–µ—Å/–æ–±—ä–µ–º –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω';\n      }\n      if (!formData.description?.trim()) {\n        newErrors.description = '–û–ø–∏—Å–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ';\n      }\n      \n      setErrors(newErrors);\n\n      if (Object.keys(newErrors).length === 0 && image && image.startsWith('data:image')) {\n        // –û—á–∏—â–∞–µ–º localStorage –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏\n        if (!item) {\n          try {\n            localStorage.removeItem(formDataStorageKey);\n            console.log('üóëÔ∏è MenuItemForm: –î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã —É–¥–∞–ª–µ–Ω—ã –∏–∑ localStorage –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');\n          } catch (e) {\n            console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã –∏–∑ localStorage:', e);\n          }\n        }\n        \n        // –ü–µ—Ä–µ–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º\n        onSave({\n          ...formData,\n          image: image.trim()\n        });\n      } else {\n        if (!image || !image.startsWith('data:image')) {\n          onAlert('–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ', 'error');\n        } else {\n          onAlert('–ò—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏ –≤ —Ñ–æ—Ä–º–µ', 'error');\n        }\n      }\n    };\n\n    const isFormValid = () => {\n      return formData.name && \n             formData.price && \n             formData.weight && \n             formData.description && \n             image &&\n             Object.keys(errors).length === 0;\n    };\n\n    return (\n      <div className=\"form-modal\">\n        <div className=\"form-content\">\n          <h3>{item ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –±–ª—é–¥–æ' : '–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –±–ª—é–¥–æ'}</h3>\n          <form onSubmit={handleSubmit} noValidate>\n            <div className=\"form-group\">\n              <label>–ù–∞–∑–≤–∞–Ω–∏–µ *</label>\n              <input\n                type=\"text\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                className={errors.name ? 'error' : ''}\n                placeholder=\"–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞\"\n                required\n              />\n              {errors.name && <span className=\"error-text\">{errors.name}</span>}\n            </div>\n\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>–¶–µ–Ω–∞ (‚ÇΩ) *</label>\n                <input\n                  type=\"number\"\n                  name=\"price\"\n                  value={formData.price}\n                  onChange={handleChange}\n                  className={errors.price ? 'error' : ''}\n                  placeholder=\"0\"\n                  min=\"1\"\n                  required\n                />\n                {errors.price && <span className=\"error-text\">{errors.price}</span>}\n              </div>\n\n              <div className=\"form-group\">\n                <label>–í–µ—Å/–û–±—ä–µ–º *</label>\n                <input\n                  type=\"text\"\n                  name=\"weight\"\n                  value={formData.weight}\n                  onChange={handleChange}\n                  className={errors.weight ? 'error' : ''}\n                  placeholder=\"150 –≥ –∏–ª–∏ 500 –º–ª\"\n                  required\n                />\n                {errors.weight && <span className=\"error-text\">{errors.weight}</span>}\n              </div>\n\n              <div className=\"form-group\">\n                <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>\n                <select\n                  name=\"category\"\n                  value={formData.category}\n                  onChange={handleChange}\n                >\n                  {categories.map(cat => (\n                    <option key={cat.id} value={cat.key}>{cat.name}</option>\n                  ))}\n                </select>\n              </div>\n            </div>\n\n            <div className=\"form-group\">\n              <label>–û–ø–∏—Å–∞–Ω–∏–µ *</label>\n              <textarea\n                name=\"description\"\n                value={formData.description}\n                onChange={handleChange}\n                className={errors.description ? 'error' : ''}\n                rows=\"3\"\n                placeholder=\"–û–ø–∏—à–∏—Ç–µ –±–ª—é–¥–æ\"\n                required\n              />\n              {errors.description && <span className=\"error-text\">{errors.description}</span>}\n            </div>\n\n            <div className=\"form-group\">\n              <label>–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª *</label>\n              <div className=\"file-upload-wrapper\">\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  accept=\"image/*\"\n                  onChange={handleFileChange}\n                  className=\"file-input-hidden\"\n                  disabled={isUploading}\n                />\n                <button\n                  type=\"button\"\n                  className=\"file-upload-button\"\n                  onClick={(e) => {\n                    e.preventDefault();\n                    if (fileInputRef.current) {\n                      console.log('–ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ (MenuItemForm), –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª–æ–≤—ã–π –¥–∏–∞–ª–æ–≥');\n                      fileInputRef.current.click();\n                    } else {\n                      console.error('fileInputRef.current is null (MenuItemForm)');\n                    }\n                  }}\n                  disabled={isUploading}\n                >\n                  {isUploading ? (\n                    <>\n                      <span className=\"upload-icon\">‚è≥</span>\n                      <span>–ó–∞–≥—Ä—É–∑–∫–∞...</span>\n                    </>\n                  ) : (\n                    <>\n                      <span className=\"upload-icon\">üì∑</span>\n                      <span>–í—ã–±—Ä–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</span>\n                    </>\n                  )}\n                </button>\n                {image && !isUploading && (\n                  <button\n                    type=\"button\"\n                    className=\"file-remove-button\"\n                    onClick={() => {\n                      userHasUploadedRef.current = false;\n                      uploadedImageRef.current = null;\n                      // –û—á–∏—â–∞–µ–º –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞\n                      if (menuImagesStore && formKey) {\n                        menuImagesStore.delete(formKey);\n                      }\n                      setImage('');\n                      if (fileInputRef.current) {\n                        fileInputRef.current.value = '';\n                      }\n                      validateField('image', '');\n                    }}\n                  >\n                    ‚úï\n                  </button>\n                )}\n              </div>\n              {errors.image && <span className=\"error-text\">{errors.image}</span>}\n            </div>\n\n            {image && image.trim() && (\n              <div className=\"form-group\">\n                <label>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:</label>\n                <div className=\"photo-preview-modern\">\n                  <img\n                    key={image.substring(0, 50)}\n                    src={image}\n                    alt=\"–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä\"\n                    onLoad={() => console.log('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –≤ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä (MenuItemForm)')}\n                    onError={(e) => {\n                      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä (MenuItemForm)');\n                      e.target.src = 'https://via.placeholder.com/300x200/8B7355/FFFFFF?text=–¢–±–∏–ª–∏—Å–∏';\n                    }}\n                  />\n                  <div className=\"photo-preview-overlay\">\n                    <span className=\"preview-badge\">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</span>\n                  </div>\n                </div>\n              </div>\n            )}\n            {!image && (\n              <div className=\"form-group\">\n                <p style={{ color: '#999', fontStyle: 'italic', fontSize: '0.9rem' }}>\n                  –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞\n                </p>\n              </div>\n            )}\n\n            <div className=\"form-actions\">\n              <button \n                type=\"submit\" \n                className=\"save-btn\"\n                disabled={!isFormValid()}\n              >\n                {item ? '–û–±–Ω–æ–≤–∏—Ç—å' : '–î–æ–±–∞–≤–∏—Ç—å'}\n              </button>\n              <button type=\"button\" className=\"cancel-btn\" onClick={onCancel}>\n                –û—Ç–º–µ–Ω–∞\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    );\n  };\n\n  const formatPrice = (price) => {\n    if (typeof price === 'string' && price.includes('‚ÇΩ')) {\n      return price;\n    }\n    const priceNum = parseInt(price);\n    return isNaN(priceNum) ? '0 ‚ÇΩ' : `${priceNum} ‚ÇΩ`;\n  };\n\n  const handleImageError = (e) => {\n    e.target.src = 'https://via.placeholder.com/300x200/8B7355/FFFFFF?text=–¢–±–∏–ª–∏—Å–∏';\n  };\n\n  // –°—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ–º photo prop –¥–ª—è PhotoForm, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞\n  const stablePhotoForForm = useMemo(() => {\n    if (editingPhoto === null) return null;\n    return editingPhoto.id ? editingPhoto : null;\n  }, [editingPhoto?.id]);\n\n  // –ï—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –≤—Ö–æ–¥–∞\n  if (!isAuthenticated) {\n    return <LoginForm onLogin={handleLogin} />;\n  }\n\n  return (\n    <div className=\"admin-page\">\n      <div className=\"admin-container\">\n        {/* –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞ */}\n        <div className=\"admin-header\">\n          <h1>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å \"–¢–±–∏–ª–∏—Å–∏\"</h1>\n          <button onClick={handleLogout} className=\"logout-btn\">\n            –í—ã–π—Ç–∏\n          </button>\n        </div>\n        \n        {/* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */}\n        {showNotification && (\n          <div className={`admin-notification ${notificationType}`}>\n            {notificationMessage}\n            <button onClick={() => setShowNotification(false)}>√ó</button>\n          </div>\n        )}\n\n        {/* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤–∫–ª–∞–¥–æ–∫ */}\n        <div className=\"admin-tabs\">\n          <button \n            className={`tab-button ${activeTab === 'reservations' ? 'active' : ''}`}\n            onClick={() => handleTabChange('reservations')}\n          >\n            –ó–∞—è–≤–∫–∏ ({reservations.length})\n          </button>\n          <button \n            className={`tab-button ${activeTab === 'menu' ? 'active' : ''}`}\n            onClick={() => handleTabChange('menu')}\n          >\n            –ú–µ–Ω—é ({menuItems.length})\n          </button>\n          <button \n            className={`tab-button ${activeTab === 'categories' ? 'active' : ''}`}\n            onClick={() => handleTabChange('categories')}\n          >\n            –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ ({categories.length})\n          </button>\n          <button \n            className={`tab-button ${activeTab === 'themes' ? 'active' : ''}`}\n            onClick={() => handleTabChange('themes')}\n          >\n            –¢–µ–º—ã ({Object.keys(themes).length + 1})\n          </button>\n          <button \n            className={`tab-button ${activeTab === 'photos' ? 'active' : ''}`}\n            onClick={() => handleTabChange('photos')}\n          >\n            –§–æ—Ç–æ ({photos.length})\n          </button>\n        </div>\n\n        {/* –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–æ–∫ */}\n        <div className=\"tab-content\">\n          {activeTab === 'reservations' && (\n            <div className=\"reservations-tab\">\n              <h2>–ó–∞—è–≤–∫–∏ –Ω–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>\n              \n              {reservations.length === 0 ? (\n                <p className=\"no-data\">–ù–µ—Ç –∑–∞—è–≤–æ–∫ –Ω–∞ –±—Ä–æ–Ω—å</p>\n              ) : (\n                <div className=\"reservations-list\">\n                  {reservations.map(reservation => (\n                    <div key={reservation.id} className=\"reservation-card\">\n                      <div className=\"reservation-header\">\n                        <h3>{reservation.name}</h3>\n                        <span className=\"reservation-date\">\n                          {new Date(reservation.createdAt).toLocaleDateString('ru-RU')}\n                        </span>\n                      </div>\n                      <div className=\"reservation-details\">\n                        <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> {reservation.phone}</p>\n                        <p><strong>–î–∞—Ç–∞:</strong> {reservation.date} –≤ {reservation.time}</p>\n                        <p><strong>–ì–æ—Å—Ç–µ–π:</strong> {reservation.guests}</p>\n                        {reservation.comments && (\n                          <p><strong>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</strong> {reservation.comments}</p>\n                        )}\n                      </div>\n                      <button \n                        onClick={() => {\n                          if (window.confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞—è–≤–∫—É?')) {\n                            deleteReservation(reservation.id);\n                          }\n                        }}\n                        className=\"delete-btn\"\n                      >\n                        –£–¥–∞–ª–∏—Ç—å\n                      </button>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n\n          {activeTab === 'menu' && (\n            <div className=\"menu-tab\">\n              <div className=\"menu-header\">\n                <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é</h2>\n                <button \n                  onClick={() => setEditingItem({})}\n                  className=\"add-btn\"\n                >\n                  + –î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ\n                </button>\n              </div>\n\n              {menuItems.length === 0 ? (\n                <p className=\"no-data\">–ú–µ–Ω—é –ø—É—Å—Ç–æ. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ –±–ª—é–¥–∞ —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É –≤—ã—à–µ.</p>\n              ) : (\n                <div className=\"menu-items-grid\">\n                  {menuItems.map(item => (\n                    <div key={item.id} className=\"menu-item-card\">\n                      <div className=\"item-image\">\n                        <img \n                          src={item.image} \n                          alt={item.name}\n                          onError={handleImageError}\n                        />\n                      </div>\n                      <div className=\"item-content\">\n                        <h4>{item.name}</h4>\n                        <p className=\"item-price\">{formatPrice(item.price)} ¬∑ {item.weight}</p>\n                        <p className=\"item-description\">{item.description}</p>\n                        <p className=\"item-category\">\n                          {categories.find(cat => cat.key === item.category)?.name || item.category}\n                        </p>\n                      </div>\n                      <div className=\"item-actions\">\n                        <button \n                          onClick={() => startEditing(item)}\n                          className=\"edit-btn\"\n                        >\n                          –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å\n                        </button>\n                        <button \n                          onClick={() => {\n                            if (window.confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ –±–ª—é–¥–æ?')) {\n                              deleteMenuItem(item.id);\n                            }\n                          }}\n                          className=\"delete-btn\"\n                        >\n                          –£–¥–∞–ª–∏—Ç—å\n                        </button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n\n          {activeTab === 'categories' && (\n            <div className=\"categories-tab\">\n              <div className=\"categories-header\">\n                <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</h2>\n                <button \n                  onClick={addCategory}\n                  className=\"add-btn\"\n                >\n                  + –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é\n                </button>\n              </div>\n\n              {categories.length === 0 ? (\n                <p className=\"no-data\">–ö–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–µ—Ç. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é.</p>\n              ) : (\n                <div className=\"categories-list\">\n                  {categories.map((category, index) => (\n                    <div key={category.id} className=\"category-card\">\n                      {editingCategory && editingCategory.id === category.id ? (\n                        <div className=\"category-edit-form\">\n                          <input\n                            type=\"text\"\n                            value={editingCategory.name}\n                            onChange={(e) => setEditingCategory({ ...editingCategory, name: e.target.value })}\n                            className=\"category-name-input\"\n                            placeholder=\"–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏\"\n                            autoFocus\n                          />\n                          <div className=\"category-edit-actions\">\n                            <button \n                              onClick={() => updateCategory(editingCategory)}\n                              className=\"save-btn\"\n                            >\n                              –°–æ—Ö—Ä–∞–Ω–∏—Ç—å\n                            </button>\n                            <button \n                              onClick={() => setEditingCategory(null)}\n                              className=\"cancel-btn\"\n                            >\n                              –û—Ç–º–µ–Ω–∞\n                            </button>\n                          </div>\n                        </div>\n                      ) : (\n                        <>\n                          <div className=\"category-info\">\n                            <h4>{category.name}</h4>\n                            <p className=\"category-key\">–ö–ª—é—á: {category.key}</p>\n                            <p className=\"category-order\">–ü–æ—Ä—è–¥–æ–∫: {category.order}</p>\n                            <p className=\"category-items-count\">\n                              –ë–ª—é–¥ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: {menuItems.filter(item => item.category === category.key).length}\n                            </p>\n                          </div>\n                          <div className=\"category-actions\">\n                            <div className=\"category-order-controls\">\n                              <button\n                                onClick={() => moveCategory(category.id, 'up')}\n                                className=\"move-btn\"\n                                disabled={index === 0}\n                                title=\"–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤–≤–µ—Ä—Ö\"\n                              >\n                                ‚Üë\n                              </button>\n                              <button\n                                onClick={() => moveCategory(category.id, 'down')}\n                                className=\"move-btn\"\n                                disabled={index === categories.length - 1}\n                                title=\"–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤–Ω–∏–∑\"\n                              >\n                                ‚Üì\n                              </button>\n                            </div>\n                            <button \n                              onClick={() => setEditingCategory({ ...category })}\n                              className=\"edit-btn\"\n                            >\n                              –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å\n                            </button>\n                            <button \n                              onClick={() => {\n                                if (window.confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é?')) {\n                                  deleteCategory(category.id);\n                                }\n                              }}\n                              className=\"delete-btn\"\n                            >\n                              –£–¥–∞–ª–∏—Ç—å\n                            </button>\n                          </div>\n                        </>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n\n          {activeTab === 'themes' && (\n            <div className=\"themes-tab\">\n              <div className=\"themes-header\">\n                <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–∞–º–∏</h2>\n                <button \n                  onClick={addTheme}\n                  className=\"add-btn\"\n                >\n                  + –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–º—É\n                </button>\n              </div>\n\n              <div className=\"themes-list\">\n                {/* –¢–µ–º–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */}\n                <div className={`theme-card ${currentTheme === 'default' ? 'active' : ''}`}>\n                  <div className=\"theme-preview\">\n                    <div className=\"theme-preview-colors\">\n                      <div className=\"preview-color\" style={{ background: '#8B7355' }}></div>\n                      <div className=\"preview-color\" style={{ background: '#A8D8EA' }}></div>\n                      <div className=\"preview-color\" style={{ background: '#D4B896' }}></div>\n                    </div>\n                  </div>\n                  <div className=\"theme-info\">\n                    <h4>–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</h4>\n                    <p className=\"theme-description\">–ë–∞–∑–æ–≤–∞—è –∑–µ–º–ª—è–Ω–∞—è —Ç–µ–º–∞</p>\n                  </div>\n                  <div className=\"theme-actions\">\n                    <button \n                      onClick={() => applyTheme('default')}\n                      className={`apply-btn ${currentTheme === 'default' ? 'active' : ''}`}\n                    >\n                      {currentTheme === 'default' ? '‚úì –ü—Ä–∏–º–µ–Ω–µ–Ω–∞' : '–ü—Ä–∏–º–µ–Ω–∏—Ç—å'}\n                    </button>\n                  </div>\n                </div>\n\n                {/* –ë–∞–∑–æ–≤—ã–µ —Ç–µ–º—ã */}\n                {Object.values(defaultThemes).map(theme => (\n                  <div key={theme.id} className={`theme-card ${currentTheme === theme.id ? 'active' : ''}`}>\n                    <div className=\"theme-preview\">\n                      <div className=\"theme-preview-colors\">\n                        <div className=\"preview-color\" style={{ background: theme.primaryColor }}></div>\n                        <div className=\"preview-color\" style={{ background: theme.secondaryColor }}></div>\n                        <div className=\"preview-color\" style={{ background: theme.accentColor }}></div>\n                      </div>\n                    </div>\n                    <div className=\"theme-info\">\n                      <h4>{theme.name}</h4>\n                      <p className=\"theme-description\">–ë–∞–∑–æ–≤–∞—è —Ç–µ–º–∞</p>\n                    </div>\n                    <div className=\"theme-actions\">\n                      <button \n                        onClick={() => applyTheme(theme.id)}\n                        className={`apply-btn ${currentTheme === theme.id ? 'active' : ''}`}\n                      >\n                        {currentTheme === theme.id ? '‚úì –ü—Ä–∏–º–µ–Ω–µ–Ω–∞' : '–ü—Ä–∏–º–µ–Ω–∏—Ç—å'}\n                      </button>\n                    </div>\n                  </div>\n                ))}\n\n                {/* –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ç–µ–º—ã */}\n                {Object.values(themes).filter(theme => !defaultThemes[theme.id]).map(theme => (\n                  <div key={theme.id} className={`theme-card ${currentTheme === theme.id ? 'active' : ''}`}>\n                    {editingTheme && editingTheme.id === theme.id ? (\n                      <ThemeEditForm\n                        theme={editingTheme}\n                        onSave={updateTheme}\n                        onCancel={() => setEditingTheme(null)}\n                      />\n                    ) : (\n                      <>\n                        <div className=\"theme-preview\">\n                          <div className=\"theme-preview-colors\">\n                            <div className=\"preview-color\" style={{ background: theme.primaryColor }}></div>\n                            <div className=\"preview-color\" style={{ background: theme.secondaryColor }}></div>\n                            <div className=\"preview-color\" style={{ background: theme.accentColor }}></div>\n                          </div>\n                        </div>\n                        <div className=\"theme-info\">\n                          <h4>{theme.name}</h4>\n                          <p className=\"theme-description\">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Ç–µ–º–∞</p>\n                        </div>\n                        <div className=\"theme-actions\">\n                          <button \n                            onClick={() => applyTheme(theme.id)}\n                            className={`apply-btn ${currentTheme === theme.id ? 'active' : ''}`}\n                          >\n                            {currentTheme === theme.id ? '‚úì –ü—Ä–∏–º–µ–Ω–µ–Ω–∞' : '–ü—Ä–∏–º–µ–Ω–∏—Ç—å'}\n                          </button>\n                          <button \n                            onClick={() => setEditingTheme({ ...theme })}\n                            className=\"edit-btn\"\n                          >\n                            –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å\n                          </button>\n                          {!defaultThemes[theme.id] && (\n                            <button \n                              onClick={() => {\n                                if (window.confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ç–µ–º—É?')) {\n                                  deleteTheme(theme.id);\n                                }\n                              }}\n                              className=\"delete-btn\"\n                            >\n                              –£–¥–∞–ª–∏—Ç—å\n                            </button>\n                          )}\n                        </div>\n                      </>\n                    )}\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {activeTab === 'photos' && (\n            <div className=\"photos-tab\">\n              <div className=\"photos-header\">\n                <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏</h2>\n                <button\n                  onClick={() => {\n                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –¥–ª—è –Ω–æ–≤–æ–π —Ñ–æ—Ä–º—ã\n                    setEditingPhoto(newPhotoObjectRef.current);\n                  }}\n                  className=\"add-btn\"\n                >\n                  + –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ\n                </button>\n              </div>\n\n              {photos.length === 0 ? (\n                <p className=\"no-data\">–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –Ω–µ—Ç. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é.</p>\n              ) : (\n                <div className=\"photos-grid\">\n                  {photos.map(photo => (\n                    <div key={photo.id} className=\"photo-card\">\n                      <div className=\"photo-image\">\n                        <img\n                          src={photo.image}\n                          alt={photo.caption || '–§–æ—Ç–æ'}\n                          onError={(e) => {\n                            e.target.src = 'https://via.placeholder.com/300x200/8B7355/FFFFFF?text=–¢–±–∏–ª–∏—Å–∏';\n                          }}\n                        />\n                      </div>\n                      <div className=\"photo-info\">\n                        {photo.caption && (\n                          <p className=\"photo-caption\">{photo.caption}</p>\n                        )}\n                        {!photo.caption && (\n                          <p className=\"photo-caption-empty\">–ë–µ–∑ –ø–æ–¥–ø–∏—Å–∏</p>\n                        )}\n                      </div>\n                      <div className=\"photo-actions\">\n                        <button\n                          onClick={() => setEditingPhoto({ ...photo })}\n                          className=\"edit-btn\"\n                        >\n                          –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å\n                        </button>\n                        <button\n                          onClick={() => {\n                            if (window.confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ —Ñ–æ—Ç–æ?')) {\n                              deletePhoto(photo.id);\n                            }\n                          }}\n                          className=\"delete-btn\"\n                        >\n                          –£–¥–∞–ª–∏—Ç—å\n                        </button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n\n        {/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/–¥–æ–±–∞–≤–ª–µ–Ω–∏—è */}\n        {editingItem !== null && (\n          <MenuItemForm\n            key={editingItem?.id || newMenuItemKeyRef.current} // –°—Ç–∞–±–∏–ª—å–Ω—ã–π key\n            item={editingItem.id ? editingItem : null}\n            onSave={saveMenuItem}\n            onCancel={cancelEditing}\n            onAlert={showAlert}\n            menuImagesStore={menuImagesStore.current} // –ü–µ—Ä–µ–¥–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è\n            formKey={editingItem?.id || newMenuItemKeyRef.current} // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á —Ñ–æ—Ä–º—ã\n          />\n        )}\n\n        {/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/–¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π */}\n        {editingPhoto !== null && (\n          <PhotoForm\n            key={editingPhoto?.id || newPhotoKeyRef.current} // –°—Ç–∞–±–∏–ª—å–Ω—ã–π key\n            photo={stablePhotoForForm}\n            onSave={savePhoto}\n            onCancel={cancelPhotoEditing}\n            onAlert={showAlert}\n            uploadedImagesStore={uploadedImagesStore.current} // –ü–µ—Ä–µ–¥–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è\n            formKey={editingPhoto?.id || newPhotoKeyRef.current} // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á —Ñ–æ—Ä–º—ã\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Admin;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}